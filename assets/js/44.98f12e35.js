(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{361:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"slurm和sbatch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slurm和sbatch"}},[s._v("#")]),s._v(" slurm和sbatch")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://slurm.schedmd.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("SLURM"),a("OutboundLink")],1),s._v(" （Simple Linux Utility for Resource Management）是一种可扩展的工作负载管理器，已被全世界的国家超级计算机中心广泛采用。 它是免费且开源的，根据"),a("a",{attrs:{href:"http://www.gnu.org/licenses/gpl.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("GPL通用公共许可证"),a("OutboundLink")],1),s._v("发行。")]),s._v(" "),a("p",[s._v("本文档将协助您通过 Slurm 管理作业。 在这里可以找到更多的工作样本。")]),s._v(" "),a("p",[s._v("如果我们可以提供任何帮助，请随时联系 "),a("a",{attrs:{href:"mailto:hpc%40sjtu.edu.cn"}},[s._v("HPC 邮箱")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/1678884417297.png",alt:"1678884417297"}})]),s._v(" "),a("h2",{attrs:{id:"查看节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看节点"}},[s._v("#")]),s._v(" 查看节点")]),s._v(" "),a("h3",{attrs:{id:"sinfo查看集群状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sinfo查看集群状态"}},[s._v("#")]),s._v(" sinfo查看集群状态")]),s._v(" "),a("p",[s._v("节点状态包括：")]),s._v(" "),a("p",[a("code",[s._v("drain")]),s._v("(节点故障)，"),a("code",[s._v("alloc")]),s._v("(节点在用)，"),a("code",[s._v("idle")]),s._v("(节点可用)，"),a("code",[s._v("down")]),s._v("(节点下线)，"),a("code",[s._v("mix")]),s._v("(节点部分占用，但仍有剩余资源）。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("Slurm")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("功能")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("sinfo -N")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看节点级信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("sinfo -N --states=idle")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看可用节点信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("sinfo --partition=cpu")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看队列信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("sinfo --help")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看所有选项")])])])]),s._v(" "),a("h3",{attrs:{id:"scontrol-show-node查看节点信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scontrol-show-node查看节点信息"}},[s._v("#")]),s._v(" scontrol show node查看节点信息")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为了查看您可以使用的所有节点的详细信息：")]),s._v("\nscontrol show "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对于特定节点")]),s._v("\nscontrol show "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nodename"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"/assets/1680077416766.png",alt:"1680077416766"}})]),s._v(" "),a("h2",{attrs:{id:"作业管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#作业管理"}},[s._v("#")]),s._v(" 作业管理")]),s._v(" "),a("ul",[a("li",[s._v("我们的联邦学习场景下，需要多个客户端通信，所以只能在一个节点下，申请的节点数不应超过1；")]),s._v(" "),a("li",[s._v("但是可以通过ntasks-per-node启动多个进程，或者通过cpus-per-task启动多个线程）")]),s._v(" "),a("li",[s._v("在我们联邦学习下最好通过cpus-per-task启动多个线程，\n"),a("ul",[a("li",[s._v("多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源大，效率要差一些。")]),s._v(" "),a("li",[s._v("进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。")]),s._v(" "),a("li",[s._v("特别对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。")])])])]),s._v(" "),a("h3",{attrs:{id:"nodes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nodes"}},[s._v("#")]),s._v(" --nodes")]),s._v(" "),a("p",[s._v("申请计算节点的数量，在作业脚本里加入")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --nodes=X")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("其中 "),a("code",[s._v("X")]),s._v(" 是数量，需要的计算节点的个数")]),s._v(" "),a("blockquote",[a("p",[s._v("申请节点数为x=1，如果作业不能跨节点（MPI）运行，申请的节点数应不超过1")])]),s._v(" "),a("h3",{attrs:{id:"ntasks-per-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ntasks-per-node"}},[s._v("#")]),s._v(" --ntasks-per-node")]),s._v(" "),a("p",[s._v("控制每个计算节点上运行 task 的数量，一般与 "),a("code",[s._v("--nodes")]),s._v(" 配合使用，例如")]),s._v(" "),a("blockquote",[a("p",[s._v("MPI 程序需要 3 个计算节点，每节点 4 个进程，一共 12 个 task，对应 12 个 cpu 核")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --nodes=3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --ntasks-per-node=4")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("p",[s._v("还可以与 "),a("code",[s._v("--cpus-per-task")]),s._v(" 选项配合使用，例如")]),s._v(" "),a("blockquote",[a("p",[s._v("MPI 程序需要 3 个计算节点，每节点 2 个进程，每个进程使用 OpenMP 运行 8 个线程，一共 48 个 cpu 核")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --nodes=3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --ntasks-per-node=2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --cpus-per-task=8")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("blockquote",[a("p",[s._v("每个节点上运行的任务数，如果程序不支持多进程（如openmp），这个数不应该超过1")])]),s._v(" "),a("p",[s._v("==（钱老师服务器ntasks-per-node申请到13个及以上时，客户端间通信就不太行了；12个可以，所以可以10个客户端，1个服务器）==")]),s._v(" "),a("h3",{attrs:{id:"cpus-per-task"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpus-per-task"}},[s._v("#")]),s._v(" --cpus-per-task")]),s._v(" "),a("p",[s._v("单个 task 需要的 cpu 核数。一个 task 进程可以多线程，需要使用多个 cpu 核。此选项 Slurm 系统会保证一个 task 进程所在的计算节点上有指定数量的 cpu 核可用。")]),s._v(" "),a("p",[s._v("例如，每个计算节点有 4 个 cpu 核，一个计算作业需要 24 个 cpu 核")]),s._v(" "),a("ul",[a("li",[s._v("直接声明 24 个 task，Slurm 系统将分配 6 个计算节点")]),s._v(" "),a("li",[s._v("指定 "),a("code",[s._v("--cpus-per-task=3")]),s._v("，Slurm 系统将分配 8 个计算节点，确保一个 task 需要的 3 个 cpu 核是在同一个节点上")])]),s._v(" "),a("p",[s._v("如果不设置此选项，Slurm 系统默认值是 1，即默认一个 task 分配一个 cpu 核")]),s._v(" "),a("p",[s._v("==（钱老师服务器cpus-per-task申请到13个及以上时，客户端间通信就不太行了；12个可以，所以可以10个客户端，1个服务器）==")]),s._v(" "),a("h2",{attrs:{id:"squeue查看作业信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#squeue查看作业信息"}},[s._v("#")]),s._v(" squeue查看作业信息")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("Slurm")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("功能")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue -j jobid")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看作业信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue -l")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看细节信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue -n HOST")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看特定节点作业信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看USER_LIST的作业")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue --state=R")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看特定状态的作业")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[s._v("squeue --help")])]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("查看所有的选项")])])])]),s._v(" "),a("p",[s._v("作业状态包括"),a("code",[s._v("R")]),s._v("(正在运行)，"),a("code",[s._v("PD")]),s._v("(正在排队)，"),a("code",[s._v("CG")]),s._v("(即将完成)，"),a("code",[s._v("CD")]),s._v("(已完成)。")]),s._v(" "),a("p",[s._v("默认情况下，"),a("code",[s._v("squeue")]),s._v("只会展示在排队或在运行的作业。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ squeue\nJOBID PARTITION     NAME     "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" ST       TIME  NODES NODELIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("REASON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18046")]),s._v("      dgx2   ZXLing     eenl  R    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":35:53      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vol04\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17796")]),s._v("      dgx2   python    eexdl  R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("-00:22:04      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vol02\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("显示您自己账户下的作业：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ squeue "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" lsl7270\nJOBID PARTITION     NAME     "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" ST       TIME  NODES NODELIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("REASON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17923")]),s._v("      dgx2     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("    hpcwj  R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-12:59:05      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vol05\n$ squeue "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" lsl7270 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加个-c可以统计个数")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("code",[s._v("-l")]),s._v("选项可以显示更细节的信息。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ squeue "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\nJOBID PARTITION     NAME     "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("    STATE       TIME TIME_LIMI  NODES NODELIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("REASON"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17923")]),s._v("      dgx2     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("    hpcwj  RUNNING "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-13:00:53 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("-00:00:00    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vol05\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"scancel取消作业"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scancel取消作业"}},[s._v("#")]),s._v(" scancel取消作业")]),s._v(" "),a("p",[s._v("取消队列中已提交的作业；")]),s._v(" "),a("p",[s._v("介绍几个使用使用案例，分别是，取消指定作业、取消自己上机账号上所有作业、取消自己上机账号上所有状态为PENDING的作业，最后介绍scancel常见的参数。")]),s._v(" "),a("p",[a("strong",[s._v("取消指定作业；")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消作业ID为123的作业")]),s._v("\nscancel "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("取消指定用户的所有作业；")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("scancel "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" lsl7270\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("取消指定用户所有状态为PENDING的作业；")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("scancel "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" PENDING "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" lsl7270\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("scancel常见参数;")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示scancel命令的使用帮助信息；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("account"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消指定账户的作业，如果没有指定job_id,将取消所有；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("job_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消指定作业名的作业；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("partition_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消指定分区的作业；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("qos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消指定qos的作业；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("job_state_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 取消指定作态的作业，"PENDING", "RUNNING" 或 "SUSPENDED"；')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("user_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消指定用户下的作业；")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"lenov-lico下的slurm-sbatch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lenov-lico下的slurm-sbatch"}},[s._v("#")]),s._v(" Lenov LiCO下的slurm/sbatch")]),s._v(" "),a("p",[s._v("1.通过脚本.sh文件中的sbatch filename.sulrm语句将任务提交到计算节点（此时终端命令可用bash或者sbatch一样），bash 脚本名.sh，此时才能在lico的UI界面看到运行过程")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lstm_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ann_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("lookback")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("first_lstm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("  \n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("first_ann")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JOBNAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lookback}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${first_lstm}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${first_ann}")]),s._v(".slurm\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#!/bin/bash"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --nodes=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --ntasks-per-node=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --cpus-per-task=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "#SBATCH --gres=gpu:1" >> $JOBNAME')]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/share/lsl7270/anaconda3/bin/python train-FourGruOneAnn.py -lookback '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lookback")]),s._v(" -lstm_layernum "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lstm_layernum")]),s._v(" -ann_layernum "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ann_layernum")]),s._v(" -first_lstm "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_lstm")]),s._v(" -first_ann "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_ann")]),s._v(' "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n\t\t\tsbatch "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有这一句才能在lico的UI界面看到运行过程")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lstm_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ann_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lookback")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("first_lstm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("first_ann")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JOBNAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lookback}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${first_lstm}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${first_ann}")]),s._v(".slurm\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#!/bin/bash"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --nodes=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --ntasks-per-node=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#SBATCH --cpus-per-task=1"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/share/lsl7270/anaconda3/bin/python train-FourGruOneAnn.py -lookback '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lookback")]),s._v(" -lstm_layernum "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lstm_layernum")]),s._v(" -ann_layernum "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ann_layernum")]),s._v(" -first_lstm "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_lstm")]),s._v(" -first_ann "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_ann")]),s._v(' "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("\nsbatch "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOBNAME")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有这一句才能在lico的UI界面看到运行过程")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("2.通过sbatch .sh/.slurm（里面有#SBATCH内容，但没有sbatch语句），可以将任务提交到计算节点，但是lico的UI界面看不到运行过程")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --nodes=1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --ntasks-per-node=1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --cpus-per-task=1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lstm_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ann_layernum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lookback")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("first_lstm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("first_ann")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n/home/share/lsl7270/anaconda3/bin/python train-FourGruOneAnn.py "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-lookback")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lookback")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-lstm_layernum")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$lstm_layernum")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ann_layernum")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ann_layernum")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-first_lstm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_lstm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-first_ann")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$first_ann")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);