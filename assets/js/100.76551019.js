(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{417:function(t,s,a){"use strict";a.r(s);var n=a(7),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"线程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程"}},[t._v("#")]),t._v(" 线程")]),t._v(" "),s("h2",{attrs:{id:"三级映射-三级页表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三级映射-三级页表"}},[t._v("#")]),t._v(" 三级映射（三级页表）")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/823se9jo23129.png",alt:"03_三级映射"}})]),t._v(" "),s("p",[t._v("函数名、变量这些代码肯定是不同的")]),t._v(" "),s("p",[t._v("从内核里看进程和线程是一样的，都有各自不同的PCB，但是PCB中指向内存资源的三级页表是相同的")]),t._v(" "),s("h2",{attrs:{id:"栈空间"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#栈空间"}},[t._v("#")]),t._v(" 栈空间")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/asdlkjgo2912.png",alt:"05_栈空间"}})]),t._v(" "),s("p",[t._v("每一个函数有属于自己运行的栈帧空间，存放局部变量和临时值")]),t._v(" "),s("p",[t._v("线程号和线程id是不一样的")]),t._v(" "),s("p",[t._v("线程号：cpu分配时间轮片的依据")]),t._v(" "),s("p",[t._v("线程id：在进程内区分线程")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/948slkeut1831.png",alt:"01_创建多个子线程的i"}})]),t._v(" "),s("p",[t._v("exit将进程退出")]),t._v(" "),s("p",[t._v("在线程中用pthread_exit(NULL)，将线程退出")]),t._v(" "),s("p",[t._v("return 返回到调用者")]),t._v(" "),s("p",[t._v("return(10);         wait(pid, &status);   int *")]),t._v(" "),s("p",[t._v("​\t\t\tint ——> int *")]),t._v(" "),s("p",[t._v("pthread_exit(void *);")]),t._v(" "),s("p",[t._v("​\t\t\tvoid * ——> void **")]),t._v(" "),s("p",[t._v("线程共享全局变量")]),t._v(" "),s("p",[t._v("回收进程只能父进程来做，")]),t._v(" "),s("p",[t._v("回收线程都行")]),t._v(" "),s("h2",{attrs:{id:"线程控制原语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程控制原语"}},[t._v("#")]),t._v(" 线程控制原语")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("pthread_self\n\tcreate\n\texit\n\tjoin\n\n对比记忆 \n\n\tfork\t\tpthead_create\n\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthead_exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\tpthread_join（， "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("）   阻塞     分离 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" ； cancel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthread_cancel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t不能马上杀死，要到取消点"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("检查点"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("：系统调用\n\n\t\t\t\t\t\tman "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" pthreads \n\n\t\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthread_testcancel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 系统调用\n\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getpid")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthread_self")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pthread_detach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  分离。 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("线程结束时自动清理pcb。\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br")])]),s("p",[s("img",{attrs:{src:"/assets/238917jasjkl193.png",alt:"04_退出值"}})]),t._v(" "),s("p",[t._v("线程均分栈大小")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/1684498952558.png",alt:"1684498952558"}})]),t._v(" "),s("p",[t._v("建议锁（不具有强制性）")]),t._v(" "),s("p",[s("strong",[t._v("在访问共享资源前加锁，访问结束后立即解锁。锁的“粒度”应越小越好。")])]),t._v(" "),s("h2",{attrs:{id:"死锁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#死锁"}},[t._v("#")]),t._v(" 死锁")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/8xznbgk183712hj.png",alt:"04_死锁"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/890324nasjque.png",alt:"08_哲学家用餐简析"}})]),t._v(" "),s("p",[t._v("震荡也是死锁的一种")]),t._v(" "),s("p",[t._v("写独占，读共享，写锁优先级高")]),t._v(" "),s("p",[t._v("读写锁用在线程间")]),t._v(" "),s("p",[t._v("文件锁用在进程间")])])}),[],!1,null,null,null);s.default=r.exports}}]);