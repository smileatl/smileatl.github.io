<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL | SAL Repo</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/website_icon.png">
    <meta name="description" content="smileatl个人知识库，用于工作、学习、生活的总结。">
    <meta name="keywords" content="smileatl个人知识库，用于工作、学习、生活的总结。">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.27efc831.css" as="style"><link rel="preload" href="/assets/js/app.4813674f.js" as="script"><link rel="preload" href="/assets/js/3.cf27d530.js" as="script"><link rel="preload" href="/assets/js/110.225cb77d.js" as="script"><link rel="prefetch" href="/assets/js/10.57c72187.js"><link rel="prefetch" href="/assets/js/100.76551019.js"><link rel="prefetch" href="/assets/js/101.909b1f6a.js"><link rel="prefetch" href="/assets/js/102.b4df429c.js"><link rel="prefetch" href="/assets/js/103.36718b70.js"><link rel="prefetch" href="/assets/js/104.8247d5e5.js"><link rel="prefetch" href="/assets/js/105.ae996141.js"><link rel="prefetch" href="/assets/js/106.664e0ec8.js"><link rel="prefetch" href="/assets/js/107.34387111.js"><link rel="prefetch" href="/assets/js/108.24bd216e.js"><link rel="prefetch" href="/assets/js/109.0ce14ec5.js"><link rel="prefetch" href="/assets/js/11.a6b1ea70.js"><link rel="prefetch" href="/assets/js/111.987f1649.js"><link rel="prefetch" href="/assets/js/112.804919d1.js"><link rel="prefetch" href="/assets/js/113.61edc8e7.js"><link rel="prefetch" href="/assets/js/114.a2199a4f.js"><link rel="prefetch" href="/assets/js/115.919528ee.js"><link rel="prefetch" href="/assets/js/116.1e165300.js"><link rel="prefetch" href="/assets/js/117.b62cd913.js"><link rel="prefetch" href="/assets/js/118.157a5849.js"><link rel="prefetch" href="/assets/js/119.335bb0f4.js"><link rel="prefetch" href="/assets/js/12.f97190ac.js"><link rel="prefetch" href="/assets/js/120.8ca841a0.js"><link rel="prefetch" href="/assets/js/121.09ef443a.js"><link rel="prefetch" href="/assets/js/122.133de093.js"><link rel="prefetch" href="/assets/js/123.8b5fcdde.js"><link rel="prefetch" href="/assets/js/124.8aef67d0.js"><link rel="prefetch" href="/assets/js/125.07949d7c.js"><link rel="prefetch" href="/assets/js/126.6557ef27.js"><link rel="prefetch" href="/assets/js/127.e2c838f8.js"><link rel="prefetch" href="/assets/js/128.e876bdf8.js"><link rel="prefetch" href="/assets/js/129.0e7d15bb.js"><link rel="prefetch" href="/assets/js/13.ae62b090.js"><link rel="prefetch" href="/assets/js/130.8caf4288.js"><link rel="prefetch" href="/assets/js/131.d091a5f7.js"><link rel="prefetch" href="/assets/js/132.3af86ba2.js"><link rel="prefetch" href="/assets/js/133.9b473677.js"><link rel="prefetch" href="/assets/js/134.d09f520d.js"><link rel="prefetch" href="/assets/js/135.5094d6c6.js"><link rel="prefetch" href="/assets/js/136.f554265c.js"><link rel="prefetch" href="/assets/js/137.db8ad307.js"><link rel="prefetch" href="/assets/js/138.97a9f7dc.js"><link rel="prefetch" href="/assets/js/139.28a187da.js"><link rel="prefetch" href="/assets/js/14.7c89dfed.js"><link rel="prefetch" href="/assets/js/140.58f327a0.js"><link rel="prefetch" href="/assets/js/141.dac9c32e.js"><link rel="prefetch" href="/assets/js/142.15e4cd8a.js"><link rel="prefetch" href="/assets/js/143.29bcf51a.js"><link rel="prefetch" href="/assets/js/144.93e792a5.js"><link rel="prefetch" href="/assets/js/145.1e479d7f.js"><link rel="prefetch" href="/assets/js/146.fef6b20d.js"><link rel="prefetch" href="/assets/js/147.a8939180.js"><link rel="prefetch" href="/assets/js/148.73ab52d1.js"><link rel="prefetch" href="/assets/js/149.de7d77b9.js"><link rel="prefetch" href="/assets/js/15.4266d5a5.js"><link rel="prefetch" href="/assets/js/150.14cd4f5b.js"><link rel="prefetch" href="/assets/js/151.ae320b72.js"><link rel="prefetch" href="/assets/js/152.9f70308b.js"><link rel="prefetch" href="/assets/js/153.8bb08923.js"><link rel="prefetch" href="/assets/js/154.bef6a0fb.js"><link rel="prefetch" href="/assets/js/155.e0e21ff7.js"><link rel="prefetch" href="/assets/js/156.e212e95d.js"><link rel="prefetch" href="/assets/js/157.9af3323d.js"><link rel="prefetch" href="/assets/js/158.a6990b68.js"><link rel="prefetch" href="/assets/js/159.9921842e.js"><link rel="prefetch" href="/assets/js/16.4d11e9b4.js"><link rel="prefetch" href="/assets/js/160.cb690287.js"><link rel="prefetch" href="/assets/js/161.10ec68a7.js"><link rel="prefetch" href="/assets/js/162.5e2e8da5.js"><link rel="prefetch" href="/assets/js/163.7ad3dc89.js"><link rel="prefetch" href="/assets/js/164.0677e91f.js"><link rel="prefetch" href="/assets/js/165.eabba413.js"><link rel="prefetch" href="/assets/js/166.de181132.js"><link rel="prefetch" href="/assets/js/167.eb1f2c20.js"><link rel="prefetch" href="/assets/js/168.33870baa.js"><link rel="prefetch" href="/assets/js/169.0eb4e75c.js"><link rel="prefetch" href="/assets/js/17.2f17b760.js"><link rel="prefetch" href="/assets/js/170.6a8f837b.js"><link rel="prefetch" href="/assets/js/171.33c99890.js"><link rel="prefetch" href="/assets/js/172.e2ac6d6c.js"><link rel="prefetch" href="/assets/js/173.f37baa2e.js"><link rel="prefetch" href="/assets/js/174.3f1765d5.js"><link rel="prefetch" href="/assets/js/175.ee3e624a.js"><link rel="prefetch" href="/assets/js/176.b7c3d2ba.js"><link rel="prefetch" href="/assets/js/177.538dbd98.js"><link rel="prefetch" href="/assets/js/178.688b2ab3.js"><link rel="prefetch" href="/assets/js/179.7605eb3a.js"><link rel="prefetch" href="/assets/js/18.46454e6b.js"><link rel="prefetch" href="/assets/js/180.f734c479.js"><link rel="prefetch" href="/assets/js/181.f009bfc4.js"><link rel="prefetch" href="/assets/js/182.51a8e6fc.js"><link rel="prefetch" href="/assets/js/183.0f688ed3.js"><link rel="prefetch" href="/assets/js/184.e20ab6d5.js"><link rel="prefetch" href="/assets/js/185.336035f1.js"><link rel="prefetch" href="/assets/js/186.e7f18b72.js"><link rel="prefetch" href="/assets/js/187.20bae185.js"><link rel="prefetch" href="/assets/js/188.4d746641.js"><link rel="prefetch" href="/assets/js/189.45442618.js"><link rel="prefetch" href="/assets/js/19.07e2632b.js"><link rel="prefetch" href="/assets/js/190.6f6c4889.js"><link rel="prefetch" href="/assets/js/191.b73399a8.js"><link rel="prefetch" href="/assets/js/192.657f63ce.js"><link rel="prefetch" href="/assets/js/193.348754cf.js"><link rel="prefetch" href="/assets/js/194.7ea4e875.js"><link rel="prefetch" href="/assets/js/195.011c9aaa.js"><link rel="prefetch" href="/assets/js/196.30ca323d.js"><link rel="prefetch" href="/assets/js/197.b404290d.js"><link rel="prefetch" href="/assets/js/198.19eeb699.js"><link rel="prefetch" href="/assets/js/199.578524cd.js"><link rel="prefetch" href="/assets/js/20.e8632e9e.js"><link rel="prefetch" href="/assets/js/200.2483c16f.js"><link rel="prefetch" href="/assets/js/201.80be911a.js"><link rel="prefetch" href="/assets/js/202.6292d716.js"><link rel="prefetch" href="/assets/js/203.0423f992.js"><link rel="prefetch" href="/assets/js/204.220cf5d5.js"><link rel="prefetch" href="/assets/js/205.cf88ea69.js"><link rel="prefetch" href="/assets/js/206.7837a407.js"><link rel="prefetch" href="/assets/js/207.15eb7f61.js"><link rel="prefetch" href="/assets/js/208.c92b54ae.js"><link rel="prefetch" href="/assets/js/209.d6858997.js"><link rel="prefetch" href="/assets/js/21.9d97eca0.js"><link rel="prefetch" href="/assets/js/210.3a916b1e.js"><link rel="prefetch" href="/assets/js/211.99ca202d.js"><link rel="prefetch" href="/assets/js/212.18a13454.js"><link rel="prefetch" href="/assets/js/213.7eb5f7fd.js"><link rel="prefetch" href="/assets/js/214.178507b3.js"><link rel="prefetch" href="/assets/js/215.e9eac7bd.js"><link rel="prefetch" href="/assets/js/216.bdd656c6.js"><link rel="prefetch" href="/assets/js/217.487e6997.js"><link rel="prefetch" href="/assets/js/218.eb54add1.js"><link rel="prefetch" href="/assets/js/219.43da1c82.js"><link rel="prefetch" href="/assets/js/22.ed6e719f.js"><link rel="prefetch" href="/assets/js/220.757359d6.js"><link rel="prefetch" href="/assets/js/221.d58f156a.js"><link rel="prefetch" href="/assets/js/222.99dc1661.js"><link rel="prefetch" href="/assets/js/223.22a61d2b.js"><link rel="prefetch" href="/assets/js/224.514138b9.js"><link rel="prefetch" href="/assets/js/225.fc56b049.js"><link rel="prefetch" href="/assets/js/226.59d64fed.js"><link rel="prefetch" href="/assets/js/227.8841cf23.js"><link rel="prefetch" href="/assets/js/228.f37358c2.js"><link rel="prefetch" href="/assets/js/229.97cb9c4e.js"><link rel="prefetch" href="/assets/js/23.5eccc486.js"><link rel="prefetch" href="/assets/js/230.a16ada6a.js"><link rel="prefetch" href="/assets/js/231.5f761bf3.js"><link rel="prefetch" href="/assets/js/232.76d78495.js"><link rel="prefetch" href="/assets/js/233.162bba41.js"><link rel="prefetch" href="/assets/js/234.a845dfca.js"><link rel="prefetch" href="/assets/js/235.169ff72d.js"><link rel="prefetch" href="/assets/js/236.c50d9ecf.js"><link rel="prefetch" href="/assets/js/237.594eecee.js"><link rel="prefetch" href="/assets/js/238.b599dae8.js"><link rel="prefetch" href="/assets/js/239.7be81ebe.js"><link rel="prefetch" href="/assets/js/24.c81753d3.js"><link rel="prefetch" href="/assets/js/240.b9f18f9e.js"><link rel="prefetch" href="/assets/js/241.77d17f60.js"><link rel="prefetch" href="/assets/js/242.0894cddd.js"><link rel="prefetch" href="/assets/js/243.4c71e0af.js"><link rel="prefetch" href="/assets/js/244.47579b9c.js"><link rel="prefetch" href="/assets/js/245.29344e11.js"><link rel="prefetch" href="/assets/js/246.410a1027.js"><link rel="prefetch" href="/assets/js/247.b22fa817.js"><link rel="prefetch" href="/assets/js/25.f3141c92.js"><link rel="prefetch" href="/assets/js/26.573fd0de.js"><link rel="prefetch" href="/assets/js/27.9a72220d.js"><link rel="prefetch" href="/assets/js/28.e161668a.js"><link rel="prefetch" href="/assets/js/29.6d2ef014.js"><link rel="prefetch" href="/assets/js/30.0dd2ba52.js"><link rel="prefetch" href="/assets/js/31.e8c4ee1d.js"><link rel="prefetch" href="/assets/js/32.c57cfa4e.js"><link rel="prefetch" href="/assets/js/33.7c1ec4ff.js"><link rel="prefetch" href="/assets/js/34.110d90ae.js"><link rel="prefetch" href="/assets/js/35.c5fbf1bd.js"><link rel="prefetch" href="/assets/js/36.58d307d9.js"><link rel="prefetch" href="/assets/js/37.6e68d82d.js"><link rel="prefetch" href="/assets/js/38.0a2bfb96.js"><link rel="prefetch" href="/assets/js/39.79a25586.js"><link rel="prefetch" href="/assets/js/4.10092391.js"><link rel="prefetch" href="/assets/js/40.1b3fb2c7.js"><link rel="prefetch" href="/assets/js/41.2cd990a4.js"><link rel="prefetch" href="/assets/js/42.3803a3ba.js"><link rel="prefetch" href="/assets/js/43.56cde0b8.js"><link rel="prefetch" href="/assets/js/44.98f12e35.js"><link rel="prefetch" href="/assets/js/45.bbed8377.js"><link rel="prefetch" href="/assets/js/46.80af516b.js"><link rel="prefetch" href="/assets/js/47.bfe18f20.js"><link rel="prefetch" href="/assets/js/48.e4bead99.js"><link rel="prefetch" href="/assets/js/49.da1a7c67.js"><link rel="prefetch" href="/assets/js/5.0b5a1289.js"><link rel="prefetch" href="/assets/js/50.b6011d95.js"><link rel="prefetch" href="/assets/js/51.81adcdd5.js"><link rel="prefetch" href="/assets/js/52.b650e175.js"><link rel="prefetch" href="/assets/js/53.22c44460.js"><link rel="prefetch" href="/assets/js/54.3c9964c8.js"><link rel="prefetch" href="/assets/js/55.80bec639.js"><link rel="prefetch" href="/assets/js/56.2066f85f.js"><link rel="prefetch" href="/assets/js/57.ab6dbc19.js"><link rel="prefetch" href="/assets/js/58.6236e7f0.js"><link rel="prefetch" href="/assets/js/59.618e25d3.js"><link rel="prefetch" href="/assets/js/6.a1e90b5b.js"><link rel="prefetch" href="/assets/js/60.3deac196.js"><link rel="prefetch" href="/assets/js/61.890283e9.js"><link rel="prefetch" href="/assets/js/62.ffe465e9.js"><link rel="prefetch" href="/assets/js/63.cc9a42cc.js"><link rel="prefetch" href="/assets/js/64.c66e6c4f.js"><link rel="prefetch" href="/assets/js/65.95e3ddfd.js"><link rel="prefetch" href="/assets/js/66.256b023f.js"><link rel="prefetch" href="/assets/js/67.436df8a0.js"><link rel="prefetch" href="/assets/js/68.d532ffa8.js"><link rel="prefetch" href="/assets/js/69.963c3596.js"><link rel="prefetch" href="/assets/js/7.74944cf6.js"><link rel="prefetch" href="/assets/js/70.6dfd1704.js"><link rel="prefetch" href="/assets/js/71.53af90e0.js"><link rel="prefetch" href="/assets/js/72.580797e8.js"><link rel="prefetch" href="/assets/js/73.5c14d158.js"><link rel="prefetch" href="/assets/js/74.70cf381f.js"><link rel="prefetch" href="/assets/js/75.01dbab82.js"><link rel="prefetch" href="/assets/js/76.18b48db2.js"><link rel="prefetch" href="/assets/js/77.0fa8965d.js"><link rel="prefetch" href="/assets/js/78.bede6ca6.js"><link rel="prefetch" href="/assets/js/79.1c7c8167.js"><link rel="prefetch" href="/assets/js/8.fbc0181a.js"><link rel="prefetch" href="/assets/js/80.688d4c3b.js"><link rel="prefetch" href="/assets/js/81.4eaaee90.js"><link rel="prefetch" href="/assets/js/82.53bf5bf4.js"><link rel="prefetch" href="/assets/js/83.53cdee38.js"><link rel="prefetch" href="/assets/js/84.848d09d8.js"><link rel="prefetch" href="/assets/js/85.4ef416fa.js"><link rel="prefetch" href="/assets/js/86.559b9784.js"><link rel="prefetch" href="/assets/js/87.1317f521.js"><link rel="prefetch" href="/assets/js/88.61e1f1fa.js"><link rel="prefetch" href="/assets/js/89.c37979bc.js"><link rel="prefetch" href="/assets/js/9.acdf956e.js"><link rel="prefetch" href="/assets/js/90.329e7956.js"><link rel="prefetch" href="/assets/js/91.e9246182.js"><link rel="prefetch" href="/assets/js/92.41e1ecaf.js"><link rel="prefetch" href="/assets/js/93.6cbe0205.js"><link rel="prefetch" href="/assets/js/94.922231b5.js"><link rel="prefetch" href="/assets/js/95.23cfae7c.js"><link rel="prefetch" href="/assets/js/96.790a39b9.js"><link rel="prefetch" href="/assets/js/97.8ce2cb69.js"><link rel="prefetch" href="/assets/js/98.f016d83e.js"><link rel="prefetch" href="/assets/js/99.b1d81562.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.96cada6e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.27efc831.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/website_icon.png" alt="SAL Repo" class="logo"> <span class="site-name can-hide">SAL Repo</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><a href="/work/" class="link-title">工作</a> <span class="title" style="display:none;">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/C/" class="nav-link">C</a></li><li class="dropdown-subitem"><a href="/work/C++/" class="nav-link">C++</a></li><li class="dropdown-subitem"><a href="/work/Script_Language/" class="nav-link">Script_Language</a></li></ul></li><li class="dropdown-item"><h4>计算机知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/Linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/work/dataStruct/" class="nav-link">数据机构与算法</a></li><li class="dropdown-subitem"><a href="/work/OS/" class="nav-link">操作系统</a></li><li class="dropdown-subitem"><a href="/work/network/" class="nav-link">计算机网络</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/work/Redis/" class="nav-link">Redis</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/Git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/work/VM/" class="nav-link">虚拟机</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/leetcode/" class="nav-link">刷题</a></li><li class="dropdown-subitem"><a href="/work/bg/" class="nav-link">interview</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><a href="/project/" class="link-title">项目</a> <span class="title" style="display:none;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/mynetlib/" class="nav-link">mynetlib</a></li><li class="dropdown-item"><!----> <a href="/project/mymprpc/" class="nav-link">mymprpc</a></li><li class="dropdown-item"><!----> <a href="/project/mytinystl/" class="nav-link">mytinystl</a></li><li class="dropdown-item"><!----> <a href="/project/DML/" class="nav-link">DML</a></li><li class="dropdown-item"><!----> <a href="/project/FL/" class="nav-link">FL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><a href="/study/" class="link-title">学习</a> <span class="title" style="display:none;">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>研究生</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/study/publications/" class="nav-link">publications</a></li><li class="dropdown-subitem"><a href="/study/ML/" class="nav-link">机器学习</a></li></ul></li><li class="dropdown-item"><h4>阅读</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/study/read/" class="nav-link">个人摘抄</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/71024e/" class="nav-link">生活</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/collection/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>总览</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/collection/favorites/" class="nav-link">个人收藏夹</a></li><li class="dropdown-subitem"><a href="/collection/download/" class="nav-link">资源下载</a></li></ul></li><li class="dropdown-item"><h4>快速链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://sci-hub.wf/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SCI-HUB
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/collection/favorites/#文件转换、解密工具" class="nav-link">文件转换、解密工具</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>友链</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/friends/" class="nav-link">友情链接</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/smileatl/smileatlRepository_source" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.jpg"> <div class="blogger-info"><h3>smileatl</h3> <span>smileatl, Songlei Lin</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><a href="/work/" class="link-title">工作</a> <span class="title" style="display:none;">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/C/" class="nav-link">C</a></li><li class="dropdown-subitem"><a href="/work/C++/" class="nav-link">C++</a></li><li class="dropdown-subitem"><a href="/work/Script_Language/" class="nav-link">Script_Language</a></li></ul></li><li class="dropdown-item"><h4>计算机知识</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/Linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/work/dataStruct/" class="nav-link">数据机构与算法</a></li><li class="dropdown-subitem"><a href="/work/OS/" class="nav-link">操作系统</a></li><li class="dropdown-subitem"><a href="/work/network/" class="nav-link">计算机网络</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/work/Redis/" class="nav-link">Redis</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/Git/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/work/VM/" class="nav-link">虚拟机</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/work/leetcode/" class="nav-link">刷题</a></li><li class="dropdown-subitem"><a href="/work/bg/" class="nav-link">interview</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目" class="dropdown-title"><a href="/project/" class="link-title">项目</a> <span class="title" style="display:none;">项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/mynetlib/" class="nav-link">mynetlib</a></li><li class="dropdown-item"><!----> <a href="/project/mymprpc/" class="nav-link">mymprpc</a></li><li class="dropdown-item"><!----> <a href="/project/mytinystl/" class="nav-link">mytinystl</a></li><li class="dropdown-item"><!----> <a href="/project/DML/" class="nav-link">DML</a></li><li class="dropdown-item"><!----> <a href="/project/FL/" class="nav-link">FL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习" class="dropdown-title"><a href="/study/" class="link-title">学习</a> <span class="title" style="display:none;">学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>研究生</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/study/publications/" class="nav-link">publications</a></li><li class="dropdown-subitem"><a href="/study/ML/" class="nav-link">机器学习</a></li></ul></li><li class="dropdown-item"><h4>阅读</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/study/read/" class="nav-link">个人摘抄</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/71024e/" class="nav-link">生活</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/collection/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>总览</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/collection/favorites/" class="nav-link">个人收藏夹</a></li><li class="dropdown-subitem"><a href="/collection/download/" class="nav-link">资源下载</a></li></ul></li><li class="dropdown-item"><h4>快速链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://sci-hub.wf/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  SCI-HUB
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/collection/favorites/#文件转换、解密工具" class="nav-link">文件转换、解密工具</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>友链</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/friends/" class="nav-link">友情链接</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/smileatl/smileatlRepository_source" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程语言-C</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程语言-C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编程语言-Script_Language</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机知识-Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机知识-数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机知识-操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机知识-计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库-MySQL</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ff6a6c/" aria-current="page" class="active sidebar-link">MySQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#概述" class="sidebar-link">概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#mysql数据库" class="sidebar-link">MySQL数据库</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#客户端连接" class="sidebar-link">客户端连接</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#数据模型" class="sidebar-link">数据模型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#基础篇" class="sidebar-link">基础篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#通用语法及分类" class="sidebar-link">通用语法及分类</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#ddl-数据定义语言" class="sidebar-link">DDL（数据定义语言）</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#dml-数据操作语言" class="sidebar-link">DML（数据操作语言）</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#dql-数据查询语言" class="sidebar-link">DQL（数据查询语言）</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#dcl-数据控制语言" class="sidebar-link">DCL（数据控制语言）</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#函数" class="sidebar-link">函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#字符串函数" class="sidebar-link">字符串函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#数值函数" class="sidebar-link">数值函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#日期函数" class="sidebar-link">日期函数</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#流程函数" class="sidebar-link">流程函数</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#约束" class="sidebar-link">约束</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#常用约束" class="sidebar-link">常用约束</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#外键约束" class="sidebar-link">外键约束</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#多表查询" class="sidebar-link">多表查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#多表关系" class="sidebar-link">多表关系</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#查询" class="sidebar-link">查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#内连接查询" class="sidebar-link">内连接查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#外连接查询" class="sidebar-link">外连接查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#自连接查询" class="sidebar-link">自连接查询</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#联合查询-union-union-all" class="sidebar-link">联合查询 union, union all</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#子查询" class="sidebar-link">子查询</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#事务" class="sidebar-link">事务</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#四大特性acid" class="sidebar-link">四大特性ACID</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#并发事务" class="sidebar-link">并发事务</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#进阶篇" class="sidebar-link">进阶篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#存储引擎" class="sidebar-link">存储引擎</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#innodb" class="sidebar-link">InnoDB</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#myisam" class="sidebar-link">MyISAM</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#memory" class="sidebar-link">Memory</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#存储引擎特点" class="sidebar-link">存储引擎特点</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#存储引擎的选择" class="sidebar-link">存储引擎的选择</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#性能分析" class="sidebar-link">性能分析</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#查看执行频次" class="sidebar-link">查看执行频次</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#慢查询日志" class="sidebar-link">慢查询日志</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#profile" class="sidebar-link">profile</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#explain" class="sidebar-link">explain</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#索引" class="sidebar-link">索引</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#索引结构" class="sidebar-link">索引结构</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#索引分类" class="sidebar-link">索引分类</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#使用规则" class="sidebar-link">使用规则</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#设计原则" class="sidebar-link">设计原则</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#sql-优化" class="sidebar-link">SQL 优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#插入数据" class="sidebar-link">插入数据</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#主键优化" class="sidebar-link">主键优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#order-by优化" class="sidebar-link">order by优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#group-by优化" class="sidebar-link">group by优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#limit优化" class="sidebar-link">limit优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#count优化" class="sidebar-link">count优化</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#update优化-避免行锁升级为表锁" class="sidebar-link">update优化（避免行锁升级为表锁）</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#视图-存储过程-触发器" class="sidebar-link">视图/存储过程/触发器</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#视图" class="sidebar-link">视图</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#存储过程" class="sidebar-link">存储过程</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#触发器" class="sidebar-link">触发器</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#锁" class="sidebar-link">锁</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#全局锁" class="sidebar-link">全局锁</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#表级锁" class="sidebar-link">表级锁</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#行级锁" class="sidebar-link">行级锁</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#innodb引擎" class="sidebar-link">InnoDB引擎</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#逻辑存储结构" class="sidebar-link">逻辑存储结构</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#架构" class="sidebar-link">架构</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#事务原理" class="sidebar-link">事务原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#mysql管理" class="sidebar-link">MySQL管理</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#系统数据库" class="sidebar-link">系统数据库</a></li><li class="sidebar-sub-header level4"><a href="/pages/ff6a6c/#常用工具" class="sidebar-link">常用工具</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#数据类型" class="sidebar-link">数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#整型" class="sidebar-link">整型</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#浮点型" class="sidebar-link">浮点型</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#日期和时间" class="sidebar-link">日期和时间</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#字符串" class="sidebar-link">字符串</a></li><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#二进制类型" class="sidebar-link">二进制类型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#权限一览表" class="sidebar-link">权限一览表</a></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#图形化界面工具" class="sidebar-link">图形化界面工具</a></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#小技巧" class="sidebar-link">小技巧</a></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#其他" class="sidebar-link">其他</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ff6a6c/#mycat" class="sidebar-link">mycat</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ff6a6c/#后续内容" class="sidebar-link">后续内容</a></li></ul></li><li><a href="/pages/08800f/" class="sidebar-link">必知必会笔记</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库-Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具-Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具-虚拟机</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他-刷题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他-interview</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/work/#工作" data-v-06225672>工作</a></li><li data-v-06225672><a href="/work/#数据库-MySQL" data-v-06225672>数据库-MySQL</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/smileatl" target="_blank" title="作者" class="beLink" data-v-06225672>smileatl</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-06-06</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">MySQL<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="mysql"><a href="#mysql" class="header-anchor">#</a> MySQL</h1> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <h3 id="mysql数据库"><a href="#mysql数据库" class="header-anchor">#</a> MySQL数据库</h3> <h4 id="客户端连接"><a href="#客户端连接" class="header-anchor">#</a> 客户端连接</h4> <p>1). 方式一：使用MySQL提供的客户端命令行工具</p> <p><img src="/assets/1673233450471.png" alt="1673233450471"></p> <p>2). 方式二：使用系统自带的命令行工具执行指令</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mysql  <span class="token punctuation">[</span>-h <span class="token number">127.0</span>.0.1<span class="token punctuation">]</span>  <span class="token punctuation">[</span>-P <span class="token number">3306</span><span class="token punctuation">]</span>  <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>

参数：

    <span class="token parameter variable">-h</span> <span class="token builtin class-name">:</span> MySQL服务所在的主机IP
    <span class="token parameter variable">-P</span> <span class="token builtin class-name">:</span> MySQL服务端口号， 默认3306
    <span class="token parameter variable">-u</span> <span class="token builtin class-name">:</span> MySQL数据库用户名
    <span class="token parameter variable">-p</span> ： MySQL数据库用户名对应的密码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>[]内为可选参数，如果需要连接远程的MySQL，需要加上这两个参数来指定远程主机IP、端口，如果
连接本地的MySQL，则无需指定这两个参数。</p> <p><img src="/assets/1673233486011.png" alt="1673233486011"></p> <blockquote><p>注意： 使用这种方式进行连接时，需要安装完毕后配置PATH环境变量。</p></blockquote> <h4 id="数据模型"><a href="#数据模型" class="header-anchor">#</a> 数据模型</h4> <p>MySQL是关系型数据库，是基于二维表进行数据存储的，具体的结构图下:</p> <p><img src="/assets/1673233275580.png" alt="1673233275580"></p> <ul><li>我们可以通过MySQL客户端连接数据库管理系统DBMS，然后通过DBMS操作数据库。</li> <li>可以使用SQL语句，通过数据库管理系统操作数据库，以及操作数据库中的表结构及数据。</li> <li>一个数据库服务器中可以创建多个数据库，一个数据库中也可以包含多张表，而一张表中又可以包
含多行记录。</li></ul> <h2 id="基础篇"><a href="#基础篇" class="header-anchor">#</a> 基础篇</h2> <h3 id="通用语法及分类"><a href="#通用语法及分类" class="header-anchor">#</a> 通用语法及分类</h3> <p>在学习具体的SQL语句之前，先来了解一下SQL语言的同于语法</p> <ol><li><p>SQL语句可以单行或多行书写，以分号结尾。</p></li> <li><p>SQL语句可以使用空格/缩进来增强语句的可读性。</p></li> <li><p>MySQL数据库的SQL语句不区分大小写，关键字建议使用大写。</p></li> <li><p>注释：</p> <p>单行注释：-- 注释内容  或  ## 注释内容</p> <p>多行注释：/* 注释内容 */</p></li></ol> <ul><li>DDL: 数据定义语言，用来定义数据库对象（数据库、表、字段）</li> <li>DML: 数据操作语言，用来对数据库表中的数据进行增删改</li> <li>DQL: 数据查询语言，用来查询数据库中表的记录</li> <li>DCL: 数据控制语言，用来创建数据库用户、控制数据库的控制权限</li></ul> <h4 id="ddl-数据定义语言"><a href="#ddl-数据定义语言" class="header-anchor">#</a> DDL（数据定义语言）</h4> <p>数据定义语言</p> <h5 id="数据库操作"><a href="#数据库操作" class="header-anchor">#</a> 数据库操作</h5> <p>查询所有数据库：
<code>SHOW DATABASES;</code>
查询当前数据库（查看当前处于哪一个数据库里面）：
<code>SELECT DATABASE();</code>
创建数据库：
<code>CREATE DATABASE [ IF NOT EXISTS ] 数据库名 [ DEFAULT CHARSET 字符集] [COLLATE 排序规则 ];</code>
删除数据库：
<code>DROP DATABASE [ IF EXISTS ] 数据库名;</code>
使用切换数据库：
<code>USE 数据库名;</code></p> <h6 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项</h6> <ul><li>UTF8字符集长度为3字节，有些符号占4字节，所以推荐用utf8mb4字符集</li></ul> <h5 id="表操作"><a href="#表操作" class="header-anchor">#</a> 表操作</h5> <p>查询当前数据库所有表：
<code>SHOW TABLES;</code>
查询表结构：
<code>DESC 表名;</code>
查询指定表的建表语句：
<code>SHOW CREATE TABLE 表名;</code></p> <p>创建表：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	字段<span class="token number">1</span> 字段<span class="token number">1</span>类型 <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">1</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
	字段<span class="token number">2</span> 字段<span class="token number">2</span>类型 <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">2</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
	字段<span class="token number">3</span> 字段<span class="token number">3</span>类型 <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段<span class="token number">3</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	字段n 字段n类型 <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> 字段n注释<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">[</span> <span class="token keyword">COMMENT</span> 表注释 <span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>最后一个字段后面没有逗号</strong></p> <p>添加字段：
<code>ALTER TABLE 表名 ADD 字段名 类型(长度) [COMMENT 注释] [约束]s;</code>
例：<code>ALTER TABLE emp ADD nickname varchar(20) COMMENT '昵称';</code></p> <p>修改数据类型：
<code>ALTER TABLE 表名 MODIFY 字段名 新数据类型(长度);</code>
修改字段名和字段类型：
<code>ALTER TABLE 表名 CHANGE 旧字段名 新字段名 类型(长度) [COMMENT 注释] [约束];</code>
例：将emp表的nickname字段修改为username，类型为varchar(30)
<code>ALTER TABLE emp CHANGE nickname username varchar(30) COMMENT '昵称';</code></p> <p>删除字段：
<code>ALTER TABLE 表名 DROP 字段名;</code></p> <p>修改表名：
<code>ALTER TABLE 表名 RENAME TO 新表名</code></p> <p>删除表：
<code>DROP TABLE [IF EXISTS] 表名;</code>
删除表，并重新创建该表：
<code>TRUNCATE TABLE 表名;</code></p> <h4 id="dml-数据操作语言"><a href="#dml-数据操作语言" class="header-anchor">#</a> DML（数据操作语言）</h4> <h5 id="添加数据"><a href="#添加数据" class="header-anchor">#</a> 添加数据</h5> <p>指定字段：
<code>INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...);</code>
全部字段：
<code>INSERT INTO 表名 VALUES (值1, 值2, ...);</code></p> <p>批量添加数据：
<code>INSERT INTO 表名 (字段名1, 字段名2, ...) VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...);</code> <code>INSERT INTO 表名 VALUES (值1, 值2, ...), (值1, 值2, ...), (值1, 值2, ...);</code></p> <h6 id="注意事项-2"><a href="#注意事项-2" class="header-anchor">#</a> 注意事项</h6> <ul><li><p>插入数据时，指定的字段顺序需要与值得顺序是一一对应的</p></li> <li><p>字符串和日期类型数据应该包含在引号中</p></li> <li><p>插入的数据大小应该在字段的规定范围内</p></li></ul> <h5 id="更新和删除数据"><a href="#更新和删除数据" class="header-anchor">#</a> 更新和删除数据</h5> <p>修改数据：
<code>UPDATE 表名 SET 字段名1 = 值1, 字段名2 = 值2, ... [ WHERE 条件 ];</code>
例：
<code>UPDATE emp SET name = 'Jack' WHERE id = 1;</code></p> <p><strong>注意事项</strong></p> <ul><li>修改语句的条件可以有，也可以没有，如果没有条件，则会修改整张表的所有数据</li></ul> <p>删除数据：
<code>DELETE FROM 表名 [ WHERE 条件 ];</code></p> <p><strong>注意事项</strong></p> <ul><li>delete语句的条件可以有，也可以没有，如果没有条件，则会删除整张表的所有数据。</li> <li>delete 语句不能删除某一个字段的值(可以使用update，将该字段值置为NULL即可)。</li> <li>当进行删除全部数据操作时，datagrip会提示我们，询问时候确认删除，我们直接点击Execute即可。</li></ul> <h4 id="dql-数据查询语言"><a href="#dql-数据查询语言" class="header-anchor">#</a> DQL（数据查询语言）</h4> <p>Data Query Language</p> <p>语法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	字段列表
<span class="token keyword">FROM</span>
	表名字段
<span class="token keyword">WHERE</span>
	条件列表
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	分组字段列表
<span class="token keyword">HAVING</span>
	分组后的条件列表
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	排序字段列表
<span class="token keyword">LIMIT</span>
	分页参数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="基础查询"><a href="#基础查询" class="header-anchor">#</a> 基础查询</h5> <p>查询多个字段：
<code>SELECT 字段1, 字段2, 字段3, ... FROM 表名;</code> <code>SELECT * FROM 表名;</code></p> <p>设置别名：
<code>SELECT 字段1 [ AS 别名1 ], 字段2 [ AS 别名2 ], 字段3 [ AS 别名3 ], ... FROM 表名;</code> <code>SELECT 字段1 [ 别名1 ], 字段2 [ 别名2 ], 字段3 [ 别名3 ], ... FROM 表名;</code></p> <p>去除重复记录：
<code>SELECT DISTINCT 字段列表 FROM 表名;</code></p> <p>转义：
<code>SELECT * FROM 表名 WHERE name LIKE '/_张三' ESCAPE '/'</code>
/ 之后的_不作为通配符</p> <h5 id="条件查询"><a href="#条件查询" class="header-anchor">#</a> 条件查询</h5> <p>语法：
<code>SELECT 字段列表 FROM 表名 WHERE 条件列表;</code></p> <p>条件：</p> <table><thead><tr><th>比较运算符</th> <th>功能</th></tr></thead> <tbody><tr><td>&gt;</td> <td>大于</td></tr> <tr><td>&gt;=</td> <td>大于等于</td></tr> <tr><td>&lt;</td> <td>小于</td></tr> <tr><td>&lt;=</td> <td>小于等于</td></tr> <tr><td>=</td> <td>等于</td></tr> <tr><td>&lt;&gt; 或 !=</td> <td>不等于</td></tr> <tr><td>BETWEEN ... AND ...</td> <td>在某个范围内（含最小、最大值）</td></tr> <tr><td>IN(...)</td> <td>在in之后的列表中的值，多选一</td></tr> <tr><td>LIKE 占位符</td> <td>模糊匹配（_匹配单个字符，%匹配任意个字符）</td></tr> <tr><td>IS NULL</td> <td>是NULL</td></tr></tbody></table> <table><thead><tr><th>逻辑运算符</th> <th>功能</th></tr></thead> <tbody><tr><td>AND 或 &amp;&amp;</td> <td>并且（多个条件同时成立）</td></tr> <tr><td>OR 或 ||</td> <td>或者（多个条件任意一个成立）</td></tr> <tr><td>NOT 或 !</td> <td>非，不是</td></tr></tbody></table> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 年龄等于30</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 年龄小于30</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 小于等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&lt;=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 没有身份证</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> idcard <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> idcard <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token comment">-- 有身份证</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> idcard<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> idcard <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token comment">-- 不等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">!=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 年龄在20到30之间</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token number">20</span> <span class="token operator">and</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&gt;=</span> <span class="token number">20</span> <span class="token operator">and</span> age <span class="token operator">&lt;=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">-- 下面语句不报错，但查不到任何信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token number">30</span> <span class="token operator">and</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">-- 性别为女且年龄小于30</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&lt;</span> <span class="token number">30</span> <span class="token operator">and</span> gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>
<span class="token comment">-- 年龄等于25或30或35</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">=</span> <span class="token number">25</span> <span class="token operator">or</span> age <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">or</span> age <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 姓名为两个字</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'__'</span><span class="token punctuation">;</span>
<span class="token comment">-- 身份证最后为X</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> idcard <span class="token operator">like</span> <span class="token string">'%X'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h5 id="聚合查询-聚合函数"><a href="#聚合查询-聚合函数" class="header-anchor">#</a> 聚合查询（聚合函数）</h5> <p>常见聚合函数：</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>count</td> <td>统计数量</td></tr> <tr><td>max</td> <td>最大值</td></tr> <tr><td>min</td> <td>最小值</td></tr> <tr><td>avg</td> <td>平均值</td></tr> <tr><td>sum</td> <td>求和</td></tr></tbody></table> <p>语法：
<code>SELECT 聚合函数(字段列表) FROM 表名;</code>
例：
<code>SELECT count(id) from employee where workaddress = &quot;广东省&quot;;</code></p> <h5 id="分组查询"><a href="#分组查询" class="header-anchor">#</a> 分组查询</h5> <p>语法：
<code>SELECT 字段列表 FROM 表名 [ WHERE 条件 ] GROUP BY 分组字段名 [ HAVING 分组后的过滤条件 ];</code></p> <p>where 和 having 的区别：</p> <ul><li>执行时机不同：where是分组之前进行过滤，不满足where条件不参与分组；having是分组后对结果进行过滤。</li> <li>判断条件不同：where不能对聚合函数进行判断，而having可以。</li></ul> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 根据性别分组，统计男性和女性数量（只显示分组数量，不显示哪个是男哪个是女）</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employee <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- 根据性别分组，统计男性和女性数量</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employee <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- 根据性别分组，统计男性和女性的平均年龄</span>
<span class="token keyword">select</span> gender<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> employee <span class="token keyword">group</span> <span class="token keyword">by</span> gender<span class="token punctuation">;</span>
<span class="token comment">-- 年龄小于45，并根据工作地址分组</span>
<span class="token keyword">select</span> workaddress<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&lt;</span> <span class="token number">45</span> <span class="token keyword">group</span> <span class="token keyword">by</span> workaddress<span class="token punctuation">;</span>
<span class="token comment">-- 年龄小于45，并根据工作地址分组，获取员工数量大于等于3的工作地址</span>
<span class="token keyword">select</span> workaddress<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> address_count <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">&lt;</span> <span class="token number">45</span> <span class="token keyword">group</span> <span class="token keyword">by</span> workaddress <span class="token keyword">having</span> address_count <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h6 id="注意事项-3"><a href="#注意事项-3" class="header-anchor">#</a> 注意事项</h6> <ul><li>执行顺序：where &gt; 聚合函数 &gt; having</li> <li>分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段无任何意义</li></ul> <h5 id="排序查询"><a href="#排序查询" class="header-anchor">#</a> 排序查询</h5> <p>语法：
<code>SELECT 字段列表 FROM 表名 ORDER BY 字段1 排序方式1, 字段2 排序方式2;</code></p> <p>排序方式：</p> <ul><li>ASC: 升序（默认）</li> <li>DESC: 降序</li></ul> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 根据年龄升序排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age <span class="token keyword">ASC</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age<span class="token punctuation">;</span>
<span class="token comment">-- 两字段排序，根据年龄升序排序，入职时间降序排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age <span class="token keyword">ASC</span><span class="token punctuation">,</span> entrydate <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h6 id="注意事项-4"><a href="#注意事项-4" class="header-anchor">#</a> 注意事项</h6> <ul><li><p>如果是升序，可以不指定排序方式ASC</p></li> <li><p>如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序</p></li></ul> <h5 id="分页查询"><a href="#分页查询" class="header-anchor">#</a> 分页查询</h5> <p>语法：
<code>SELECT 字段列表 FROM 表名 LIMIT 起始索引, 查询记录数;</code></p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询第一页数据，展示10条</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询第二页</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employee <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h6 id="注意事项-5"><a href="#注意事项-5" class="header-anchor">#</a> 注意事项</h6> <ul><li>起始索引从0开始，起始索引 = （查询页码 - 1） * 每页显示记录数</li> <li>分页查询是数据库的方言，不同数据库有不同实现，MySQL是LIMIT</li> <li>如果查询的是==第一页数据，起始索引可以省略==，直接简写 LIMIT 10</li></ul> <h5 id="dql执行顺序"><a href="#dql执行顺序" class="header-anchor">#</a> ==DQL执行顺序==</h5> <p>==FROM -&gt; WHERE -&gt; GROUP BY -&gt; SELECT -&gt; ORDER BY -&gt; LIMIT==</p> <p>==from ... where ... group by ... having ... select ... order by ... limit ...==</p> <h4 id="dcl-数据控制语言"><a href="#dcl-数据控制语言" class="header-anchor">#</a> DCL（数据控制语言）</h4> <h5 id="管理用户"><a href="#管理用户" class="header-anchor">#</a> 管理用户</h5> <p>查询用户：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">USE</span> mysql<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>创建用户:
<code>CREATE USER '用户名'@'主机名' IDENTIFIED BY '密码';</code></p> <p>修改用户密码：
<code>ALTER USER '用户名'@'主机名' IDENTIFIED WITH mysql_native_password BY '新密码';</code></p> <p>删除用户：
<code>DROP USER '用户名'@'主机名';</code></p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 创建用户test，只能在当前主机localhost访问</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'test'</span><span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token comment">-- 创建用户test，能在任意主机访问</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'test'</span><span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> <span class="token string">'test'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token comment">-- 修改密码</span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> <span class="token string">'test'</span><span class="token variable">@'localhost'</span> identified <span class="token keyword">with</span> mysql_native_password <span class="token keyword">by</span> <span class="token string">'1234'</span><span class="token punctuation">;</span>
<span class="token comment">-- 删除用户</span>
<span class="token keyword">drop</span> <span class="token keyword">user</span> <span class="token string">'test'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h6 id="注意事项-6"><a href="#注意事项-6" class="header-anchor">#</a> 注意事项</h6> <ul><li>主机名可以使用 % 通配</li></ul> <h5 id="权限控制"><a href="#权限控制" class="header-anchor">#</a> 权限控制</h5> <p>常用权限：</p> <table><thead><tr><th>权限</th> <th>说明</th></tr></thead> <tbody><tr><td>ALL, ALL PRIVILEGES</td> <td>所有权限</td></tr> <tr><td>SELECT</td> <td>查询数据</td></tr> <tr><td>INSERT</td> <td>插入数据</td></tr> <tr><td>UPDATE</td> <td>修改数据</td></tr> <tr><td>DELETE</td> <td>删除数据</td></tr> <tr><td>ALTER</td> <td>修改表</td></tr> <tr><td>DROP</td> <td>删除数据库/表/视图</td></tr> <tr><td>CREATE</td> <td>创建数据库/表</td></tr></tbody></table> <p>更多权限请看<a href="#%E6%9D%83%E9%99%90%E4%B8%80%E8%A7%88%E8%A1%A8" title="权限一览表">权限一览表</a></p> <p>查询权限：
<code>SHOW GRANTS FOR '用户名'@'主机名';</code></p> <p>授予权限：
<code>GRANT 权限列表 ON 数据库名.表名 TO '用户名'@'主机名';</code></p> <p>撤销权限：
<code>REVOKE 权限列表 ON 数据库名.表名 FROM '用户名'@'主机名';</code></p> <h6 id="注意事项-7"><a href="#注意事项-7" class="header-anchor">#</a> 注意事项</h6> <ul><li>多个权限用逗号分隔</li> <li>授权时，数据库名和表名可以用 * 进行通配，代表所有</li></ul> <h3 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h3> <ul><li>字符串函数</li> <li>数值函数</li> <li>日期函数</li> <li>流程函数</li></ul> <h4 id="字符串函数"><a href="#字符串函数" class="header-anchor">#</a> 字符串函数</h4> <p>常用函数：</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>CONCAT(s1, s2, ..., sn)</td> <td>字符串拼接，将s1, s2, ..., sn拼接成一个字符串</td></tr> <tr><td>LOWER(str)</td> <td>将字符串全部转为小写</td></tr> <tr><td>UPPER(str)</td> <td>将字符串全部转为大写</td></tr> <tr><td>LPAD(str, n, pad)</td> <td>左填充，用字符串pad对str的左边进行填充，达到n个字符串长度</td></tr> <tr><td>RPAD(str, n, pad)</td> <td>右填充，用字符串pad对str的右边进行填充，达到n个字符串长度</td></tr> <tr><td>TRIM(str)</td> <td>去掉字符串头部和尾部的空格</td></tr> <tr><td>SUBSTRING(str, start, len)</td> <td>返回从字符串str从start位置起的len个长度的字符串</td></tr> <tr><td>REPLACE(column, source, replace)</td> <td>替换字符串</td></tr></tbody></table> <p>使用示例：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 拼接</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'World'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 小写</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 大写</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 左填充</span>
<span class="token keyword">SELECT</span> LPAD<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">## ---01</span>
<span class="token comment">-- 右填充</span>
<span class="token keyword">SELECT</span> RPAD<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">## 01---</span>
<span class="token comment">-- 去除空格</span>
<span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">' Hello World '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 切片（起始索引为1）</span>
<span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="数值函数"><a href="#数值函数" class="header-anchor">#</a> 数值函数</h4> <p>常见函数：</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>CEIL(x)</td> <td>向上取整</td></tr> <tr><td>FLOOR(x)</td> <td>向下取整</td></tr> <tr><td>MOD(x, y)</td> <td>返回x/y的模</td></tr> <tr><td>RAND()</td> <td>返回0~1内的随机数</td></tr> <tr><td>ROUND(x, y)</td> <td>求参数x的四舍五入值，保留y位小数</td></tr></tbody></table> <p><strong>例子</strong></p> <p>通过数据库的函数，生成一个六位数的随机验证码。
思路： 获取随机数可以通过rand()函数，但是获取出来的随机数是在0-1之间的，所以可以在其基础
上乘以1000000，然后舍弃小数部分，如果长度不足6位，补0</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> lpad<span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000000</span> <span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">## 241032</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="日期函数"><a href="#日期函数" class="header-anchor">#</a> 日期函数</h4> <p>常用函数：</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>CURDATE()</td> <td>返回当前日期</td></tr> <tr><td>CURTIME()</td> <td>返回当前时间</td></tr> <tr><td>NOW()</td> <td>返回当前日期和时间</td></tr> <tr><td>YEAR(date)</td> <td>获取指定date的年份</td></tr> <tr><td>MONTH(date)</td> <td>获取指定date的月份</td></tr> <tr><td>DAY(date)</td> <td>获取指定date的日期</td></tr> <tr><td>DATE_ADD(date, INTERVAL expr type)</td> <td>返回一个日期/时间值加上一个时间间隔expr后的时间值</td></tr> <tr><td>DATEDIFF(date1, date2)</td> <td>返回起始时间date1和结束时间date2之间的天数</td></tr></tbody></table> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- DATE_ADD</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">70</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="流程函数"><a href="#流程函数" class="header-anchor">#</a> 流程函数</h4> <p>常用函数：</p> <table><thead><tr><th>函数</th> <th>功能</th></tr></thead> <tbody><tr><td>IF(value, t, f)</td> <td>如果value为true，则返回t，否则返回f</td></tr> <tr><td>IFNULL(value1, value2)</td> <td>如果value1不为空，返回value1，否则返回value2</td></tr> <tr><td>CASE WHEN [ val1 ] THEN [ res1 ] ... ELSE [ default ] END</td> <td>如果val1为true，返回res1，... 否则返回default默认值</td></tr> <tr><td>CASE [ expr ] WHEN [ val1 ] THEN [ res1 ] ... ELSE [ default ] END</td> <td>如果expr的值等于val1，返回res1，... 否则返回default默认值</td></tr></tbody></table> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span>
	name<span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> age <span class="token operator">&gt;</span> <span class="token number">30</span> <span class="token keyword">then</span> <span class="token string">'中年'</span> <span class="token keyword">else</span> <span class="token string">'青年'</span> <span class="token keyword">end</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employee<span class="token punctuation">;</span>
<span class="token keyword">select</span>
	name<span class="token punctuation">,</span>
	<span class="token punctuation">(</span><span class="token keyword">case</span> workaddress <span class="token keyword">when</span> <span class="token string">'北京市'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">when</span> <span class="token string">'上海市'</span> <span class="token keyword">then</span> <span class="token string">'一线城市'</span> <span class="token keyword">else</span> <span class="token string">'二线城市'</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'工作地址'</span>
<span class="token keyword">from</span> employee<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="约束"><a href="#约束" class="header-anchor">#</a> 约束</h3> <p>分类：</p> <table><thead><tr><th>约束</th> <th>描述</th> <th>关键字</th></tr></thead> <tbody><tr><td>非空约束</td> <td>限制该字段的数据不能为null</td> <td>NOT NULL</td></tr> <tr><td>唯一约束</td> <td>保证该字段的所有数据都是唯一、不重复的</td> <td>UNIQUE</td></tr> <tr><td>主键约束</td> <td>主键是一行数据的唯一标识，要求非空且唯一</td> <td>PRIMARY KEY</td></tr> <tr><td>默认约束</td> <td>保存数据时，如果未指定该字段的值，则采用默认值</td> <td>DEFAULT</td></tr> <tr><td>检查约束（8.0.1版本后）</td> <td>保证字段值满足某一个条件</td> <td>CHECK</td></tr> <tr><td>外键约束</td> <td>用来让两张图的数据之间建立连接，保证数据的一致性和完整性</td> <td>FOREIGN KEY</td></tr></tbody></table> <p>约束是作用于表中字段上的，可以==在创建表/修改表==的时候添加约束。</p> <h4 id="常用约束"><a href="#常用约束" class="header-anchor">#</a> 常用约束</h4> <p>概念：约束是作用于表中字段上的规则，用于限制存储在表中的数据，可以在创建表/修改表的时候添加约束
目的：保证数据库中数据的正确、有效性和完整性。</p> <p><strong>分类：</strong></p> <table><thead><tr><th style="text-align:center;"><strong>约束</strong></th> <th style="text-align:center;"><strong>描述</strong></th> <th style="text-align:center;"><strong>关键字</strong></th></tr></thead> <tbody><tr><td style="text-align:center;">非空约束</td> <td style="text-align:center;">限制该字段的数据不能为null</td> <td style="text-align:center;">NOT NULL</td></tr> <tr><td style="text-align:center;">唯一约束</td> <td style="text-align:center;">保证该字段的所有数据都是唯一、不重复的</td> <td style="text-align:center;">UNIQUE</td></tr> <tr><td style="text-align:center;">主键约束</td> <td style="text-align:center;">主键是一行数据的唯一标识，要求非空且唯一</td> <td style="text-align:center;">PRIMARY KEY</td></tr> <tr><td style="text-align:center;">默认约束</td> <td style="text-align:center;">保存数据时，如果未指定该字段的值，则采用默认值</td> <td style="text-align:center;">DEFAULT</td></tr> <tr><td style="text-align:center;">检查约束(8.0.16版本之后)</td> <td style="text-align:center;">保证字段值满足某一个条件</td> <td style="text-align:center;">CHECK</td></tr> <tr><td style="text-align:center;">外键约束</td> <td style="text-align:center;">用来让两张表的数据之间建立连接，保证数据的一致性和完整性</td> <td style="text-align:center;">FOREIGN KEY</td></tr></tbody></table> <table><thead><tr><th>约束条件</th> <th>关键字</th></tr></thead> <tbody><tr><td>主键</td> <td>PRIMARY KEY</td></tr> <tr><td>自动增长</td> <td>AUTO_INCREMENT</td></tr> <tr><td>不为空</td> <td>NOT NULL</td></tr> <tr><td>唯一</td> <td>UNIQUE</td></tr> <tr><td>逻辑条件</td> <td>CHECK</td></tr> <tr><td>默认值</td> <td>DEFAULT</td></tr></tbody></table> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">user</span><span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
	age <span class="token keyword">int</span> <span class="token keyword">check</span><span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">and</span> age <span class="token operator">&lt;</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">status</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
	gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="外键约束"><a href="#外键约束" class="header-anchor">#</a> 外键约束</h4> <p>添加外键：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	字段名 字段类型<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>外键名称<span class="token punctuation">]</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表<span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> 外键名称 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>外键字段名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表<span class="token punctuation">(</span>主表列名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 例子</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> emp <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span> dept<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">## fk_emp_dept_id自己取的外键名称</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>删除外键：
<code>ALTER TABLE 表名 DROP FOREIGN KEY 外键名;</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> emp <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> fk_emp_dept_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询系统中所有数据库下，所有存在外键的表：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> INFORMATION_SCHEMA<span class="token punctuation">.</span>KEY_COLUMN_USAGE
<span class="token keyword">where</span> REFERENCED_TABLE_NAME <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="删除-更新行为"><a href="#删除-更新行为" class="header-anchor">#</a> 删除/更新行为</h5> <table><thead><tr><th>行为</th> <th>说明</th></tr></thead> <tbody><tr><td>NO ACTION</td> <td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新（与RESTRICT一致）</td></tr> <tr><td>RESTRICT</td> <td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新（与NO ACTION一致）</td></tr> <tr><td>CASCADE</td> <td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则也删除/更新外键在子表中的记录</td></tr> <tr><td>SET NULL</td> <td>当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则设置子表中该外键值为null（要求该外键允许为null）</td></tr> <tr><td>SET DEFAULT</td> <td>父表有变更时，子表将外键设为一个默认值（Innodb不支持）</td></tr></tbody></table> <p>更改删除/更新行为：
<code>ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES 主表名(主表字段名) ON UPDATE 行为 ON DELETE 行为;</code></p> <h3 id="多表查询"><a href="#多表查询" class="header-anchor">#</a> 多表查询</h3> <h4 id="多表关系"><a href="#多表关系" class="header-anchor">#</a> 多表关系</h4> <ul><li>一对多（多对一）</li> <li>多对多</li> <li>一对一</li></ul> <h5 id="一对多"><a href="#一对多" class="header-anchor">#</a> 一对多</h5> <p>案例：部门与员工
关系：一个部门对应多个员工，一个员工对应一个部门
实现：在多的一方建立外键，指向一的一方的主键</p> <h5 id="多对多"><a href="#多对多" class="header-anchor">#</a> 多对多</h5> <p>案例：学生与课程
关系：一个学生可以选多门课程，一门课程也可以供多个学生选修
实现：建立第三张中间表，中间表至少包含两个外键，分别关联两方主键</p> <h5 id="一对一"><a href="#一对一" class="header-anchor">#</a> 一对一</h5> <p>案例：用户与用户详情
关系：一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率
实现：在任意一方加入外键，关联另外一方的主键，并且设置外键为唯一的（UNIQUE）</p> <h4 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h4> <p>合并查询（笛卡尔积，会展示所有组合结果）：
<code>select * from employee, dept;</code></p> <blockquote><p>笛卡尔积：两个集合A集合和B集合的所有组合情况（在多表查询时，需要消除无效的笛卡尔积）</p></blockquote> <p>消除无效笛卡尔积：
<code>select * from employee, dept where employee.dept = dept.id;</code></p> <h4 id="内连接查询"><a href="#内连接查询" class="header-anchor">#</a> 内连接查询</h4> <p>内连接查询的是两张表交集的部分</p> <p>隐式内连接：
<code>SELECT 字段列表 FROM 表1, 表2 WHERE 条件 ...;</code></p> <p>显式内连接：
<code>SELECT 字段列表 FROM 表1 [ INNER ] JOIN 表2 ON 连接条件 ...;</code></p> <p>显式性能比隐式高</p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询员工姓名，及关联的部门的名称</span>
<span class="token comment">-- 隐式</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token keyword">as</span> e<span class="token punctuation">,</span> dept <span class="token keyword">as</span> d <span class="token keyword">where</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 显式</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token keyword">as</span> e <span class="token keyword">inner</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>注意事项</strong></p> <ul><li>一旦为表起了别名，就不能再使用表名来指定对应的字段了，此时只能够使用别名来指定字段。</li></ul> <h4 id="外连接查询"><a href="#外连接查询" class="header-anchor">#</a> 外连接查询</h4> <p>左外连接：
查询左表所有数据，以及两张表交集部分数据
<code>SELECT 字段列表 FROM 表1 LEFT [ OUTER ] JOIN 表2 ON 条件 ...;</code>
相当于查询表1的所有数据，包含表1和表2交集部分数据</p> <p>右外连接：
查询右表所有数据，以及两张表交集部分数据
<code>SELECT 字段列表 FROM 表1 RIGHT [ OUTER ] JOIN 表2 ON 条件 ...;</code></p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 左</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee <span class="token keyword">as</span> e <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>name<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> dept d <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> emp e <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>  <span class="token comment">-- 这条语句与下面的语句效果一样</span>
<span class="token comment">-- 右</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>name<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">as</span> e <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>左连接可以查询到没有dept的employee，右连接可以查询到没有employee的dept</p> <p><strong>注意事项</strong></p> <ul><li>左外连接和右外连接是可以相互替换的，只需要调整在连接查询时SQL中，表结构的先后顺序就可以了。而我们在日常开发使用时，更偏向于左外连接。</li></ul> <h4 id="自连接查询"><a href="#自连接查询" class="header-anchor">#</a> 自连接查询</h4> <p>当前表与自身的连接查询，自连接必须使用表别名</p> <p>语法：
<code>SELECT 字段列表 FROM 表A 别名A JOIN 表A 别名B ON 条件 ...;</code></p> <p>自连接查询，可以是内连接查询，也可以是外连接查询</p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询员工及其所属领导的名字</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee a<span class="token punctuation">,</span> employee b <span class="token keyword">where</span> a<span class="token punctuation">.</span>manager <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
<span class="token comment">-- 没有领导的也查询出来</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee a <span class="token keyword">left</span> <span class="token keyword">join</span> employee b <span class="token keyword">on</span> a<span class="token punctuation">.</span>manager <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>注意事项</strong></p> <p>在自连接查询中，必须要为表起别名，要不然我们不清楚所指定的条件、返回的字段，到底是哪一张表的字段。</p> <h4 id="联合查询-union-union-all"><a href="#联合查询-union-union-all" class="header-anchor">#</a> 联合查询 union, union all</h4> <p>把多次查询的结果合并，形成一个新的查询集</p> <ul><li>对于联合查询的多张表的列数必须保持一致，字段类型也需要保持一致。</li> <li>union all 会将全部的数据直接合并在一起，union 会对合并之后的数据去重。</li></ul> <p>语法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表A <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">UNION</span> <span class="token punctuation">[</span><span class="token keyword">ALL</span><span class="token punctuation">]</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表B <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="注意事项-8"><a href="#注意事项-8" class="header-anchor">#</a> 注意事项</h5> <ul><li>UNION ALL 会有重复结果，UNION 不会</li> <li>联合查询比使用or效率高，不会使索引失效</li></ul> <h4 id="子查询"><a href="#子查询" class="header-anchor">#</a> 子查询</h4> <p>SQL语句中嵌套SELECT语句，称谓嵌套查询，又称子查询。
<code>SELECT * FROM t1 WHERE column1 = ( SELECT column1 FROM t2);</code> <strong>子查询外部的语句可以是 INSERT / UPDATE / DELETE / SELECT 的任何一个</strong></p> <p>根据子查询结果可以分为：</p> <ul><li>标量子查询（子查询结果为单个值）</li> <li>列子查询（子查询结果为一列）</li> <li>行子查询（子查询结果为一行）</li> <li>表子查询（子查询结果为多行多列）</li></ul> <p>根据子查询位置可分为：</p> <ul><li>WHERE 之后</li> <li>FROM 之后</li> <li>SELECT 之后</li></ul> <h5 id="标量子查询"><a href="#标量子查询" class="header-anchor">#</a> 标量子查询</h5> <p>子查询返回的结果是单个值（数字、字符串、日期等）。
常用操作符：- &lt; &gt; &gt; &gt;= &lt; &lt;=</p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询销售部所有员工</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> dept <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'销售部'</span><span class="token punctuation">;</span>
<span class="token comment">-- 根据销售部部门ID，查询员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> dept <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token comment">-- 合并（子查询）</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> dept <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'销售部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询xxx入职之后的员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> entrydate <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> entrydate <span class="token keyword">from</span> employee <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="列子查询"><a href="#列子查询" class="header-anchor">#</a> 列子查询</h5> <p>返回的结果是一列（可以是多行）。</p> <p>常用操作符：</p> <table><thead><tr><th>操作符</th> <th>描述</th></tr></thead> <tbody><tr><td>IN</td> <td>在指定的集合范围内，多选一</td></tr> <tr><td>NOT IN</td> <td>不在指定的集合范围内</td></tr> <tr><td>ANY</td> <td>子查询返回列表中，有任意一个满足即可</td></tr> <tr><td>SOME</td> <td>与ANY等同，使用SOME的地方都可以使用ANY</td></tr> <tr><td>ALL</td> <td>子查询返回列表的所有值都必须满足</td></tr></tbody></table> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询销售部和市场部的所有员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> dept <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> dept <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'销售部'</span> <span class="token operator">or</span> name <span class="token operator">=</span> <span class="token string">'市场部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询比财务部所有人工资都高的员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token keyword">all</span><span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employee <span class="token keyword">where</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> dept <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询比研发部任意一人工资高的员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token keyword">any</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> employee <span class="token keyword">where</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> dept <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="行子查询"><a href="#行子查询" class="header-anchor">#</a> 行子查询</h5> <p>返回的结果是一行（可以是多列）。
常用操作符：=, &lt;, &gt;, IN, NOT IN</p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询与xxx的薪资及直属领导相同的员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> <span class="token punctuation">(</span>salary<span class="token punctuation">,</span> manager<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">12500</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> <span class="token punctuation">(</span>salary<span class="token punctuation">,</span> manager<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary<span class="token punctuation">,</span> manager <span class="token keyword">from</span> employee <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="表子查询"><a href="#表子查询" class="header-anchor">#</a> 表子查询</h5> <p>返回的结果是多行多列
常用操作符：IN</p> <p>例子：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询与xxx1，xxx2的职位和薪资相同的员工</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> <span class="token punctuation">(</span>job<span class="token punctuation">,</span> salary<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job<span class="token punctuation">,</span> salary <span class="token keyword">from</span> employee <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'xxx1'</span> <span class="token operator">or</span> name <span class="token operator">=</span> <span class="token string">'xxx2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询入职日期是2006-01-01之后的员工，及其部门信息</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> entrydate <span class="token operator">&gt;</span> <span class="token string">'2006-01-01'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> e <span class="token keyword">left</span> <span class="token keyword">join</span> dept <span class="token keyword">as</span> d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询低于本部门平均工资的员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e2 <span class="token keyword">where</span> e2<span class="token punctuation">.</span>salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>salary<span class="token punctuation">)</span> <span class="token keyword">from</span> emp e1 <span class="token keyword">where</span> 
e1<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> e2<span class="token punctuation">.</span>dept_id <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询所有的部门信息, 并统计部门的员工人数</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name <span class="token punctuation">,</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id <span class="token punctuation">)</span> <span class="token string">'人数'</span> 
<span class="token keyword">from</span> dept d<span class="token punctuation">;</span>
<span class="token comment">-- 查询所有学生的选课情况, 展示出学生名称, 学号, 课程名称</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">no</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>name <span class="token keyword">from</span> student s<span class="token punctuation">,</span>student_course sc<span class="token punctuation">,</span>course c <span class="token keyword">where</span> s<span class="token punctuation">.</span>id<span class="token operator">=</span>sc<span class="token punctuation">.</span>studentid <span class="token operator">and</span> sc<span class="token punctuation">.</span>courseid<span class="token operator">=</span>c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h3> <p>事务是一组操作的集合，事务会把所有操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p> <p><strong>注意</strong>：默认MySQL的事务是自动提交的，也就是说，当执行完一条DML语句时，MySQL会立即隐式的提交事务。</p> <p>基本操作：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 1. 查询张三账户余额</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token comment">-- 2. 将张三账户余额-1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token comment">-- 此语句出错后张三钱减少但是李四钱没有增加</span>
模拟<span class="token keyword">sql</span>语句错误
<span class="token comment">-- 3. 将李四账户余额+1000</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看事务提交方式</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@AUTOCOMMIT</span><span class="token punctuation">;</span>
<span class="token comment">-- 设置事务提交方式，1为自动提交，0为手动提交，该设置只对当前会话有效</span>
<span class="token keyword">SET</span> @<span class="token variable">@AUTOCOMMIT</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token comment">-- 回滚事务</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>

<span class="token comment">-- 设置手动提交后上面代码改为：</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>操作方式二：</p> <p>开启事务：
<code>START TRANSACTION 或 BEGIN TRANSACTION;</code>
提交事务：
<code>COMMIT;</code>
回滚事务：
<code>ROLLBACK;</code></p> <p>操作实例：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">1000</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="四大特性acid"><a href="#四大特性acid" class="header-anchor">#</a> 四大特性ACID</h4> <ul><li>原子性(Atomicity)：事务是不可分割的最小操作单元，要么全部成功，要么全部失败</li> <li>一致性(Consistency)：事务完成时，必须使所有数据都保持一致状态</li> <li>隔离性(Isolation)：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行</li> <li>持久性(Durability)：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的</li></ul> <h4 id="并发事务"><a href="#并发事务" class="header-anchor">#</a> 并发事务</h4> <table><thead><tr><th>问题</th> <th>描述</th></tr></thead> <tbody><tr><td>脏读</td> <td>一个事务读到另一个事务还没提交的数据</td></tr> <tr><td>不可重复读</td> <td>一个事务先后读取同一条记录，但两次读取的数据不同</td></tr> <tr><td>幻读</td> <td>一个事务按照条件查询数据时，没有对应的数据行，但是再插入数据时，又发现这行数据已经存在</td></tr></tbody></table> <blockquote><p>这三个问题的详细演示：https://www.bilibili.com/video/BV1Kr4y1i7ru?p=55cd</p></blockquote> <p>并发事务隔离级别：</p> <table><thead><tr><th>隔离级别</th> <th>脏读</th> <th>不可重复读</th> <th>幻读</th></tr></thead> <tbody><tr><td>Read uncommitted</td> <td>√</td> <td>√</td> <td>√</td></tr> <tr><td>Read committed</td> <td>×</td> <td>√</td> <td>√</td></tr> <tr><td>Repeatable Read(默认)</td> <td>×</td> <td>×</td> <td>√</td></tr> <tr><td>Serializable</td> <td>×</td> <td>×</td> <td>×</td></tr></tbody></table> <ul><li>√表示在当前隔离级别下该问题会出现</li> <li>Serializable 性能最低；Read uncommitted 性能最高，数据安全性最差</li></ul> <p>查看事务隔离级别：
<code>SELECT @@TRANSACTION_ISOLATION;</code>
设置事务隔离级别：
<code>SET [ SESSION | GLOBAL ] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE };</code>
SESSION 是会话级别，表示只针对当前会话有效，GLOBAL 表示对所有会话有效</p> <h2 id="进阶篇"><a href="#进阶篇" class="header-anchor">#</a> 进阶篇</h2> <h3 id="存储引擎"><a href="#存储引擎" class="header-anchor">#</a> 存储引擎</h3> <p>MySQL体系结构：</p> <p><img src="https://dhc.pythonanywhere.com/media/editor/MySQL%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84_20220315034329549927.png%22%E7%BB%93%E6%9E%84%E5%9B%BE%22" alt="结构图"> <img src="https://dhc.pythonanywhere.com/media/editor/MySQL%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%B1%82%E7%BA%A7%E5%90%AB%E4%B9%89_20220315034359342837.png%22%E5%B1%82%E7%BA%A7%E6%8F%8F%E8%BF%B0%22" alt="层级描述"></p> <p><strong>引擎层</strong>：</p> <p>存储引擎层， 存储引擎真正的负责了MySQL中数据的存储和提取，服务器通过API和存储引擎进行通
信。不同的存储引擎具有不同的功能，这样我们可以根据自己的需要，来选取合适的存储引擎。数据库
中的索引是在存储引擎层实现的。</p> <p>存储引擎就是存储数据、建立索引、更新/查询数据等技术的实现方式。==存储引擎是基于表而不是基于库的，所以存储引擎也可以被称为表引擎。==
默认存储引擎是InnoDB。</p> <p>相关操作：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询建表语句</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">table</span> account<span class="token punctuation">;</span>
<span class="token comment">-- 建表时指定存储引擎</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看当前数据库支持的存储引擎</span>
<span class="token keyword">show</span> engines<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="innodb"><a href="#innodb" class="header-anchor">#</a> InnoDB</h4> <p>InnoDB 是一种兼顾高可靠性和高性能的通用存储引擎，在 MySQL 5.5 之后，InnoDB 是默认的 MySQL 引擎。</p> <p>特点：</p> <ul><li>DML 操作遵循 ACID 模型，支持<strong>事务</strong></li> <li><strong>行级锁</strong>，提高并发访问性能</li> <li>支持<strong>外键</strong>约束，保证数据的完整性和正确性</li></ul> <p>文件：</p> <ul><li>xxx.ibd: xxx代表表名，InnoDB 引擎的每张表都会对应这样一个表空间文件，存储该表的表结构（frm、sdi）、数据和索引。</li></ul> <p>参数：innodb_file_per_table，决定多张表共享一个表空间还是每张表对应一个表空间</p> <p>知识点：</p> <p>查看 Mysql 变量：
<code>show variables like 'innodb_file_per_table';</code></p> <p>从idb文件提取表结构数据：
（在cmd运行）
<code>ibd2sdi xxx.ibd</code></p> <p>InnoDB 逻辑存储结构：
<img src="https://dhc.pythonanywhere.com/media/editor/%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84_20220316030616590001.png%22InnoDB%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%22" alt="InnoDB逻辑存储结构"></p> <ul><li>表空间 : InnoDB存储引擎逻辑结构的最高层，ibd文件其实就是表空间文件，在表空间中可以
包含多个Segment段。</li> <li>段 : 表空间是由各个段组成的， 常见的段有数据段、索引段、回滚段等。InnoDB中对于段的管
理，都是引擎自身完成，不需要人为对其控制，一个段中包含多个区。</li> <li>区 : 区是表空间的单元结构，每个区的大小为1M。 默认情况下， InnoDB存储引擎页大小为
16K， 即一个区中一共有64个连续的页。</li> <li>页 : 页是组成区的最小单元，页也是InnoDB 存储引擎磁盘管理的最小单元，每个页的大小默
认为 16KB。为了保证页的连续性，InnoDB 存储引擎每次从磁盘申请 4-5 个区。</li> <li>行 : InnoDB 存储引擎是面向行的，也就是说数据是按行进行存放的，在每一行中除了定义表时
所指定的字段以外，还包含两个隐藏字段(后面会详细介绍)。</li></ul> <h4 id="myisam"><a href="#myisam" class="header-anchor">#</a> MyISAM</h4> <p>MyISAM 是 MySQL 早期的默认存储引擎。</p> <p>特点：</p> <ul><li>不支持事务，不支持外键</li> <li>支持表锁，不支持行锁</li> <li>访问速度快</li></ul> <p>文件：</p> <ul><li>xxx.sdi: 存储表结构信息</li> <li>xxx.MYD: 存储数据</li> <li>xxx.MYI: 存储索引</li></ul> <h4 id="memory"><a href="#memory" class="header-anchor">#</a> Memory</h4> <p>Memory 引擎的表数据是存储在内存中的，受硬件问题、断电问题的影响，只能将这些表作为临时表或缓存使用。</p> <p>特点：</p> <ul><li>存放在内存中，速度快</li> <li>hash索引（默认）</li></ul> <p>文件：</p> <ul><li>xxx.sdi: 存储表结构信息</li></ul> <h4 id="存储引擎特点"><a href="#存储引擎特点" class="header-anchor">#</a> 存储引擎特点</h4> <table><thead><tr><th>特点</th> <th>InnoDB</th> <th>MyISAM</th> <th>Memory</th></tr></thead> <tbody><tr><td>存储限制</td> <td>64TB</td> <td>有</td> <td>有</td></tr> <tr><td>事务安全</td> <td>支持</td> <td>-</td> <td>-</td></tr> <tr><td>锁机制</td> <td>行锁</td> <td>表锁</td> <td>表锁</td></tr> <tr><td>B+tree索引</td> <td>支持</td> <td>支持</td> <td>支持</td></tr> <tr><td>Hash索引</td> <td>-</td> <td>-</td> <td>支持</td></tr> <tr><td>全文索引</td> <td>支持（5.6版本之后）</td> <td>支持</td> <td>-</td></tr> <tr><td>空间使用</td> <td>高</td> <td>低</td> <td>N/A</td></tr> <tr><td>内存使用</td> <td>高</td> <td>低</td> <td>中等</td></tr> <tr><td>批量插入速度</td> <td>低</td> <td>高</td> <td>高</td></tr> <tr><td>支持外键</td> <td>支持</td> <td>-</td> <td>-</td></tr></tbody></table> <p><strong>面试题：</strong></p> <p>InnoDB引擎与MyISAM引擎的区别 ?
①. InnoDB引擎, 支持事务, 而MyISAM不支持。
②. InnoDB引擎, 支持行锁和表锁, 而MyISAM仅支持表锁, 不支持行锁。
③. InnoDB引擎, 支持外键, 而MyISAM是不支持的。</p> <h4 id="存储引擎的选择"><a href="#存储引擎的选择" class="header-anchor">#</a> 存储引擎的选择</h4> <p>在选择存储引擎时，应该根据应用系统的特点选择合适的存储引擎。对于复杂的应用系统，还可以根据实际情况选择多种存储引擎进行组合。</p> <ul><li>InnoDB: 如果应用对事物的完整性有比较高的要求，在并发条件下要求数据的一致性，数据操作除了插入和查询之外，还包含很多的更新、删除操作，则 InnoDB 是比较合适的选择</li> <li>MyISAM: 如果应用是以读操作和插入操作为主，只有很少的更新和删除操作，并且对事务的完整性、并发性要求不高，那这个存储引擎是非常合适的。</li> <li>Memory: 将所有数据保存在内存中，访问速度快，通常用于临时表及缓存。Memory 的缺陷是对表的大小有限制，太大的表无法缓存在内存中，而且无法保障数据的安全性</li></ul> <p>电商中的足迹和评论适合使用 MyISAM 引擎，缓存适合使用 Memory 引擎。</p> <h3 id="性能分析"><a href="#性能分析" class="header-anchor">#</a> 性能分析</h3> <h4 id="查看执行频次"><a href="#查看执行频次" class="header-anchor">#</a> 查看执行频次</h4> <p>查看当前数据库的 INSERT, UPDATE, DELETE, SELECT 访问频次：
<code>SHOW GLOBAL STATUS LIKE 'Com_______';</code> 或者 <code>SHOW SESSION STATUS LIKE 'Com_______';</code>
例：<code>show global status like 'Com_______'</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- session 是查看当前会话 ;</span>
<span class="token comment">-- global 是查询全局数据 ;</span>
<span class="token keyword">SHOW</span>  <span class="token keyword">GLOBAL</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span>  <span class="token string">'Com_______'</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>通过上述指令，我们可以查看到当前数据库到底是以查询为主库优化提供参考依据。 如果是以增删改为主，我们可以考虑不对其进行索引的优化查询为主，那么就要考虑对数据库的索引进行优化了。</p></blockquote> <h4 id="慢查询日志"><a href="#慢查询日志" class="header-anchor">#</a> 慢查询日志</h4> <p>慢查询日志记录了所有执行时间超过指定参数（long_query_time，单位：秒，默认10秒）的所有SQL语句的日志。
MySQL的慢查询日志默认没有开启，需要在MySQL的配置文件（/etc/my.cnf）中配置如下信息：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查看慢查询日志开关状态：</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'slow_query_log'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/1677034765023.png" alt="1677034765023"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 开启慢查询日志开关</span>
slow_query_log<span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">## 设置慢查询日志的时间为2秒，SQL语句执行时间超过2秒，就会视为慢查询，记录慢查询日志</span>
long_query_time<span class="token operator">=</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>更改后记得重启MySQL服务，日志文件位置：/var/lib/mysql/localhost-slow.log</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>systemctl restart mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="profile"><a href="#profile" class="header-anchor">#</a> profile</h4> <p>show profile 能在做SQL优化时帮我们了解时间都耗费在哪里。通过 have_profiling 参数，能看到当前 MySQL 是否支持 profile 操作：
<code>SELECT @@have_profiling;</code>
profiling 默认关闭，可以通过set语句在session/global级别开启 profiling：
<code>SET profiling = 1;</code>
查看所有语句的耗时：
<code>show profiles;</code>
查看指定query_id的SQL语句各个阶段的耗时：
<code>show profile for query query_id;</code>
查看指定query_id的SQL语句CPU的使用情况
<code>show profile cpu for query query_id;</code></p> <h4 id="explain"><a href="#explain" class="header-anchor">#</a> explain</h4> <p>EXPLAIN 或者 DESC 命令获取 MySQL 如何执行 SELECT 语句的信息，包括在 SELECT 语句执行过程中表如何连接和连接的顺序。
语法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 直接在select语句之前加上关键字 explain / desc</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表名 HWERE 条件<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>EXPLAIN 各字段含义：</p> <ul><li>id：select 查询的序列号，表示查询中执行 select 子句或者操作表的顺序（id相同，执行顺序从上到下；id不同，值越大越先执行）</li> <li>select_type：表示 SELECT 的类型，常见取值有 SIMPLE（简单表，即不适用表连接或者子查询）、PRIMARY（主查询，即外层的查询）、UNION（UNION中的第二个或者后面的查询语句）、SUBQUERY（SELECT/WHERE之后包含了子查询）等</li> <li>type：表示连接类型，性能由好到差的连接类型为 NULL、system、const、eq_ref、ref、range、index、all</li> <li>possible_key：可能应用在这张表上的索引，一个或多个</li> <li>Key：实际使用的索引，如果为 NULL，则没有使用索引</li> <li>Key_len：表示索引中使用的字节数，该值为索引字段最大可能长度，并非实际使用长度，在不损失精确性的前提下，长度越短越好</li> <li>rows：MySQL认为必须要执行的行数，在InnoDB引擎的表中，是一个估计值，可能并不总是准确的</li> <li>filtered：表示返回结果的行数占需读取行数的百分比，filtered的值越大越好</li></ul> <h3 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h3> <p>索引是帮助 MySQL <strong>高效获取数据</strong>的<strong>数据结构（有序）</strong>。在数据之外，数据库系统还维护着满足特定查找算法的数据结构，这些数据结构以某种方式引用（指向）数据，这样就可以在这些数据结构上实现高级查询算法，这种数据结构就是索引。</p> <p>优缺点：</p> <p>优点：</p> <ul><li>提高数据检索效率，降低数据库的IO成本</li> <li>通过索引列对数据进行排序，降低数据排序的成本，降低CPU的消耗</li></ul> <p>缺点：</p> <ul><li>索引列也是要占用空间的</li> <li>索引大大提高了查询效率，但降低了更新的速度，比如 INSERT、UPDATE、DELETE</li></ul> <h4 id="索引结构"><a href="#索引结构" class="header-anchor">#</a> 索引结构</h4> <table><thead><tr><th>索引结构</th> <th>描述</th></tr></thead> <tbody><tr><td>B+Tree</td> <td>最常见的索引类型，大部分引擎都支持B+树索引</td></tr> <tr><td>Hash</td> <td>底层数据结构是用哈希表实现，只有精确匹配索引列的查询才有效，不支持范围查询</td></tr> <tr><td>R-Tree(空间索引)</td> <td>空间索引是 MyISAM 引擎的一个特殊索引类型，主要用于地理空间数据类型，通常使用较少</td></tr> <tr><td>Full-Text(全文索引)</td> <td>是一种通过建立倒排索引，快速匹配文档的方式，类似于 Lucene, Solr, ES</td></tr></tbody></table> <table><thead><tr><th>索引</th> <th>InnoDB</th> <th>MyISAM</th> <th>Memory</th></tr></thead> <tbody><tr><td>B+Tree索引</td> <td>支持</td> <td>支持</td> <td>支持</td></tr> <tr><td>Hash索引</td> <td>不支持</td> <td>不支持</td> <td>支持</td></tr> <tr><td>R-Tree索引</td> <td>不支持</td> <td>支持</td> <td>不支持</td></tr> <tr><td>Full-text</td> <td>5.6版本后支持</td> <td>支持</td> <td>不支持</td></tr></tbody></table> <p><strong>注意：</strong> 我们平常所说的索引，如果没有特别指明，都是指B+树结构组织的索引。</p> <h5 id="b-tree"><a href="#b-tree" class="header-anchor">#</a> B-Tree</h5> <p><img src="https://dhc.pythonanywhere.com/media/editor/%E4%BA%8C%E5%8F%89%E6%A0%91_20220316153214227108.png%22%E4%BA%8C%E5%8F%89%E6%A0%91%22" alt="二叉树"></p> <p>二叉树的缺点可以用红黑树来解决：
<img src="https://dhc.pythonanywhere.com/media/editor/%E7%BA%A2%E9%BB%91%E6%A0%91_20220316163142686602.png%22%E7%BA%A2%E9%BB%91%E6%A0%91%22" alt="红黑树">
红黑树也存在大数据量情况下，层级较深，检索速度慢的问题。</p> <p>为了解决上述问题，可以使用 B-Tree 结构。
B-Tree (多路平衡查找树) 以一棵最大度数（max-degree，指一个节点的子节点个数）为5（5阶）的 b-tree 为例（每个节点最多存储4个key，5个指针）</p> <p><img src="https://dhc.pythonanywhere.com/media/editor/B-Tree%E7%BB%93%E6%9E%84_20220316163813441163.png%22B-Tree%E7%BB%93%E6%9E%84%22" alt="B-Tree结构"></p> <blockquote><p>B-Tree 的数据插入过程动画参照：https://www.bilibili.com/video/BV1Kr4y1i7ru?p=68
演示地址：https://www.cs.usfca.edu/~galles/visualization/BTree.html</p></blockquote> <h5 id="b-tree-2"><a href="#b-tree-2" class="header-anchor">#</a> B+Tree</h5> <p>结构图：</p> <p><img src="https://dhc.pythonanywhere.com/media/editor/B+Tree%E7%BB%93%E6%9E%84%E5%9B%BE_20220316170700591277.png" alt="B+Tree结构图" title="B+Tree结构图"></p> <blockquote><p>演示地址：https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html</p></blockquote> <p>与 B-Tree 的区别：</p> <ul><li>所有的数据都会出现在叶子节点</li> <li>叶子节点形成一个单向链表</li></ul> <p>MySQL 索引数据结构对经典的 B+Tree 进行了优化。在原 B+Tree 的基础上，增加一个指向相邻叶子节点的链表指针，就形成了带有顺序指针的 B+Tree，提高区间访问的性能。</p> <p>![MySQL B+Tree 结构图](https://dhc.pythonanywhere.com/media/editor/结构图_20220316171730865611.png&quot;MySQL B+Tree 结构图&quot;)</p> <h5 id="hash"><a href="#hash" class="header-anchor">#</a> Hash</h5> <p>哈希索引就是采用一定的hash算法，将键值换算成新的hash值，映射到对应的槽位上，然后存储在hash表中。
如果两个（或多个）键值，映射到一个相同的槽位上，他们就产生了hash冲突（也称为hash碰撞），可以通过链表来解决。</p> <p><img src="https://dhc.pythonanywhere.com/media/editor/Hash%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86%E5%9B%BE_20220317143226150679.png" alt="Hash索引原理图" title="Hash索引原理图"></p> <p>特点：</p> <ul><li>Hash索引只能用于对等比较（=、in），不支持范围查询（betwwn、&gt;、&lt;、...）</li> <li>无法利用索引完成排序操作</li> <li>查询效率高，通常只需要一次检索就可以了，效率通常要高于 B+Tree 索引</li></ul> <p>存储引擎支持：</p> <ul><li>Memory</li> <li>InnoDB: 具有自适应hash功能，hash索引是存储引擎根据 B+Tree 索引在指定条件下自动构建的</li></ul> <h5 id="面试题"><a href="#面试题" class="header-anchor">#</a> 面试题</h5> <ol><li>为什么 InnoDB 存储引擎选择使用 B+Tree 索引结构？</li></ol> <ul><li>相对于二叉树，层级更少，搜索效率高</li> <li>对于 B-Tree，无论是叶子节点还是非叶子节点，都会保存数据，这样导致一页中存储的键值减少，指针也跟着减少，要同样保存大量数据，只能增加树的高度，导致性能降低</li> <li>相对于 Hash 索引，B+Tree 支持范围匹配及排序操作</li></ul> <h4 id="索引分类"><a href="#索引分类" class="header-anchor">#</a> 索引分类</h4> <table><thead><tr><th>分类</th> <th>含义</th> <th>特点</th> <th>关键字</th></tr></thead> <tbody><tr><td>主键索引</td> <td>针对于表中主键创建的索引</td> <td>默认自动创建，只能有一个</td> <td>PRIMARY</td></tr> <tr><td>唯一索引</td> <td>避免同一个表中某数据列中的值重复</td> <td>可以有多个</td> <td>UNIQUE</td></tr> <tr><td>常规索引</td> <td>快速定位特定数据</td> <td>可以有多个</td> <td></td></tr> <tr><td>全文索引</td> <td>全文索引查找的是文本中的关键词，而不是比较索引中的值</td> <td>可以有多个</td> <td>FULLTEXT</td></tr></tbody></table> <p>在 InnoDB 存储引擎中，根据索引的存储形式，又可以分为以下两种：</p> <table><thead><tr><th>分类</th> <th>含义</th> <th>特点</th></tr></thead> <tbody><tr><td>聚集索引(Clustered Index)</td> <td>将数据存储与索引放一块，索引结构的叶子节点保存了行数据</td> <td>必须有，而且只有一个</td></tr> <tr><td>二级索引(Secondary Index)</td> <td>将数据与索引分开存储，索引结构的叶子节点关联的是对应的主键</td> <td>可以存在多个</td></tr></tbody></table> <p>演示图：</p> <p><img src="https://dhc.pythonanywhere.com/media/editor/%E5%8E%9F%E7%90%86%E5%9B%BE_20220318194454880073.png%22%E5%A4%A7%E8%87%B4%E5%8E%9F%E7%90%86%22" alt="大致原理"> <img src="https://dhc.pythonanywhere.com/media/editor/%E6%BC%94%E7%A4%BA%E5%9B%BE_20220319215403721066.png%22%E6%BC%94%E7%A4%BA%E5%9B%BE%22" alt="演示图"></p> <ul><li>聚集索引的叶子节点下挂的是这一行的数据 。</li> <li>二级索引的叶子节点下挂的是该字段值对应的主键值。</li></ul> <p>聚集索引选取规则：</p> <ul><li>如果存在主键，主键索引就是聚集索引</li> <li>如果不存在主键，将使用第一个唯一(UNIQUE)索引作为聚集索引</li> <li>如果表没有主键或没有合适的唯一索引，则 InnoDB 会自动生成一个 rowid 作为隐藏的聚集索引</li></ul> <h5 id="思考题"><a href="#思考题" class="header-anchor">#</a> 思考题</h5> <p>1. 以下 SQL 语句，哪个执行效率高？为什么？</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'Arm'</span><span class="token punctuation">;</span>
<span class="token comment">-- 备注：id为主键，name字段创建的有索引</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>答：第一条语句（存在主键，主键索引就是聚集索引），因为第二条需要回表查询，相当于两个步骤。因为A语句直接走聚集索引，直接返回数据。 而B语句需要先查询name字段的二级索引，然后再查询聚集索引，也就是需要进行回表查询。</p> <p>2. InnoDB 主键索引的 B+Tree 高度为多少？</p> <p>答：假设一行数据大小为1k，一页中可以存储16行这样的数据。InnoDB 的指针占用6个字节的空间，主键假设为bigint，占用字节数为8.
可得公式：<code>n * 8 + (n + 1) * 6 = 16 * 1024</code>，其中 8 表示 bigint 占用的字节数，n 表示当前节点存储的key的数量，(n + 1) 表示指针数量（比key多一个）。算出n约为1170。</p> <p>如果树的高度为2，那么他能存储的数据量大概为：<code>1171 * 16 = 18736</code>；
如果树的高度为3，那么他能存储的数据量大概为：<code>1171 * 1171 * 16 = 21939856</code>。</p> <p>另外，如果有成千上万的数据，那么就要考虑分表，涉及运维篇知识。</p> <h4 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h4> <p>创建索引：
<code>CREATE [ UNIQUE | FULLTEXT ] INDEX index_name ON table_name (index_col_name, ...);</code>
如果不加 CREATE 后面不加索引类型参数，则创建的是常规索引</p> <p>查看索引：
<code>SHOW INDEX FROM table_name;</code></p> <p>删除索引：
<code>DROP INDEX index_name ON table_name;</code></p> <p>查看索引：</p> <p><code>SHOW INDEX FROM table_name;</code></p> <p>案例：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- name字段为姓名字段，该字段的值可能会重复，为该字段创建索引</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_name <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- phone手机号字段的值非空，且唯一，为该字段创建唯一索引</span>
<span class="token keyword">create</span> <span class="token keyword">unique</span> <span class="token keyword">index</span> idx_user_phone <span class="token keyword">on</span> tb_user <span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 为profession, age, status创建联合索引</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_pro_age_stat <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>profession<span class="token punctuation">,</span> age<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 为email建立合适的索引来提升查询效率</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_email <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看tb_user表的所有的索引数据</span>
<span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> tb_user<span class="token punctuation">;</span>

<span class="token comment">-- 删除索引</span>
<span class="token keyword">drop</span> <span class="token keyword">index</span> idx_user_email <span class="token keyword">on</span> tb_user<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="使用规则"><a href="#使用规则" class="header-anchor">#</a> 使用规则</h4> <h5 id="最左前缀法则"><a href="#最左前缀法则" class="header-anchor">#</a> 最左前缀法则</h5> <p>如果索引关联了多列（联合索引），要遵守最左前缀法则，最左前缀法则指的是查询从索引的最左列开始，并且不跳过索引中的列。
如果跳跃某一列，索引将部分失效（后面的字段索引失效）。</p> <p><img src="/assets/1677066496595.png" alt="1677066496595"></p> <p>联合索引中，出现范围查询（&lt;, &gt;），范围查询右侧的列索引失效。在业务允许的情况下，尽量使用&gt;=或者&lt;=来规避索引失效问题。</p> <h5 id="索引失效情况"><a href="#索引失效情况" class="header-anchor">#</a> 索引失效情况</h5> <ol><li><p>在索引列上进行运算操作，索引将失效。如：<code>explain select * from tb_user where substring(phone, 10, 2) = '15';</code></p></li> <li><p>字符串类型字段使用时，不加引号，索引将失效。如：<code>explain select * from tb_user where phone = 17799990015;</code>，此处phone的值没有加引号</p> <p>==（如果字符串不加单引号，对于查询结果，没什么影响，但是数据库存在隐式类型转换，索引将失效。）==</p></li> <li><p>模糊查询中，如果仅仅是尾部模糊匹配，索引不会是失效；如果是头部模糊匹配，索引失效。如：<code>explain select * from tb_user where profession like '%工程';</code>，前后都有 % 也会失效。</p></li> <li><p>用 or 分割开的条件，如果 or 其中一个条件的列没有索引，那么涉及的索引都不会被用到。</p></li> <li><p>如果 MySQL 评估使用索引比全表更慢，则不使用索引。</p> <ol><li>MySQL在查询时，会评估使用索引的效率与走全表扫描的效率，如果走全表扫描更快，则放弃索引，走全表扫描。 因为索引是用来索引少量数据的，如果通过索引查询返回大批量的数据，则还不如走全表扫描来的快，此时索引就会失效。</li> <li>一模一样的SQL语句，先后执行了两次，结果查询计划是不一样的，为什么会出现这种现象，这是和数据库的数据分布有关系。查询时MySQL会评估，走索引快，还是全表扫描快，如果全表扫描更快，则放弃索引走全表扫描。 因此，is null 、is not null是否走索引，得具体情况具体分析，并不是固定的。</li></ol></li></ol> <h5 id="sql-提示"><a href="#sql-提示" class="header-anchor">#</a> SQL 提示</h5> <p>是优化数据库的一个重要手段，简单来说，就是在SQL语句中加入一些人为的提示来达到优化操作的目的。</p> <p>例如，使用索引：
<code>explain select * from tb_user use index(idx_user_pro) where profession=&quot;软件工程&quot;;</code>
不使用哪个索引：
<code>explain select * from tb_user ignore index(idx_user_pro) where profession=&quot;软件工程&quot;;</code>
必须使用哪个索引：
<code>explain select * from tb_user force index(idx_user_pro) where profession=&quot;软件工程&quot;;</code></p> <p>use 是建议，实际使用哪个索引 MySQL 还会自己权衡运行速度去更改，force就是无论如何都强制使用该索引。</p> <h5 id="覆盖索引-回表查询"><a href="#覆盖索引-回表查询" class="header-anchor">#</a> 覆盖索引&amp;回表查询</h5> <p>**覆盖索引：**覆盖索引是指查询使用了索引，并且需要返回的列，在该索引中已经全部能够找到 。</p> <p>尽量使用覆盖索引（查询使用了索引，并且需要返回的列，在该索引中已经全部能找到），减少 select *。</p> <p>explain 中 extra 字段含义：
<code>using index condition</code>：查找使用了索引，但是需要回表查询数据
<code>using where; using index;</code>：查找使用了索引，但是需要的数据都在索引列中能找到，所以不需要回表查询</p> <ul><li>如果一直使用select * 查询返回所有字段值，很容易就会造成回表查询（除非是根据主键查询，此时只会扫描聚集索引）。</li></ul> <p>如果在聚集索引中直接能找到对应的行，则直接返回行数据，只需要一次查询，哪怕是select *；如果在辅助索引中找聚集索引，如<code>select id, name from xxx where name='xxx';</code>，也只需要通过辅助索引(name)查找到对应的id，返回name和name索引对应的id即可，只需要一次查询；如果是通过辅助索引查找其他字段，则需要回表查询，如<code>select id, name, gender from xxx where name='xxx';</code></p> <p>所以尽量不要用<code>select *</code>，容易出现回表查询，降低效率，除非有联合索引包含了所有字段</p> <blockquote><p>面试题：一张表，有四个字段（id, username, password, status），由于数据量大，需要对以下SQL语句进行优化，该如何进行才是最优方案：
<code>select id, username, password from tb_user where username='itcast';</code></p> <p>解：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 针对于 username, password建立联合索引, sql为: </span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_name_pass <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>给username和password字段建立联合索引，则不需要回表查询，直接覆盖索引</p></blockquote> <h5 id="前缀索引"><a href="#前缀索引" class="header-anchor">#</a> 前缀索引</h5> <p>当字段类型为字符串（varchar, text等）时，有时候需要索引很长的字符串，这会让索引变得很大，查询时，浪费大量的磁盘IO，影响查询效率，此时可以只降字符串的一部分前缀，建立索引，这样可以大大节约索引空间，从而提高索引效率。</p> <p>语法：<code>create index idx_xxxx on table_name(columnn(n));</code>
前缀长度：可以根据索引的选择性来决定，而选择性是指不重复的索引值（基数）和数据表的记录总数的比值，索引选择性越高则查询效率越高，唯一索引的选择性是1，这是最好的索引选择性，性能也是最好的。
求选择性公式：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> email<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tb_user<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> substring<span class="token punctuation">(</span>email<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tb_user<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>show index 里面的sub_part可以看到接取的长度</p> <h5 id="单列索引-联合索引"><a href="#单列索引-联合索引" class="header-anchor">#</a> 单列索引&amp;联合索引</h5> <p>单列索引：即一个索引只包含单个列
联合索引：即一个索引包含了多个列</p> <blockquote><p>在业务场景中，如果存在多个查询条件，考虑针对于查询字段建立索引时，建议建立联合索引，而非单列索引。</p></blockquote> <p>单列索引情况：
<code>explain select id, phone, name from tb_user where phone = '17799990010' and name = '韩信';</code>
这句只会用到phone索引字段</p> <h6 id="注意事项-9"><a href="#注意事项-9" class="header-anchor">#</a> 注意事项</h6> <ul><li>多条件联合查询时，MySQL优化器会评估哪个字段的索引效率更高，会选择该索引完成本次查询</li></ul> <h4 id="设计原则"><a href="#设计原则" class="header-anchor">#</a> 设计原则</h4> <ol><li>针对于数据量较大，且查询比较频繁的表建立索引</li> <li>针对于常作为查询条件（where）、排序（order by）、分组（group by）操作的字段建立索引</li> <li>尽量选择区分度高的列作为索引，尽量建立唯一索引，区分度越高，使用索引的效率越高</li> <li>如果是字符串类型的字段，字段长度较长，可以针对于字段的特点，建立前缀索引</li> <li>尽量==使用联合索引，减少单列索引==，查询时，联合索引很多时候可以覆盖索引，节省存储空间，避免回表，提高查询效率</li> <li>要控制索引的数量，索引并不是多多益善，索引越多，维护索引结构的代价就越大，会影响增删改的效率</li> <li>如果索引列不能存储NULL值，请在创建表时使用NOT NULL约束它。当优化器知道每列是否包含NULL值时，它可以更好地确定哪个索引最有效地用于查询</li></ol> <h3 id="sql-优化"><a href="#sql-优化" class="header-anchor">#</a> SQL 优化</h3> <h4 id="插入数据"><a href="#插入数据" class="header-anchor">#</a> 插入数据</h4> <p>普通插入：</p> <ol><li><p>采用批量插入（一次插入的数据不建议超过1000条）</p></li> <li><p>手动提交事务</p> <p><img src="/assets/1677071642379.png" alt="1677071642379"></p></li> <li><p>主键顺序插入</p> <p><img src="/assets/1677071663491.png" alt="1677071663491"></p></li></ol> <p>大批量插入：
如果一次性需要插入大批量数据，使用insert语句插入性能较低，此时可以使用MySQL数据库提供的load指令插入。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 客户端连接服务端时，加上参数 --local-infile（这一行在bash/cmd界面输入）</span>
mysql <span class="token comment">--local-infile -u root -p</span>
<span class="token comment">## 设置全局参数local_infile为1，开启从本地加载文件导入数据的开关</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> local_infile <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> @<span class="token variable">@local_infile</span><span class="token punctuation">;</span>
<span class="token comment">## 执行load指令将准备好的数据，加载到表结构中</span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> <span class="token keyword">infile</span> <span class="token string">'/root/sql1.log'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> <span class="token string">'tb_user'</span> <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">','</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="主键优化"><a href="#主键优化" class="header-anchor">#</a> 主键优化</h4> <p>数据组织方式：在InnoDB存储引擎中，表数据都是根据主键顺序组织存放的，这种存储方式的表称为索引组织表（Index organized table, IOT）</p> <ul><li>在InnoDB引擎中，数据行是记录在逻辑结构 page 页中的，而每一个页的大小是固定的，默认16K。那也就意味着， 一个页中所存储的行也是有限的，如果插入的数据行row在该页存储不小，将会存储到下一个页中，页与页之间会通过指针连接。</li></ul> <p>页分裂：页可以为空，也可以填充一般，也可以填充100%，每个页包含了2-N行数据（如果一行数据过大，会行溢出），根据主键排列。
(移动数据，并插入id为50的数据之后，那么此时，这三个页之间的数据顺序是有问题的
页，应该是3#， 3#的下一个页是2#。 所以，此时，需要重新设置链表指针。)</p> <p>页合并：当删除一行记录时，实际上记录并没有被物理删除，只是记录被标记（flaged）为删除并且它的空间变得允许被其他记录声明使用。当页中删除的记录到达 MERGE_THRESHOLD（默认为页的50%），InnoDB会开始寻找最靠近的页（前后）看看是否可以将这两个页合并以优化空间使用。
(MERGE_THRESHOLD：合并页的阈值，可以自己设置，在创建表或创建索引时指定)</p> <blockquote><p>文字说明不够清晰明了，具体可以看视频里的PPT演示过程：https://www.bilibili.com/video/BV1Kr4y1i7ru?p=90</p></blockquote> <p>主键设计原则：</p> <ul><li>满足业务需求的情况下，尽量降低主键的长度</li> <li>插入数据时，尽量选择顺序插入，选择使用 AUTO_INCREMENT 自增主键</li> <li>尽量不要使用 UUID 做主键或者是其他的自然主键，如身份证号</li> <li>业务操作时，避免对主键的修改</li></ul> <h4 id="order-by优化"><a href="#order-by优化" class="header-anchor">#</a> order by优化</h4> <ol><li>Using filesort：通过表的索引或全表扫描，读取满足条件的数据行，然后在排序缓冲区 sort buffer 中完成排序操作，所有不是通过索引直接返回排序结果的排序都叫 FileSort 排序</li> <li>Using index：通过有序索引顺序扫描直接返回有序数据，这种情况即为 using index，不需要额外排序，操作效率高</li></ol> <ul><li><p>排序时,也需要满足最左前缀法则,否则也会出现 filesort。因为在创建索引的时候， age是第一个字段，phone是第二个字段，所以排序时，也就该按照这个顺序来，否则就会出现 Using filesort。</p></li> <li><p>如果order by字段全部使用升序排序或者降序排序，则都会走索引，但是如果一个字段升序排序，另一个字段降序排序，则不会走索引，explain的extra信息显示的是<code>Using index, Using filesort</code>，
如果要优化掉Using filesort，则需要另外再创建一个索引，如：<code>create index idx_user_age_phone_ad on tb_user(age asc, phone desc);</code>  –索引中age升序排列、phone降序排列，此时使用<code>select id, age, phone from tb_user order by age asc, phone desc;</code>会全部走索引</p></li></ul> <p>总结：</p> <ul><li>根据排序字段建立合适的索引，多字段排序时，也遵循最左前缀法则</li> <li>尽量使用覆盖索引</li> <li>多字段排序，一个升序一个降序，此时需要注意联合索引在创建时的规则（ASC/DESC）</li> <li>如果不可避免出现filesort，大数据量排序时，可以适当增大排序缓冲区大小 sort_buffer_size（默认256k）</li></ul> <h4 id="group-by优化"><a href="#group-by优化" class="header-anchor">#</a> group by优化</h4> <ul><li>在分组操作时，可以通过索引来提高效率</li> <li>分组操作时，索引的使用也是满足最左前缀法则的</li></ul> <p>如索引为<code>idx_user_pro_age_stat</code>，则句式可以是<code>select ... where profession order by age</code>，这样也符合最左前缀法则</p> <h4 id="limit优化"><a href="#limit优化" class="header-anchor">#</a> limit优化</h4> <p>常见的问题如<code>limit 2000000, 10</code>，此时需要 MySQL 排序前2000000条记录，但仅仅返回2000000 - 2000010的记录，其他记录丢弃，查询排序的代价非常大。
优化方案：一般分页查询时，通过创建覆盖索引能够比较好地提高性能，可以通过覆盖索引加子查询形式进行优化</p> <p>例如：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 此语句耗时很长</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_sku <span class="token keyword">limit</span> <span class="token number">9000000</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token comment">-- 通过覆盖索引加快速度，直接通过主键索引进行排序及查询（主键的id索引就是覆盖索引）</span>
<span class="token keyword">select</span> id <span class="token keyword">from</span> tb_sku <span class="token keyword">order</span> <span class="token keyword">by</span> id <span class="token keyword">limit</span> <span class="token number">9000000</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token comment">-- 下面的语句是错误的，因为 MySQL 不支持 in 里面使用 limit</span>
<span class="token comment">-- select * from tb_sku where id in (select id from tb_sku order by id limit 9000000, 10);</span>
<span class="token comment">-- 通过连表查询即可实现第一句的效果，并且能达到第二句的速度</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_sku <span class="token keyword">as</span> s<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id <span class="token keyword">from</span> tb_sku <span class="token keyword">order</span> <span class="token keyword">by</span> id <span class="token keyword">limit</span> <span class="token number">9000000</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a <span class="token keyword">where</span> s<span class="token punctuation">.</span>id <span class="token operator">=</span> a<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="count优化"><a href="#count优化" class="header-anchor">#</a> count优化</h4> <p>MyISAM 引擎把一个表的总行数存在了磁盘上，因此执行 count(*) 的时候会直接返回这个数，效率很高（前提是不适用where）；
InnoDB 在执行 count(*) 时，需要把数据一行一行地从引擎里面读出来，然后累计计数。
优化方案：自己计数，如创建key-value表存储在内存或硬盘，或者是用redis</p> <p>count的几种用法：</p> <ul><li>如果count函数的参数（count里面写的那个字段）不是NULL（字段值不为NULL），累计值就加一，最后返回累计值</li> <li>用法：count(*)、count(主键)、count(字段)、count(1)</li> <li>count(主键)跟count(*)一样，因为主键不能为空；count(字段)只计算字段值不为NULL的行；count(1)引擎会为每行添加一个1，然后就count这个1，返回结果也跟count(*)一样；count(null)返回0</li></ul> <p>各种用法的性能：</p> <ul><li>count(主键)：InnoDB引擎会遍历整张表，把每行的主键id值都取出来，返回给服务层，服务层拿到主键后，直接按行进行累加（主键不可能为空）</li> <li>count(字段)：没有not null约束的话，InnoDB引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，服务层判断是否为null，不为null，计数累加；有not null约束的话，InnoDB引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，直接按行进行累加</li> <li>count(1)：InnoDB 引擎遍历整张表，但不取值。服务层对于返回的每一层，放一个数字 1 进去，直接按行进行累加</li> <li>count(*)：InnoDB 引擎并不会把全部字段取出来，而是专门做了优化，不取值，服务层直接按行进行累加</li></ul> <p>按效率排序：count(字段) &lt; count(主键) &lt; count(1) &lt; count(*)，所以尽量使用 count(*)</p> <h4 id="update优化-避免行锁升级为表锁"><a href="#update优化-避免行锁升级为表锁" class="header-anchor">#</a> update优化（避免行锁升级为表锁）</h4> <p><img src="/assets/1677075420545.png" alt="1677075420545"></p> <p><img src="/assets/1677075395510.png" alt="1677075395510"></p> <p>InnoDB 的行锁是针对索引加的锁，不是针对记录加的锁，并且该索引不能失效，否则会从行锁升级为表锁。</p> <p>如以下两条语句：
<code>update student set no = '123' where id = 1;</code>，这句由于id有主键索引，所以只会锁这一行；
<code>update student set no = '123' where name = 'test';</code>，这句由于name没有索引，所以会把整张表都锁住进行数据更新，解决方法是给name字段添加索引</p> <h3 id="视图-存储过程-触发器"><a href="#视图-存储过程-触发器" class="header-anchor">#</a> 视图/存储过程/触发器</h3> <h4 id="视图"><a href="#视图" class="header-anchor">#</a> 视图</h4> <p>视图（View）是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视
图的查询中使用的表，并且是在使用视图时动态生成的。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 创建</span>
<span class="token keyword">CREATE</span>   <span class="token punctuation">[</span><span class="token operator">OR</span> <span class="token keyword">REPLACE</span><span class="token punctuation">]</span>   <span class="token keyword">VIEW</span>  视图名称<span class="token punctuation">[</span><span class="token punctuation">(</span>列名列表<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token keyword">AS</span>   <span class="token keyword">SELECT</span>语句   <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">[</span> 
<span class="token keyword">CASCADED</span>  <span class="token operator">|</span>  <span class="token keyword">LOCAL</span> <span class="token punctuation">]</span>  <span class="token keyword">CHECK</span>  <span class="token keyword">OPTION</span> <span class="token punctuation">]</span>
<span class="token comment">## 查询</span>
查看创建视图语句：<span class="token keyword">SHOW</span>  <span class="token keyword">CREATE</span>  <span class="token keyword">VIEW</span>  视图名称<span class="token punctuation">;</span>
查看视图数据：<span class="token keyword">SELECT</span>  <span class="token operator">*</span>  <span class="token keyword">FROM</span>   视图名称 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
<span class="token comment">## 修改</span>
方式一：<span class="token keyword">CREATE</span>   <span class="token punctuation">[</span><span class="token operator">OR</span> <span class="token keyword">REPLACE</span><span class="token punctuation">]</span>   <span class="token keyword">VIEW</span>  视图名称<span class="token punctuation">[</span><span class="token punctuation">(</span>列名列表<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token keyword">AS</span>   <span class="token keyword">SELECT</span>语句   <span class="token punctuation">[</span> <span class="token keyword">WITH</span> 
<span class="token punctuation">[</span> <span class="token keyword">CASCADED</span>  <span class="token operator">|</span>  <span class="token keyword">LOCAL</span> <span class="token punctuation">]</span>  <span class="token keyword">CHECK</span>  <span class="token keyword">OPTION</span> <span class="token punctuation">]</span>
方式二：<span class="token keyword">ALTER</span>   <span class="token keyword">VIEW</span>  视图名称<span class="token punctuation">[</span><span class="token punctuation">(</span>列名列表<span class="token punctuation">)</span><span class="token punctuation">]</span>   <span class="token keyword">AS</span>   <span class="token keyword">SELECT</span>语句   <span class="token punctuation">[</span> <span class="token keyword">WITH</span> <span class="token punctuation">[</span> <span class="token keyword">CASCADED</span>  <span class="token operator">|</span>  
<span class="token keyword">LOCAL</span> <span class="token punctuation">]</span>  <span class="token keyword">CHECK</span>  <span class="token keyword">OPTION</span> <span class="token punctuation">]</span>
<span class="token comment">## 删除</span>
<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> 视图名称 <span class="token punctuation">[</span><span class="token punctuation">,</span>视图名称<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>可以通过视图来插入、更新数据</p> <h5 id="检查选项"><a href="#检查选项" class="header-anchor">#</a> 检查选项</h5> <p>当使用WITH CHECK OPTION子句创建视图时，MySQL会通过视图检查正在更改的每个行，例如 插入，更新，删除，以使其符合视图的定义。</p> <p><strong>确定检查范围</strong>：</p> <ol><li>CASCADED 级联
v2视图是基于v1视图的，如果在v2视图创建的时候指定了检查选项为 cascaded，但是v1视图创建时未指定检查选项。 则在执行检查时，不仅会检查v2，还会级联检查v2的关联视图v1。</li> <li>LOCAL 本地
v2视图是基于v1视图的，如果在v2视图创建的时候指定了检查选项为 local ，但是v1视图创建时未指定检查选项。 则在执行检查时，知会检查v2，不会检查v2的关联视图v1。</li></ol> <h5 id="视图的更新"><a href="#视图的更新" class="header-anchor">#</a> 视图的更新</h5> <p>要使视图可更新，视图中的行与基础表中的行之间必须存在一对一的关系。如果视图包含以下任何一项，则该视图不可更新：</p> <p>A. 聚合函数或窗口函数（SUM()、 MIN()、 MAX()、 COUNT()等）
B. DISTINCT
C. GROUP BY
D. HAVING
E. UNION 或者 UNION ALL</p> <h5 id="视图的作用"><a href="#视图的作用" class="header-anchor">#</a> 视图的作用</h5> <p>1). 简单
视图不仅可以简化用户对数据的理解，也可以简化他们的操作。那些被经常使用的查询可以被定义为视
图，从而使得用户不必为以后的操作每次指定全部的条件。
2). 安全
数据库可以授权，但不能授权到数据库特定行和特定的列上。通过视图用户只能查询和修改他们所能见
到的数据
3). 数据独立
视图可帮助用户屏蔽真实表结构变化带来的影响。</p> <h4 id="存储过程"><a href="#存储过程" class="header-anchor">#</a> 存储过程</h4> <p>存储过程是事先经过编译并存储在数据库中的一段 SQL 语句的集合，调用存储过程可以简化应用开发人员的很多工作，减少数据在数据库和应用服务器之间的传输，对于提高数据处理的效率是有好处的。</p> <p>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。</p> <p><img src="/assets/1677114695709.png" alt="1677114695709"></p> <p><strong>特点：</strong></p> <ul><li>封装，复用 -----------------------&gt; 可以把某一业务SQL封装在存储过程中，需要用到的时候直接调用即可。</li> <li>可以接收参数，也可以返回数据 --------&gt; 再存储过程中，可以传递参数，也可以接收返回值。</li> <li>减少网络交互，效率提升 -------------&gt; 如果涉及到多条SQL，每执行一次都是一次网络传输。 而如果封装在存储过程中，我们只需要网络交互一次可能就可以了。</li></ul> <h5 id="基本语法"><a href="#基本语法" class="header-anchor">#</a> 基本语法</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 创建</span>
<span class="token keyword">CREATE</span>  <span class="token keyword">PROCEDURE</span>   存储过程名称 <span class="token punctuation">(</span><span class="token punctuation">[</span> 参数列表 <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token comment">-- SQL语句</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span>
<span class="token comment">## 调用</span>
<span class="token keyword">CALL</span> 名称 <span class="token punctuation">(</span><span class="token punctuation">[</span> 参数 <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">## 查看</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> INFORMATION_SCHEMA<span class="token punctuation">.</span>ROUTINES <span class="token keyword">WHERE</span> ROUTINE_SCHEMA <span class="token operator">=</span> <span class="token string">'xxx'</span><span class="token punctuation">;</span>  <span class="token comment">-- 查询指定数据库的存储过程及状态信息</span>
<span class="token keyword">SHOW</span>  <span class="token keyword">CREATE</span>  <span class="token keyword">PROCEDURE</span>   存储过程名称 <span class="token punctuation">;</span>  <span class="token comment">-- 查询某个存储过程的定义</span>
<span class="token comment">## 删除</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token punctuation">[</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">]</span> 存储过程名称 ；

<span class="token comment">--  在命令行中，执行创建存储过程的SQL时，需要通过关键字 delimiter 指定SQL语句的结束符。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h5> <h6 id="_1、系统变量"><a href="#_1、系统变量" class="header-anchor">#</a> 1、系统变量：</h6> <p>是MySQL服务器提供，不是用户定义的，属于服务器层面。分为全局变量（GLOBAL）、会话
变量（SESSION）。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查看系统变量</span>
<span class="token keyword">SHOW</span>  <span class="token punctuation">[</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span> <span class="token punctuation">]</span>   VARIABLES <span class="token punctuation">;</span>                    <span class="token comment">-- 查看所有系统变量</span>
<span class="token keyword">SHOW</span>  <span class="token punctuation">[</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span> <span class="token punctuation">]</span>   VARIABLES  <span class="token operator">LIKE</span>  <span class="token string">'......'</span><span class="token punctuation">;</span>     <span class="token comment">-- 可以通过LIKE模糊匹配方</span>
式查找变量
<span class="token keyword">SELECT</span>  @@<span class="token punctuation">[</span><span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span><span class="token punctuation">]</span>  系统变量名<span class="token punctuation">;</span>                    <span class="token comment">--  查看指定变量的值</span>
<span class="token comment">## 设置系统变量</span>
<span class="token keyword">SET</span>  <span class="token punctuation">[</span> <span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span> <span class="token punctuation">]</span>   系统变量名 <span class="token operator">=</span> 值 <span class="token punctuation">;</span> 
<span class="token keyword">SET</span>  @@<span class="token punctuation">[</span><span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span><span class="token punctuation">]</span>系统变量名 <span class="token operator">=</span> 值 <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>**注意：**如果没有指定SESSION/GLOBAL，默认是SESSION，会话变量。</p> <p>（mysql服务重新启动之后，所设置的全局参数会失效，要想不失效，可以在 /etc/my.cnf 中配置。）</p> <p>A. 全局变量(GLOBAL): 全局变量针对于所有的会话。
B. 会话变量(SESSION): 会话变量针对于单个会话，在另外一个会话窗口就不生效了。</p> <h6 id="_2、用户定义变量"><a href="#_2、用户定义变量" class="header-anchor">#</a> 2、用户定义变量：</h6> <p>用户定义变量 是用户根据需要自己定义的变量，用户变量不用提前声明，在用的时候直接用 &quot;@变量名&quot; 使用就可以。其作用域为当前连接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 赋值</span>
方式一：赋值时，可以使用 <span class="token operator">=</span> ，也可以使用 :<span class="token operator">=</span> 。
<span class="token keyword">SET</span>   <span class="token variable">@var_name</span> <span class="token operator">=</span> expr  <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token variable">@var_name</span> <span class="token operator">=</span> expr<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span> 
<span class="token keyword">SET</span>   <span class="token variable">@var_name</span> :<span class="token operator">=</span> expr  <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token variable">@var_name</span> :<span class="token operator">=</span> expr<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span> 
方式二：
<span class="token keyword">SELECT</span>   <span class="token variable">@var_name</span> :<span class="token operator">=</span> expr  <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token variable">@var_name</span> :<span class="token operator">=</span> expr<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span> 
<span class="token keyword">SELECT</span>  字段名  <span class="token keyword">INTO</span> <span class="token variable">@var_name</span>  <span class="token keyword">FROM</span>  表名<span class="token punctuation">;</span>
<span class="token comment">## 使用</span>
<span class="token keyword">SELECT</span> <span class="token variable">@var_name</span> <span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>注意:</strong> 用户定义的变量无需对其进行声明或初始化，只不过获取到的值为NULL。</p> <h6 id="_3、局部变量"><a href="#_3、局部变量" class="header-anchor">#</a> 3、局部变量：</h6> <p>局部变量 是根据需要定义的在局部生效的变量，访问之前，需要DECLARE声明。可用作存储过程内的局部变量和输入参数，局部变量的范围是在其内声明的BEGIN ... END块。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 声明</span>
<span class="token keyword">DECLARE</span> 变量名 变量类型 <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token comment">-- 变量类型就是数据库字段类型：INT、BIGINT、CHAR、VARCHAR、DATE、TIME等。</span>
<span class="token comment">## 赋值</span>
<span class="token keyword">SET</span>  变量名 <span class="token operator">=</span> 值 <span class="token punctuation">;</span>
<span class="token keyword">SET</span>  变量名 :<span class="token operator">=</span> 值 <span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  字段名  <span class="token keyword">INTO</span>  变量名  <span class="token keyword">FROM</span>  表名 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="if"><a href="#if" class="header-anchor">#</a> if</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">IF</span>  条件<span class="token number">1</span>  <span class="token keyword">THEN</span> 
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">ELSEIF</span>  条件<span class="token number">2</span>  <span class="token keyword">THEN</span>       <span class="token comment">-- 可选</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">ELSE</span>                     <span class="token comment">-- 可选</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">END</span>  <span class="token keyword">IF</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h5> <p><img src="/assets/1677116372963.png" alt="1677116372963"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>  <span class="token keyword">PROCEDURE</span>   存储过程名称 <span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token operator">IN</span><span class="token operator">/</span><span class="token keyword">OUT</span><span class="token operator">/</span><span class="token keyword">INOUT</span>  参数名  参数类型 <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token comment">-- SQL语句</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">procedure</span> p4<span class="token punctuation">(</span><span class="token operator">in</span> score <span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">out</span> result <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">85</span> <span class="token keyword">then</span>
        <span class="token keyword">set</span> result :<span class="token operator">=</span> <span class="token string">'优秀'</span><span class="token punctuation">;</span>
    <span class="token keyword">elseif</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token keyword">then</span>
        <span class="token keyword">set</span> result :<span class="token operator">=</span> <span class="token string">'及格'</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">set</span> result :<span class="token operator">=</span> <span class="token string">'不及格'</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token comment">-- 定义用户变量 @result来接收返回的数据, 用户变量可以不用声明</span>
<span class="token keyword">call</span> p4<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token variable">@result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@result</span><span class="token punctuation">;</span>

<span class="token comment">-- inout和out参数需要用@变量名，in不用</span>
p5<span class="token punctuation">(</span><span class="token keyword">inout</span> score <span class="token keyword">double</span><span class="token punctuation">)</span>
<span class="token keyword">set</span> <span class="token variable">@score</span> <span class="token operator">=</span> <span class="token number">198</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> p5<span class="token punctuation">(</span><span class="token variable">@score</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h5 id="case"><a href="#case" class="header-anchor">#</a> case</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 含义： 当case_value的值为 when_value1时，执行statement_list1，当值为 when_value2时，</span>
执行statement_list2， 否则就执行 statement_list
<span class="token keyword">CASE</span>  case_value
    <span class="token keyword">WHEN</span>  when_value1  <span class="token keyword">THEN</span>  statement_list1
   <span class="token punctuation">[</span> <span class="token keyword">WHEN</span>  when_value2  <span class="token keyword">THEN</span>  statement_list2<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   <span class="token punctuation">[</span> <span class="token keyword">ELSE</span>  statement_list <span class="token punctuation">]</span>
<span class="token keyword">END</span>  <span class="token keyword">CASE</span><span class="token punctuation">;</span>

<span class="token comment">-- 含义： 当条件search_condition1成立时，执行statement_list1，当条件search_condition2成</span>
立时，执行statement_list2， 否则就执行 statement_list
<span class="token keyword">CASE</span>
  <span class="token keyword">WHEN</span>  search_condition1  <span class="token keyword">THEN</span>  statement_list1
  <span class="token punctuation">[</span><span class="token keyword">WHEN</span>  search_condition2  <span class="token keyword">THEN</span>  statement_list2<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token punctuation">[</span><span class="token keyword">ELSE</span>  statement_list<span class="token punctuation">]</span>
<span class="token keyword">END</span> <span class="token keyword">CASE</span><span class="token punctuation">;</span>
<span class="token comment">## 如果判定条件有多个，多个条件之间，可以使用 and 或 or 进行连接。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h5 id="while"><a href="#while" class="header-anchor">#</a> while</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 先判定条件，如果条件为true，则执行逻辑，否则，不执行逻辑</span>
<span class="token keyword">WHILE</span>  条件  <span class="token keyword">DO</span>
    <span class="token keyword">SQL</span>逻辑<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    
<span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span>


<span class="token comment">## 案例</span>
<span class="token comment">-- A. 定义局部变量, 记录累加之后的值;</span>
<span class="token comment">-- B. 每循环一次, 就会对n进行减1 , 如果n减到0, 则退出循环</span>
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p7<span class="token punctuation">(</span><span class="token operator">in</span> n <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> total <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span> n<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">do</span>
    	<span class="token keyword">set</span> total :<span class="token operator">=</span> total <span class="token operator">+</span> n<span class="token punctuation">;</span>
         <span class="token keyword">set</span> n :<span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
    
    <span class="token keyword">select</span> total<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">call</span> p7<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h5 id="repeat"><a href="#repeat" class="header-anchor">#</a> repeat</h5> <p>repeat是有条件的循环控制语句, 当满足until声明的条件的时候，则退出循环 。具体语法为：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 先执行一次逻辑，然后判定UNTIL条件是否满足，如果满足，则退出。如果不满足，则继续下一次循环</span>
<span class="token keyword">REPEAT</span>
    <span class="token keyword">SQL</span>逻辑<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
    UNTIL  条件
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>

<span class="token comment">## 案例</span>
<span class="token comment">-- A. 定义局部变量, 记录累加之后的值;</span>
<span class="token comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环</span>
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p8<span class="token punctuation">(</span><span class="token operator">in</span> n <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> total <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">repeat</span>
        <span class="token keyword">set</span> total :<span class="token operator">=</span> total <span class="token operator">+</span> n<span class="token punctuation">;</span>
        <span class="token keyword">set</span> n :<span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    until  n <span class="token operator">&lt;=</span> <span class="token number">0</span>
    <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>

    <span class="token keyword">select</span> total<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">call</span> p8<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> p8<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h5 id="loop"><a href="#loop" class="header-anchor">#</a> loop</h5> <p>LOOP 实现简单的循环，如果不在SQL逻辑中增加退出循环的条件，可以用其来实现简单的死循环
LOOP可以配合一下两个语句使用：</p> <ul><li>LEAVE ：配合循环使用，退出循环。</li> <li>ITERATE：必须用在循环中，作用是跳过当前循环剩下的语句，直接进入下一次循环。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token punctuation">[</span>begin_label:<span class="token punctuation">]</span>  <span class="token keyword">LOOP</span>
    <span class="token keyword">SQL</span>逻辑<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
<span class="token keyword">END</span>  <span class="token keyword">LOOP</span>  <span class="token punctuation">[</span>end_label<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">LEAVE</span>  label<span class="token punctuation">;</span>   <span class="token comment">-- 退出指定标记的循环体</span>
<span class="token keyword">ITERATE</span>  label<span class="token punctuation">;</span> <span class="token comment">-- 直接进入下一次循环</span>
<span class="token comment">-- egin_label，end_label，label 指的都是我们所自定义的标记。</span>

<span class="token comment">-- A. 定义局部变量, 记录累加之后的值;</span>
<span class="token comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环 ----&gt; leave xx</span>
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p9<span class="token punctuation">(</span><span class="token operator">in</span> n <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> total <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>

    sum:<span class="token keyword">loop</span>
        <span class="token keyword">if</span> n<span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token keyword">then</span>
            <span class="token keyword">leave</span> sum<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
        
        <span class="token keyword">set</span> total :<span class="token operator">=</span> total <span class="token operator">+</span> n<span class="token punctuation">;</span>
        <span class="token keyword">set</span> n :<span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">loop</span> sum<span class="token punctuation">;</span>

    <span class="token keyword">select</span> total<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> p9<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">## 案例</span>
<span class="token comment">-- A. 定义局部变量, 记录累加之后的值;</span>
<span class="token comment">-- B. 每循环一次, 就会对n进行-1 , 如果n减到0, 则退出循环 ----&gt; leave xx</span>
<span class="token comment">-- C. 如果当次累加的数据是奇数, 则直接进入下一次循环. --------&gt; iterate xx</span>
<span class="token keyword">create</span> <span class="token keyword">procedure</span> p10<span class="token punctuation">(</span><span class="token operator">in</span> n <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> total <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>

    sum:<span class="token keyword">loop</span>
        <span class="token keyword">if</span> n<span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token keyword">then</span>
            <span class="token keyword">leave</span> sum<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> n<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span>
            <span class="token keyword">set</span> n :<span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">iterate</span> sum<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>

        <span class="token keyword">set</span> total :<span class="token operator">=</span> total <span class="token operator">+</span> n<span class="token punctuation">;</span>
        <span class="token keyword">set</span> n :<span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">loop</span> sum<span class="token punctuation">;</span>
    <span class="token keyword">select</span> total<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">call</span> p10<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h5 id="游标"><a href="#游标" class="header-anchor">#</a> 游标</h5> <p>游标（CURSOR）是用来存储查询结果集的数据类型 , 在存储过程和函数中可以使用游标对结果集进行循环的处理。游标的使用包括游标的声明、OPEN、FETCH 和 CLOSE，其语法分别如下。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 声明</span>
<span class="token keyword">DECLARE</span> 游标名称 <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> 查询语句 <span class="token punctuation">;</span>
<span class="token comment">## 打开游标</span>
<span class="token keyword">OPEN</span> 游标名称 <span class="token punctuation">;</span>
<span class="token comment">## 获取游标记录</span>
<span class="token keyword">FETCH</span> 游标名称 <span class="token keyword">INTO</span> 变量 <span class="token punctuation">[</span><span class="token punctuation">,</span> 变量 <span class="token punctuation">]</span> <span class="token punctuation">;</span>
<span class="token comment">## 关闭游标</span>
<span class="token keyword">CLOSE</span> 游标名称 <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 案例</span>
根据传入的参数uage，来查询用户表tb_user中，所有的用户年龄小于等于uage的用户姓名
（name）和专业（profession），并将用户的姓名和专业插入到所创建的一张新表
<span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>profession<span class="token punctuation">)</span>中。
<span class="token comment">-- 逻辑:</span>
<span class="token comment">-- A. 声明游标, 存储查询结果集</span>
<span class="token comment">-- B. 准备: 创建表结构</span>
<span class="token comment">-- C. 开启游标</span>
<span class="token comment">-- D. 获取游标中的记录</span>
<span class="token comment">-- E. 插入数据到新表中</span>
<span class="token comment">-- F. 关闭游标</span>

reate <span class="token keyword">procedure</span>  p11<span class="token punctuation">(</span><span class="token operator">in</span> uage <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> uname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> upro <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> u_cursor <span class="token keyword">cursor</span> <span class="token keyword">for</span> <span class="token keyword">select</span> name<span class="token punctuation">,</span>profession <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> age<span class="token operator">&lt;=</span>uage<span class="token punctuation">;</span>

    <span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> tb_user_pro<span class="token punctuation">;</span>
    <span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> tb_user_pro<span class="token punctuation">(</span>
        id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
        name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        profession <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">open</span> u_cursor<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token boolean">true</span> <span class="token keyword">do</span>
        <span class="token keyword">fetch</span> u_cursor <span class="token keyword">into</span> uname<span class="token punctuation">,</span>upro<span class="token punctuation">;</span>
        <span class="token keyword">insert</span> <span class="token keyword">into</span> tb_user_pro <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span>uname<span class="token punctuation">,</span>upro<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
    <span class="token keyword">close</span> u_cursor<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> p11<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#上述的存储过程，最终我们在调用的过程中，会报错，之所以报错是因为上面的while循环中，并没有退出条件。当游标的数据集获取完毕之后，再次获取数据，就会报错，从而终止了程序的执行。</span>
<span class="token comment">-- 声明条件处理程序 ： 当SQL语句执行抛出的状态码为02000时，将关闭游标u_cursor，并退出</span>
    <span class="token keyword">declare</span> <span class="token keyword">exit</span> <span class="token keyword">handler</span> <span class="token keyword">for</span> SQLSTATE <span class="token string">'02000'</span> <span class="token keyword">close</span> u_cursor<span class="token punctuation">;</span>
    <span class="token comment">## 加入条件处理语句可以解决这一问题</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h5 id="条件处理程序"><a href="#条件处理程序" class="header-anchor">#</a> 条件处理程序</h5> <p>条件处理程序（Handler）可以用来定义在流程控制结构执行过程中遇到问题时相应的处理步骤。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span>   handler_action   <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span>    condition_value  <span class="token punctuation">[</span><span class="token punctuation">,</span> condition_value<span class="token punctuation">]</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   statement <span class="token punctuation">;</span>

handler_action 的取值： 
    <span class="token keyword">CONTINUE</span>: 继续执行当前程序
    <span class="token keyword">EXIT</span>: 终止执行当前程序
    
condition_value 的取值： 
    SQLSTATE  sqlstate_value: 状态码，如 <span class="token number">02000</span>
    
    SQLWARNING: 所有以<span class="token number">01</span>开头的SQLSTATE代码的简写
    <span class="token operator">NOT</span> FOUND: 所有以<span class="token number">02</span>开头的SQLSTATE代码的简写
    SQLEXCEPTION: 所有没有被SQLWARNING 或 <span class="token operator">NOT</span> FOUND捕获的SQLSTATE代码的简写
    
<span class="token keyword">declare</span> <span class="token keyword">exit</span> <span class="token keyword">handler</span> <span class="token keyword">for</span> SQLSTATE <span class="token string">'02000'</span> <span class="token keyword">close</span> u_cursor<span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">exit</span> <span class="token keyword">handler</span> <span class="token keyword">for</span> <span class="token operator">not</span> found <span class="token keyword">close</span> u_cursor<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h5 id="存储函数"><a href="#存储函数" class="header-anchor">#</a> 存储函数</h5> <p>存储函数是有返回值的存储过程，存储函数的参数只能是IN类型的。具体语法如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>  <span class="token keyword">FUNCTION</span>   存储函数名称 <span class="token punctuation">(</span><span class="token punctuation">[</span> 参数列表 <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span>  <span class="token keyword">type</span>  <span class="token punctuation">[</span>characteristic <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token keyword">BEGIN</span>
    <span class="token comment">-- SQL语句</span>
    <span class="token keyword">RETURN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span>

characteristic说明：
<span class="token keyword">DETERMINISTIC</span>：相同的输入参数总是产生相同的结果
<span class="token keyword">NO</span> <span class="token keyword">SQL</span> ：不包含 <span class="token keyword">SQL</span> 语句。
<span class="token keyword">READS</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span>：包含读取数据的语句，但不包含写入数据的语句。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="触发器"><a href="#触发器" class="header-anchor">#</a> 触发器</h4> <p>触发器是与表有关的数据库对象，指在insert/update/delete之前(BEFORE)或之后(AFTER)，触发并执行触发器中定义的SQL语句集合。触发器的这种特性可以协助应用在数据库端确保数据的完整性 , 日志记录 , 数据校验等操作 。</p> <p>使用别名OLD和NEW来引用触发器中发生变化的记录内容，这与其他的数据库是相似的。现在触发器还
只支持行级触发，不支持语句级触发。</p> <p><img src="/assets/1677119527281.png" alt="1677119527281"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 创建</span>
<span class="token keyword">CREATE</span>  <span class="token keyword">TRIGGER</span>  trigger_name 
BEFORE<span class="token operator">/</span><span class="token keyword">AFTER</span>  <span class="token keyword">INSERT</span><span class="token operator">/</span><span class="token keyword">UPDATE</span><span class="token operator">/</span><span class="token keyword">DELETE</span>
<span class="token keyword">ON</span> tbl_name   <span class="token keyword">FOR EACH ROW</span>  <span class="token comment">-- 行级触发器</span>
<span class="token keyword">BEGIN</span>
    trigger_stmt <span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>
<span class="token comment">## 查看</span>
<span class="token keyword">SHOW</span> TRIGGERS <span class="token punctuation">;</span>
<span class="token comment">## 删除</span>
<span class="token keyword">DROP</span>  <span class="token keyword">TRIGGER</span>  <span class="token punctuation">[</span>schema_name<span class="token punctuation">.</span><span class="token punctuation">]</span>trigger_name <span class="token punctuation">;</span>  <span class="token comment">-- 如果没有指定schema_name，默认为当前数据库 。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="锁"><a href="#锁" class="header-anchor">#</a> 锁</h3> <p>锁是计算机协调多个进程或线程并发访问某一资源的机制。</p> <p>在数据库中，除传统的计算资源（CPU、RAM、I/O）的争用以外，数据也是一种供许多用户共享的资源。如何保证数据并发访问的一致性、有效性是所有数据库必须解决的一个问题，锁冲突也是影响数据库并发访问性能的一个重要因素。</p> <h4 id="全局锁"><a href="#全局锁" class="header-anchor">#</a> 全局锁</h4> <p>全局锁就是对整个数据库实例加锁，加锁后整个实例就处于只读状态，后续的DML的写语句，DDL语
句，已经更新操作的事务提交语句都将被阻塞。（典型的使用场景是做全库的逻辑备份，对所有的表进行锁定，从而获取一致性视图，保证数据的完整性。）</p> <p><img src="/assets/1677120767307.png" alt="1677120767307"></p> <p>对数据库进行进行逻辑备份之前，先对整个数据库加上全局锁，一旦加了全局锁之后，其他的DDL、DML全部都处于阻塞状态，但是可以执行DQL语句，也就是处于只读状态，而数据备份就是查询操作。那么数据在进行逻辑备份的过程中，数据库中的数据就是不会发生变化的，这样就保证了数据的一致性和完整性。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 加全局锁</span>
flush <span class="token keyword">tables</span> <span class="token keyword">with</span> <span class="token keyword">read</span> <span class="token keyword">lock</span> <span class="token punctuation">;</span>
<span class="token comment">## 数据备份</span>
mysqldump <span class="token operator">-</span>uroot –p1234 itcast <span class="token operator">&gt;</span> itcast<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token comment">-- 数据备份的相关指令</span>
<span class="token comment">## 释放锁</span>
<span class="token keyword">unlock</span> <span class="token keyword">tables</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>数据库中加全局锁，是一个比较重的操作，存在以下问题：</p> <ul><li>如果在主库上备份，那么在备份期间都不能执行更新，业务基本上就得停摆。</li> <li>如果在从库上备份，那么在备份期间从库不能执行主库同步过来的二进制日志（binlog），会导
致主从延迟。</li></ul> <p>在InnoDB引擎中，我们可以在备份时加上参数 --single-transaction 参数来完成不加锁的一致
性数据备份。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysqldump --single-transaction -uroot –p123456 itcast &gt; itcast.sql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="表级锁"><a href="#表级锁" class="header-anchor">#</a> 表级锁</h4> <p>表级锁，每次操作锁住整张表。锁定粒度大，发生锁冲突的概率最高，并发度最低。应用在MyISAM、InnoDB、BDB等存储引擎中。</p> <p>三类：表锁、元数据锁（meta data lock，MDL）、意向锁</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 加锁：</span>
<span class="token keyword">lock</span> <span class="token keyword">tables</span> 表名<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">read</span><span class="token operator">/</span><span class="token keyword">write</span>。
<span class="token comment">## 释放锁：</span>
<span class="token keyword">unlock</span> <span class="token keyword">tables</span> <span class="token operator">/</span> 客户端断开连接 。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="表锁"><a href="#表锁" class="header-anchor">#</a> 表锁</h5> <p>表共享读锁（read lock）、表独占写锁（write lock）</p> <p><strong>读锁</strong></p> <p><img src="/assets/1677121207625.png" alt="1677121207625"></p> <p><strong>写锁</strong></p> <p><img src="/assets/1677121236360.png" alt="1677121236360"></p> <p>结论: 读锁不会阻塞其他客户端的读，但是会阻塞写。写锁既会阻塞其他客户端的读，又会阻塞其他客户端的写。</p> <h5 id="元数据锁"><a href="#元数据锁" class="header-anchor">#</a> 元数据锁</h5> <p>（meta data lock，MDL）</p> <p>MDL加锁过程是系统自动控制，无需显式使用，在访问一张表的时候会自动加上。MDL锁主要作用是维护表元数据的数据一致性，==在表上有活动事务的时候，不可以对元数据进行写入操作==。为了避免DML与DDL冲突，保证读写的正确性。</p> <ul><li>某一张表涉及到未提交的事务时，是不能够修改这张表的表结构的。</li> <li>当对一张表进行增删改查的时候，加MDL读锁(共享)；当对表结构进行变更操作的时候，加MDL写锁(排他)。</li></ul> <p><img src="/assets/1677121533599.png" alt="1677121533599"></p> <p>当执行SELECT、INSERT、UPDATE、DELETE等语句时，添加的是元数据共享锁（SHARED_READ / SHARED_WRITE），之间是兼容的。</p> <p><img src="/assets/1677121671552.png" alt="1677121671552"></p> <p>左边select语句，添加的是元数据共享锁（SHARED_READ）会阻塞元数据排他锁
（EXCLUSIVE），之间是互斥的。</p> <p>右边对表结构进行变更操作的时候，加MDL写锁，元数据排他锁（阻塞）。</p> <p><img src="/assets/1677121710865.png" alt="1677121710865"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查询</span>
<span class="token keyword">select</span> object_type<span class="token punctuation">,</span>object_schema<span class="token punctuation">,</span>object_name<span class="token punctuation">,</span>lock_type<span class="token punctuation">,</span>lock_duration <span class="token keyword">from</span> 
performance_schema<span class="token punctuation">.</span>metadata_locks <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="意向锁"><a href="#意向锁" class="header-anchor">#</a> 意向锁</h5> <p>为了避免DML在执行时，加的行锁与表锁的冲突，在InnoDB中引入了意向锁，使得表锁不用检查每行数据是否加锁，使用意向锁来减少表锁的检查。</p> <ol><li>客户端一，在执行DML操作时，会对涉及的行加行锁，同时也会对该表加上意向锁。</li> <li>而其他客户端，在对这张表加表锁的时候不用逐行判断行锁情况了。</li></ol> <p><strong>分类</strong></p> <ul><li>意向共享锁(IS): 由语句select ... lock in share mode添加 。 与表锁共享锁(read)兼容，与表锁排他锁(write)互斥。</li> <li>意向排他锁(IX): 由insert、update、delete、select...for update添加 。与表锁共享锁(read)及排他锁(write)都互斥，意向锁之间不会互斥。</li></ul> <blockquote><p>一旦事务提交了，意向共享锁、意向排他锁，都会自动释放。</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查询</span>
<span class="token keyword">select</span> object_schema<span class="token punctuation">,</span>object_name<span class="token punctuation">,</span>index_name<span class="token punctuation">,</span>lock_type<span class="token punctuation">,</span>lock_mode<span class="token punctuation">,</span>lock_data <span class="token keyword">from</span> performance_schema<span class="token punctuation">.</span>data_locks<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="行级锁"><a href="#行级锁" class="header-anchor">#</a> <strong>行级锁</strong></h4> <p>行级锁，每次操作锁住对应的行数据。锁定粒度最小，发生锁冲突的概率最低，并发度最高。应用在InnoDB存储引擎中。</p> <p>InnoDB的数据是基于索引组织的，行锁是通过对索引上的索引项加锁来实现的，而不是对记录加的锁。</p> <p><strong>三类</strong></p> <p><img src="/assets/1677123445838.png" alt="1677123445838"></p> <h5 id="行锁"><a href="#行锁" class="header-anchor">#</a> 行锁</h5> <p>InnoDB实现了以下两种类型的行锁：
共享锁（S）：允许一个事务去读一行，阻止其他事务获得相同数据集的排它锁。
排他锁（X）：允许获取排他锁的事务更新数据，阻止其他事务获得相同数据集的共享锁和排他锁。</p> <p><img src="/assets/1677123804035.png" alt="1677123804035"></p> <p>常见的SQL语句，在执行时，所加的行锁如下：</p> <p><img src="/assets/1677123841373.png" alt="1677123841373"></p> <p>默认情况下，InnoDB在 REPEATABLE READ事务隔离级别运行，InnoDB使用 next-key 锁进行搜索和索引扫描，以防止幻读。
针对唯一索引进行检索时，对已存在的记录进行等值匹配时，将会自动优化为行锁。InnoDB的行锁是针对于索引加的锁，不通过索引条件检索数据，那么InnoDB将对表中的所有记录加锁，此时就会升级为表锁。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查询</span>
<span class="token keyword">select</span> object_schema<span class="token punctuation">,</span>object_name<span class="token punctuation">,</span>index_name<span class="token punctuation">,</span>lock_type<span class="token punctuation">,</span>lock_mode<span class="token punctuation">,</span>lock_data <span class="token keyword">from</span> 
performance_schema<span class="token punctuation">.</span>data_locks<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>A. select...lock in share mode，加共享锁，共享锁与共享锁之间兼容。</p> <p><img src="/assets/1677124319216.png" alt="1677124319216"></p> <p>共享锁与排他锁之间互斥。</p> <p><img src="/assets/1677124332370.png" alt="1677124332370"></p> <p>客户端一获取的是id为1这行的共享锁，客户端二是可以获取id为3这行的排它锁的，因为不是同一行
数据。 而如果客户端二想获取id为1这行的排他锁，会处于阻塞状态，以为共享锁与排他锁之间互
斥。</p> <p>B. 排它锁与排他锁之间互斥</p> <p><img src="/assets/1677124465209.png" alt="1677124465209"></p> <p>当客户端一，执行update语句，会为id为1的记录加排他锁； 客户端二，如果也执行update语句更新id为1的数据，也要为id为1的数据加排他锁，但是客户端二会处于阻塞状态，因为排他锁之间是互斥的。 直到客户端一，把事务提交了，才会把这一行的行锁释放，此时客户端二，解除阻塞。</p> <p>C. 无索引行锁升级为表锁</p> <p><img src="/assets/1677134856216.png" alt="1677134856216"></p> <p>在客户端一中，开启事务，并执行update语句，更新name为Lily的数据，也就是id为19的记录 。 然后在客户端二中更新id为3的记录，却不能直接执行，会处于阻塞状态，为什么呢？
原因就是因为此时，客户端一，根据name字段进行更新时，name字段是没有索引的，如果没有索引，此时行锁会升级为表锁(因为行锁是对索引项加的锁，而name没有索引)。</p> <p>再针对name字段建立索引，索引建立之后，再次做一个测试：
此时我们可以看到，客户端一，开启事务，然后依然是根据name进行更新。而客户端二，在更新id为3
的数据时，更新成功，并未进入阻塞状态。 这样就说明，我们根据索引字段进行更新操作，就可以避
免行锁升级为表锁的情况。</p> <h5 id="间隙锁-临键锁"><a href="#间隙锁-临键锁" class="header-anchor">#</a> 间隙锁&amp;临键锁</h5> <p>默认情况下，InnoDB在 REPEATABLE READ事务隔离级别运行，InnoDB使用 next-key 锁进行搜索和索引扫描，以防止幻读。</p> <ul><li>索引上的等值查询(唯一索引)，给不存在的记录加锁时, 优化为间隙锁 。</li> <li>索引上的等值查询(非唯一普通索引)，向右遍历时最后一个值不满足查询需求时，next-key lock 退化为间隙锁。</li> <li>索引上的范围查询(唯一索引)--会访问到不满足条件的第一个值为止。</li></ul> <blockquote><p>注意：间隙锁唯一目的是防止其他事务插入间隙。==间隙锁可以共存，一个事务采用的间隙锁不会阻止另一个事务在同一间隙上采用间隙锁。==</p></blockquote> <p>A. 索引上的等值查询(唯一索引)，给不存在的记录加锁时, 优化为间隙锁 。</p> <p><img src="/assets/1677136002353.png" alt="1677136002353"></p> <p>B. 索引上的等值查询(非唯一普通索引)，向右遍历时最后一个值不满足查询需求时，next-key lock 退化为间隙锁。</p> <p>我们知道InnoDB的B+树索引，叶子节点是有序的双向链表。 假如，我们要根据这个二级索引查询值为18的数据，并加上共享锁，我们是只锁定18这一行就可以了吗？ 并不是，因为是非唯一索引，这个结构中可能有多个18的存在，所以，在加锁时会继续往后找，找到一个不满足条件的值（当前案例中也就是29）。此时会对18加临键锁，并对29之前的间隙加锁。</p> <p><img src="/assets/1677136379077.png" alt="1677136379077"></p> <p><img src="/assets/1677136574612.png" alt="1677136574612"></p> <p>C. 索引上的范围查询(唯一索引)--会访问到不满足条件的第一个值为止。</p> <p><img src="/assets/1677137015482.png" alt="1677137015482"></p> <p>查询的条件为id&gt;=19，并添加共享锁。 此时我们可以根据数据库表中现有的数据，将数据分为三个部分：
[19]
(19,25]
(25,+∞]
所以数据库数据在加锁是，就是将19加了行锁，25的临键锁（包含25及25之前的间隙），正无穷的临
键锁(正无穷及之前的间隙)。</p> <h3 id="innodb引擎"><a href="#innodb引擎" class="header-anchor">#</a> InnoDB引擎</h3> <h4 id="逻辑存储结构"><a href="#逻辑存储结构" class="header-anchor">#</a> 逻辑存储结构</h4> <p><img src="/assets/1677137118884.png" alt="1677137118884"></p> <ul><li>**表空间：**表空间是InnoDB存储引擎逻辑结构的最高层， 如果用户启用了参数 innodb_file_per_table(在8.0版本中默认开启) ，则==每张表都会有一个表空间（xxx.ibd）==，一个mysql实例可以对应多个表空间，用于存储记录、索引等数据。</li> <li>**段：**分为数据段（Leaf node segment）、索引段（Non-leaf node segment）、回滚段（Rollback segment），InnoDB是索引组织表，数据段就是B+树的叶子节点， 索引段即为B+树的非叶子节点。段用来管理多个Extent（区）。</li> <li>**区：**表空间的单元结构，每个区的大小为1M。 默认情况下， InnoDB存储引擎页大小为16K， 即一个区中一共有64个连续的页。</li> <li>**页：**是InnoDB 存储引擎磁盘管理的最小单元，每个页的大小默认为 16KB。为了保证页的连续性，InnoDB 存储引擎每次从磁盘申请 4-5 个区。</li> <li>**行：**InnoDB 存储引擎数据是按行进行存放的。
在行中，默认有两个隐藏字段：
Trx_id：每次对某条记录进行改动时，都会把对应的事务id赋值给trx_id隐藏列。
Roll_pointer：每次对某条引记录进行改动时，都会把旧的版本写入到undo日志中，然后这个隐藏列就相当于一个指针，可以通过它来找到该记录修改前的信息。</li></ul> <h4 id="架构"><a href="#架构" class="header-anchor">#</a> 架构</h4> <p><img src="/assets/1677137489564.png" alt="1677137489564"></p> <h5 id="内存结构"><a href="#内存结构" class="header-anchor">#</a> 内存结构</h5> <p><img src="/assets/1677137523653.png" alt="1677137523653"></p> <p>1、Buffer Pool</p> <p>InnoDB存储引擎基于磁盘文件存储，访问物理硬盘和在内存中进行访问，速度相差很大，为了尽可能弥补这两者之间的I/O效率的差值，就需要==把经常使用的数据加载到缓冲池中，避免每次访问都进行磁盘I/O==。</p> <p>缓冲池 Buffer Pool，是主内存中的一个区域，里面可以缓存磁盘上经常操作的真实数据，在执行增删改查操作时，先操作缓冲池中的数据（若缓冲池没有数据，则从磁盘加载并缓存），然后再以一定频率刷新到磁盘，从而减少磁盘IO，加快处理速度。</p> <p>缓冲池以Page页为单位，底层采用链表数据结构管理Page。根据状态，将Page分为三种类型：
• free page：空闲page，未被使用。
• clean page：被使用page，数据没有被修改过。
• dirty page：脏页，被使用page，数据被修改过，也中数据与磁盘的数据产生了不一致。</p> <p>2、Change Buffer</p> <p>更改缓冲区（针对于非唯一二级索引页），在执行DML语句时，如果这些数据Page没有在Buffer Pool中，不会直接操作磁盘，而会将数据变更存在更改缓冲区 Change Buffer 中，在未来数据被读取时，再将数据合并恢复到Buffer Pool中，再将合并后的数据刷新到磁盘中。</p> <p>比如：与聚集索引不同，二级索引通常是非唯一的，并且以相对随机的顺序插入二级索引。同样，删除和更新可能会影响索引树中不相邻的二级索引页，如果每一次都操作磁盘，会造成大量的磁盘IO。有了ChangeBuffer之后，我们可以在缓冲池中进行合并处理，减少磁盘IO。</p> <p>3、Adaptive Hash Index</p> <p>自适应hash索引，用于优化对Buffer Pool数据的查询。MySQL的innoDB引擎中虽然没有直接支持hash索引，但是给我们提供了一个功能就是这个自适应hash索引。因为前面我们讲到过，hash索引在进行等值匹配时，一般性能是要高于B+树的，因为hash索引一般只需要一次IO即可，而B+树，可能需要几次匹配，所以hash索引的效率要高，但是hash索引又不适合做范围查询、模糊匹配等。</p> <p>InnoDB存储引擎会监控对表上各索引页的查询，如果观察到在特定的条件下hash索引可以提升速度，则建立hash索引，称之为自适应hash索引。</p> <p><strong>自适应哈希索引，无需人工干预，是系统根据情况自动完成。</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>参数：adaptive_hash_index
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4、Log Buffer</p> <p>日志缓冲区，用来保存要写入到磁盘中的log日志数据（redo log 、undo log），默认大小为 16MB，日志缓冲区的日志会定期刷新到磁盘中。如果需要更新、插入或删除许多行的事务，增加日志缓冲区的大小可以节省磁盘 I/O。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>参数：
innodb_log_buffer_size：缓冲区大小
innodb_flush_log_at_trx_commit：日志刷新到磁盘时机，取值主要包含以下三个：
 1: 日志在每次事务提交时写入并刷新到磁盘，默认值。
 0: 每秒将日志写入并刷新到磁盘一次。
 2: 日志在每次事务提交后写入，并每秒刷新到磁盘一次。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="磁盘结构"><a href="#磁盘结构" class="header-anchor">#</a> 磁盘结构</h5> <p><img src="/assets/1677138413774.png" alt="1677138413774"></p> <p>1、System Tablespace</p> <p>系统表空间是更改缓冲区的存储区域。如果表是在系统表空间而不是每个表文件或通用表空间中创建的，它也可能包含表和索引数据。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>参数：innodb_data_file_path 
系统表空间，默认的文件名叫 ibdata1。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、File-Per-Table Tablespaces</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>如果开启了innodb_file_per_table开关 ，则每个表的文件表空间包含单个InnoDB表的数据和索引 ，并存储在文件系统上的单个数据文件中。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、General Tablespaces</p> <p>通用表空间，需要通过 CREATE TABLESPACE 语法创建通用表空间，在创建表时，可以指定该表空间。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 创建表空间</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLESPACE</span> ts_name <span class="token keyword">ADD</span> DATAFILE <span class="token string">'file_name'</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> engine_name<span class="token punctuation">;</span>
<span class="token comment">## 创建表时指定表空间</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> xxx <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">TABLESPACE</span> ts_name<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>4、Undo Tablespaces</p> <p>撤销表空间，MySQL实例在初始化时会自动创建两个默认的undo表空间（初始大小16M），用于存储
undo log日志。</p> <p>5、Temporary Tablespaces</p> <p>InnoDB 使用会话临时表空间和全局临时表空间。存储用户创建的临时表等数据。</p> <p>6、Doublewrite Buffer Files</p> <p>双写缓冲区，innoDB引擎将数据页从Buffer Pool刷新到磁盘前，先将数据页写入双写缓冲区文件中，便于系统异常时恢复数据。</p> <p><img src="/assets/1677138828296.png" alt="1677138828296"></p> <p>7、Redo Log</p> <p>重做日志，是用来实现事务的持久性。该日志文件由两部分组成：重做日志缓冲（redo log buffer）以及重做日志文件（redo log）,前者是在内存中，后者在磁盘中。当事务提交之后会把所有修改信息都会存到该日志中, 用于在刷新脏页到磁盘时,发生错误时, 进行数据恢复使用。</p> <p>以循环方式写入重做日志文件，涉及两个文件：</p> <p><img src="/assets/1677139654583.png" alt="1677139654583"></p> <h5 id="后台线程"><a href="#后台线程" class="header-anchor">#</a> 后台线程</h5> <p><img src="/assets/1677139710919.png" alt="1677139710919"></p> <p>1、Master Thread</p> <p>核心后台线程，负责调度其他线程，还负责将缓冲池中的数据异步刷新到磁盘中, 保持数据的一致性， 还包括脏页的刷新、合并插入缓存、undo页的回收 。</p> <p>2、IO Thread</p> <p>在InnoDB存储引擎中大量使用了AIO来处理IO请求, 这样可以极大地提高数据库的性能，而IO Thread主要负责这些IO请求的回调。</p> <p><img src="/assets/1677139941613.png" alt="1677139941613"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">## 查看到InnoDB的状态信息，其中就包含IO Thread信息。</span>
<span class="token keyword">show</span> <span class="token keyword">engine</span> <span class="token keyword">innodb</span> <span class="token keyword">status</span> \G<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/1677140053780.png" alt="1677140053780"></p> <p>3、Purge Thread</p> <p>主要用于回收事务已经提交了的undo log，在事务提交之后，undo log可能不用了，就用它来回收。</p> <p>4、Page Cleaner Thread</p> <p>协助 Master Thread 刷新脏页到磁盘的线程，它可以减轻 Master Thread 的工作压力，减少阻塞。</p> <h4 id="事务原理"><a href="#事务原理" class="header-anchor">#</a> 事务原理</h4> <p>事务：是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p> <p>• 原子性（Atomicity）：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。
• 一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。
• 隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。
• 持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</p> <p>原子性、一致性、持久化，实际上是由InnoDB中的两份日志来保证的，一份是redo log日志，一份是undo log日志。 而持久性是通过数据库的锁，加上MVCC来保证的。</p> <p><img src="/assets/1677140282439.png" alt="1677140282439"></p> <h5 id="redo-log"><a href="#redo-log" class="header-anchor">#</a> redo log</h5> <p>重做日志，记录的是事务提交时数据页的物理修改，是用来实现事务的持久性。</p> <p>该日志文件由两部分组成：重做日志缓冲（redo log buffer）以及重做日志文件（redo log file）,前者是在内存中，后者在磁盘中。当事务提交之后会把所有修改信息都存到该日志文件中, 用于在刷新脏页到磁盘,发生错误时, 进行数据恢复使用。</p> <p><img src="/assets/1677140540772.png" alt="1677140540772"></p> <p>1）有了redolog之后，当对缓冲区的数据进行增删改之后，会首先将操作的数据页的变化，记录在redo log buffer中。
2）在事务提交时，会将redo log buffer中的数据刷新到redo log磁盘文件中。
3）过一段时间之后，如果刷新缓冲区的脏页到磁盘时，发生错误，此时就可以借助于redo log进行数据恢复，这样就保证了事务的持久性。 而如果脏页成功刷新到磁盘 或 或者涉及到的数据已经落盘，此时redolog就没有作用了，就可以删除了，所以存在的两个redolog文件是循环写的。</p> <p><strong>那为什么每一次提交事务，要刷新redo log 到磁盘中呢，而不是直接将buffer pool中的脏页刷新到磁盘呢？</strong>
答：因为在业务操作中，我们操作数据一般都是随机读写磁盘的，而不是顺序读写磁盘。 而redo log在往磁盘文件中写入数据，由于是日志文件，所以都是顺序写的。顺序写的效率，要远大于随机写。 这种先写日志的方式，称之为 WAL（Write-Ahead Logging）。</p> <h5 id="undo-log"><a href="#undo-log" class="header-anchor">#</a> undo log</h5> <p>回滚日志，用于记录数据被修改前的信息 , 作用包含两个 : 提供回滚(保证事务的原子性) 和 MVCC(多版本并发控制) 。</p> <p>**undo log和redo log记录物理日志不一样，它是逻辑日志。**可以认为当delete一条记录时，undo log中会记录一条对应的insert记录，反之亦然，当update一条记录时，它记录一条对应相反的update记录。当执行rollback时，就可以从undo log中的逻辑记录读取到相应的内容并进行回滚。</p> <ul><li>Undo log销毁：undo log在事务执行时产生，事务提交时，并不会立即删除undo log，因为这些
日志可能还用于MVCC。</li> <li>Undo log存储：undo log采用段的方式进行管理和记录，存放在前面介绍的 rollback segment
回滚段中，内部包含1024个undo log segment。</li></ul> <h5 id="mvcc"><a href="#mvcc" class="header-anchor">#</a> MVCC</h5> <h6 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h6> <p>1). 当前读
读取的是记录的最新版本，读取时还要保证其他并发事务不能修改当前记录，会对读取的记录进行加锁。对于我们日常的操作，如：select ... lock in share mode(共享锁)，select ... for update、update、insert、delete(排他锁)都是一种当前读。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>即使是在默认的RR隔离级别下，事务A中依然可以读取到事务B最新提交的内容，因为在查询语句后面加上了 lock in share mode 共享锁，此时是当前读操作。当然，当我们加排他锁的时候，也是当前读操作。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2). 快照读
简单的select（不加锁）就是快照读，读取的是记录数据的可见版本，有可能是历史数据，不加锁，是非阻读。</p> <p>• Read Committed：每次select，都生成一个快照读。
• Repeatable Read：开启事务后第一个select语句才是快照读的地方。
• Serializable：快照读会退化为当前读。</p> <p><img src="/assets/1677141645911.png" alt="1677141645911"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>在测试中,我们看到即使事务B提交了数据,事务A中也查询不到。 原因就是因为普通的select是快照读，而在当前默认的RR隔离级别下，开启事务后第一个select语句才是快照读的地方，后面执行相同的select语句都是从快照中获取数据，可能不是当前的最新数据，这样也就保证了可重复读。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3). MVCC
全称 Multi-Version Concurrency Control，多版本并发控制。指==维护一个数据的多个版本，使得读写操作没有冲突，快照读为MySQL实现MVCC提供了一个非阻塞读功能。==MVCC的具体实现，还需要依赖于数据库记录中的三个隐式字段、undo log日志、readView。</p> <h6 id="隐藏字段"><a href="#隐藏字段" class="header-anchor">#</a> 隐藏字段</h6> <p><img src="/assets/1677141819011.png" alt="1677141819011"></p> <p>创建表时，显式看到的这三个字段。InnoDB还会自动的给我们添加三个隐藏字段及其含义分别是：</p> <p><img src="/assets/1677141866686.png" alt="1677141866686"></p> <h6 id="undolog"><a href="#undolog" class="header-anchor">#</a> undolog</h6> <p>Undo log版本链</p> <p>回滚日志，在insert、update、delete的时候产生的便于数据回滚的日志。
当insert的时候，产生的undo log日志只在回滚时需要，在事务提交后，可被立即删除。
而update、delete的时候，产生的undo log日志不仅在回滚时需要，在快照读时也需要，不会立即被删除。</p> <p><img src="/assets/1677142449341.png" alt="1677142449341"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>DB_TRX_ID : 代表最近修改事务ID，记录插入这条记录或最后一次修改该记录的事务ID，是自增的。
DB_ROLL_PTR ： 由于这条数据是才插入的，没有被更新过，所以该字段值为<span class="token boolean">null</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>不同事务或相同事务对同一条记录进行修改，会导致该记录的undolog生成一条记录版本链表，链表的头部是最新的旧记录，链表尾部是最早的旧记录。</p></blockquote> <h6 id="readview"><a href="#readview" class="header-anchor">#</a> ReadView</h6> <p>ReadView（读视图）是 快照读 SQL执行时MVCC提取数据的依据，记录并维护系统当前活跃的事务
（未提交的）id。</p> <p>四个核心字段：</p> <p><img src="/assets/1677142779681.png" alt="1677142779681"></p> <p><strong>版本链数据的访问规则</strong>，trx_id 代表当前undolog版本链对应事务ID。</p> <p><img src="/assets/1677142948673.png" alt="1677142948673"></p> <h6 id="原理分析"><a href="#原理分析" class="header-anchor">#</a> 原理分析</h6> <p>不同的隔离级别，生成ReadView的时机不同：</p> <ul><li>READ COMMITTED ：在事务中每一次执行快照读时生成ReadView。</li> <li>REPEATABLE READ：仅在事务中第一次执行快照读时生成ReadView，后续复用该ReadView。</li></ul> <p><img src="/assets/1677143612347.png" alt="1677143612347"></p> <p>MVCC的实现原理就是通过 InnoDB表的隐藏字段、UndoLog 版本链、ReadView来实现的。 而MVCC + 锁，则实现了事务的隔离性。 而一致性则是由redolog 与 undolog保证。</p> <h3 id="mysql管理"><a href="#mysql管理" class="header-anchor">#</a> MySQL管理</h3> <h4 id="系统数据库"><a href="#系统数据库" class="header-anchor">#</a> 系统数据库</h4> <p><img src="/assets/1677143696861.png" alt="1677143696861"></p> <h4 id="常用工具"><a href="#常用工具" class="header-anchor">#</a> 常用工具</h4> <h5 id="mysql-2"><a href="#mysql-2" class="header-anchor">#</a> mysql</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>语法 ：    
    mysql   <span class="token punctuation">[</span>options<span class="token punctuation">]</span>   <span class="token punctuation">[</span><span class="token keyword">database</span><span class="token punctuation">]</span>
选项 ： 
    <span class="token operator">-</span>u<span class="token punctuation">,</span> <span class="token comment">--user=name         #指定用户名</span>
    <span class="token operator">-</span>p<span class="token punctuation">,</span> <span class="token comment">--password[=name]           #指定密码</span>
    <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token comment">--host=name         #指定服务器IP或域名</span>
    <span class="token operator">-</span>P<span class="token punctuation">,</span> <span class="token comment">--port=port             #指定连接端口</span>
    <span class="token operator">-</span>e<span class="token punctuation">,</span> <span class="token comment">--execute=name          #执行SQL语句并退出</span>
    
<span class="token operator">-</span>e选项可以在Mysql客户端执行<span class="token keyword">SQL</span>语句，而不用连接到MySQL数据库再执行，对于一些批处理脚本，这种方式尤其方便。    
<span class="token comment">## 示例：</span>
mysql <span class="token operator">-</span>uroot –p123456 db01 <span class="token operator">-</span>e <span class="token string">&quot;select * from stu&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="mysqladmin"><a href="#mysqladmin" class="header-anchor">#</a> mysqladmin</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqladmin 是一个执行管理操作的客户端程序。可以用它来检查服务器的配置和当前状态、创建并删除数据库等。
通过帮助文档查看选项：
    mysqladmin <span class="token comment">--help</span>
    
语法: 
    mysqladmin <span class="token punctuation">[</span>options<span class="token punctuation">]</span> command <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
选项:
    <span class="token operator">-</span>u<span class="token punctuation">,</span> <span class="token comment">--user=name             #指定用户名</span>
    <span class="token operator">-</span>p<span class="token punctuation">,</span> <span class="token comment">--password[=name]       #指定密码</span>
    <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token comment">--host=name             #指定服务器IP或域名</span>
    <span class="token operator">-</span>P<span class="token punctuation">,</span> <span class="token comment">--port=port             #指定连接端口</span>
    
<span class="token comment">## 示例</span>
mysqladmin <span class="token operator">-</span>uroot –p1234 <span class="token keyword">drop</span> <span class="token string">'test01'</span><span class="token punctuation">;</span>
mysqladmin <span class="token operator">-</span>uroot –p1234 version<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="mysqlbinlog"><a href="#mysqlbinlog" class="header-anchor">#</a> mysqlbinlog</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>由于服务器生成的二进制日志文件以二进制格式保存，所以如果想要检查这些文本的文本格式，就会使用到mysqlbinlog 日志管理工具。

语法 ：    
    mysqlbinlog <span class="token punctuation">[</span>options<span class="token punctuation">]</span>  log<span class="token operator">-</span>files1 log<span class="token operator">-</span>files2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
选项 ： 
    <span class="token operator">-</span>d<span class="token punctuation">,</span> <span class="token comment">--database=name         指定数据库名称，只列出指定的数据库相关操作。</span>
    <span class="token operator">-</span>o<span class="token punctuation">,</span> <span class="token comment">--offset=##              忽略掉日志中的前n行命令。</span>
    <span class="token operator">-</span>r<span class="token punctuation">,</span><span class="token comment">--result-file=name       将输出的文本格式日志输出到指定文件。</span>
    <span class="token operator">-</span>s<span class="token punctuation">,</span> <span class="token comment">--short-form            显示简单格式， 省略掉一些信息。</span>
    <span class="token comment">--start-datatime=date1  --stop-datetime=date2       指定日期间隔内的所有日志。</span>
    <span class="token comment">--start-position=pos1 --stop-position=pos2          指定位置间隔内的所有日志。</span>
    
<span class="token comment">## 示例</span>
<span class="token comment">## 查看 binlog.000008这个二进制文件中的数据信息,太复杂了，-s来显示简单格式</span>
mysqlbinlog <span class="token operator">-</span>s binlog<span class="token punctuation">.</span><span class="token number">000008</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="mysqlshow"><a href="#mysqlshow" class="header-anchor">#</a> mysqlshow</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqlshow 客户端对象查找工具，用来很快地查找存在哪些数据库、数据库中的表、表中的列或者索引。

语法 ：    
    mysqlshow <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name <span class="token punctuation">[</span>table_name <span class="token punctuation">[</span>col_name<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
选项 ： 
    <span class="token comment">--count     显示数据库及表的统计信息（数据库，表 均可以不指定）</span>
    <span class="token operator">-</span>i      显示指定数据库或者指定表的状态信息
示例：
    <span class="token comment">#查询test库中每个表中的字段书，及行数</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 test <span class="token comment">--count</span>

    <span class="token comment">#查询test库中book表的详细情况</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 test book <span class="token comment">--count</span>
    
    <span class="token comment">## 查询每个数据库的表的数量及表中记录的数量</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 <span class="token comment">--count</span>
    <span class="token comment">## 查看数据库db01的统计信息</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 db01 <span class="token comment">--count</span>
    <span class="token comment">## 查看数据库db01中的course表的信息</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 db01 course <span class="token comment">--count</span>
    <span class="token comment">## 查看数据库db01中的course表的id字段的信息</span>
    mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 db01 course id <span class="token comment">--count</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>mysqldump</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqldump 客户端工具用来备份数据库或在不同数据库之间进行数据迁移。备份内容包含创建表，及插入表的<span class="token keyword">SQL</span>语句。

语法 ：    
    mysqldump <span class="token punctuation">[</span>options<span class="token punctuation">]</span> db_name <span class="token punctuation">[</span><span class="token keyword">tables</span><span class="token punctuation">]</span>
    mysqldump <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token comment">--database/-B db1 [db2 db3...]</span>
    mysqldump <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token comment">--all-databases/-A</span>
连接选项 ：  
    <span class="token operator">-</span>u<span class="token punctuation">,</span> <span class="token comment">--user=name                 指定用户名</span>
    <span class="token operator">-</span>p<span class="token punctuation">,</span> <span class="token comment">--password[=name]           指定密码</span>
    <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token comment">--host=name                 指定服务器ip或域名</span>
    <span class="token operator">-</span>P<span class="token punctuation">,</span> <span class="token comment">--port=##                    指定连接端口</span>
输出选项：

    <span class="token comment">--add-drop-database         在每个数据库创建语句前加上 drop database 语句</span>
    <span class="token comment">--add-drop-table            在每个表创建语句前加上 drop table 语句 , 默认开启 ; 不</span>
开启 <span class="token punctuation">(</span><span class="token comment">--skip-add-drop-table)</span>
    <span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token comment">--no-create-db          不包含数据库的创建语句</span>
    <span class="token operator">-</span>t<span class="token punctuation">,</span> <span class="token comment">--no-create-info        不包含数据表的创建语句</span>
    <span class="token operator">-</span>d <span class="token comment">--no-data                不包含数据</span>
     <span class="token operator">-</span>T<span class="token punctuation">,</span> <span class="token comment">--tab=name             自动生成两个文件：一个.sql文件，创建表结构的语句；一</span>
个<span class="token punctuation">.</span>txt文件，数据文件

<span class="token comment">## 示例</span>
<span class="token comment">## 备份db01数据库</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 db01 <span class="token operator">&gt;</span> db01<span class="token punctuation">.</span><span class="token keyword">sql</span>
备份出来的数据包含： 
·删除表的语句
·创建表的语句
·数据插入语句
如果我们在数据备份时，不需要创建表，或者不需要备份数据，只需要备份表结构，都可以通过对应的
参数来实现。

<span class="token comment">## 备份db01数据库中的表数据，不备份表结构(-t)</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 <span class="token operator">-</span>t db01 <span class="token operator">&gt;</span> db01<span class="token punctuation">.</span><span class="token keyword">sql</span>
<span class="token comment">## 打开 db02.sql ，来查看备份的数据，只有insert语句，没有备份表结构。</span>

<span class="token comment">## 查看哪些目录是MySQL信任的目录</span>
<span class="token keyword">show</span> variables lik <span class="token string">'%secure_file_priv'</span>
<span class="token comment">## 将db01数据库的表的表结构与数据分开备份(-T)</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p1234 <span class="token operator">-</span>T <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>mysql<span class="token operator">-</span>files<span class="token operator">/</span> db01 score
<span class="token comment">## 会产生两个文件</span>
score<span class="token punctuation">.</span><span class="token keyword">sql</span> 中记录的就是表结构文件
score<span class="token punctuation">.</span>txt 就是表数据文件，但是需要注意表数据文件，并不是记录一条条的<span class="token keyword">insert</span>语句，而是按照一定的格式记录表结构中的数据。如下：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p><img src="/assets/1677144699338.png" alt="1677144699338"></p> <h5 id="mysqlimport-source"><a href="#mysqlimport-source" class="header-anchor">#</a> mysqlimport/source</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqlimport 是客户端数据导入工具，用来导入mysqldump 加 <span class="token operator">-</span>T 参数后导出的文本文件。
语法 ：    
    mysqlimport <span class="token punctuation">[</span>options<span class="token punctuation">]</span>  db_name  textfile1  <span class="token punctuation">[</span>textfile2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
示例 ： 
    mysqlimport <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 db01 <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>mysql<span class="token operator">-</span>files<span class="token operator">/</span>score<span class="token punctuation">.</span>txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>如果需要导入<span class="token keyword">sql</span>文件<span class="token punctuation">,</span>可以使用mysql中的source 指令 : 
语法 ：    
    source <span class="token operator">/</span>root<span class="token operator">/</span>xxxxx<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h2> <h3 id="整型"><a href="#整型" class="header-anchor">#</a> 整型</h3> <table><thead><tr><th>类型名称</th> <th>取值范围</th> <th>大小</th></tr></thead> <tbody><tr><td>TINYINT</td> <td>-128〜127</td> <td>1个字节</td></tr> <tr><td>SMALLINT</td> <td>-32768〜32767</td> <td>2个宇节</td></tr> <tr><td>MEDIUMINT</td> <td>-8388608〜8388607</td> <td>3个字节</td></tr> <tr><td>INT (INTEGHR)</td> <td>-2147483648〜2147483647</td> <td>4个字节</td></tr> <tr><td>BIGINT</td> <td>-9223372036854775808〜9223372036854775807</td> <td>8个字节</td></tr></tbody></table> <p>无符号在数据类型后加 unsigned 关键字。</p> <h3 id="浮点型"><a href="#浮点型" class="header-anchor">#</a> 浮点型</h3> <table><thead><tr><th>类型名称</th> <th>说明</th> <th>存储需求</th></tr></thead> <tbody><tr><td>FLOAT</td> <td>单精度浮点数</td> <td>4 个字节</td></tr> <tr><td>DOUBLE</td> <td>双精度浮点数</td> <td>8 个字节</td></tr> <tr><td>DECIMAL (M, D)，DEC</td> <td>压缩的“严格”定点数</td> <td>M+2 个字节</td></tr></tbody></table> <h3 id="日期和时间"><a href="#日期和时间" class="header-anchor">#</a> 日期和时间</h3> <table><thead><tr><th>类型名称</th> <th>日期格式</th> <th>日期范围</th> <th>存储需求</th></tr></thead> <tbody><tr><td>YEAR</td> <td>YYYY</td> <td>1901 ~ 2155</td> <td>1 个字节</td></tr> <tr><td>TIME</td> <td>HH:MM:SS</td> <td>-838:59:59 ~ 838:59:59</td> <td>3 个字节</td></tr> <tr><td>DATE</td> <td>YYYY-MM-DD</td> <td>1000-01-01 ~ 9999-12-3</td> <td>3 个字节</td></tr> <tr><td>DATETIME</td> <td>YYYY-MM-DD HH:MM:SS</td> <td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td> <td>8 个字节</td></tr> <tr><td>TIMESTAMP</td> <td>YYYY-MM-DD HH:MM:SS</td> <td>1980-01-01 00:00:01 UTC ~ 2040-01-19 03:14:07 UTC</td> <td>4 个字节</td></tr></tbody></table> <h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <table><thead><tr><th>类型名称</th> <th>说明</th> <th>存储需求</th></tr></thead> <tbody><tr><td>CHAR(M)</td> <td>固定长度非二进制字符串</td> <td>M 字节，1&lt;=M&lt;=255</td></tr> <tr><td>VARCHAR(M)</td> <td>变长非二进制字符串</td> <td>L+1字节，在此，L&lt; = M和 1&lt;=M&lt;=255</td></tr> <tr><td>TINYTEXT</td> <td>非常小的非二进制字符串</td> <td>L+1字节，在此，L&lt;2^8</td></tr> <tr><td>TEXT</td> <td>小的非二进制字符串</td> <td>L+2字节，在此，L&lt;2^16</td></tr> <tr><td>MEDIUMTEXT</td> <td>中等大小的非二进制字符串</td> <td>L+3字节，在此，L&lt;2^24</td></tr> <tr><td>LONGTEXT</td> <td>大的非二进制字符串</td> <td>L+4字节，在此，L&lt;2^32</td></tr> <tr><td>ENUM</td> <td>枚举类型，只能有一个枚举字符串值</td> <td>1或2个字节，取决于枚举值的数目 (最大值为65535)</td></tr> <tr><td>SET</td> <td>一个设置，字符串对象可以有零个或 多个SET成员</td> <td>1、2、3、4或8个字节，取决于集合 成员的数量（最多64个成员）</td></tr></tbody></table> <h3 id="二进制类型"><a href="#二进制类型" class="header-anchor">#</a> 二进制类型</h3> <table><thead><tr><th>类型名称</th> <th>说明</th> <th>存储需求</th></tr></thead> <tbody><tr><td>BIT(M)</td> <td>位字段类型</td> <td>大约 (M+7)/8 字节</td></tr> <tr><td>BINARY(M)</td> <td>固定长度二进制字符串</td> <td>M 字节</td></tr> <tr><td>VARBINARY (M)</td> <td>可变长度二进制字符串</td> <td>M+1 字节</td></tr> <tr><td>TINYBLOB (M)</td> <td>非常小的BLOB</td> <td>L+1 字节，在此，L&lt;2^8</td></tr> <tr><td>BLOB (M)</td> <td>小 BLOB</td> <td>L+2 字节，在此，L&lt;2^16</td></tr> <tr><td>MEDIUMBLOB (M)</td> <td>中等大小的BLOB</td> <td>L+3 字节，在此，L&lt;2^24</td></tr> <tr><td>LONGBLOB (M)</td> <td>非常大的BLOB</td> <td>L+4 字节，在此，L&lt;2^32</td></tr></tbody></table> <h2 id="权限一览表"><a href="#权限一览表" class="header-anchor">#</a> 权限一览表</h2> <blockquote><p>具体权限的作用详见<a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html" title="官方文档" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>GRANT 和 REVOKE 允许的静态权限</p> <table><thead><tr><th style="text-align:left;">Privilege</th> <th style="text-align:left;">Grant Table Column</th> <th style="text-align:left;">Context</th></tr></thead> <tbody><tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_all" target="_blank" rel="noopener noreferrer"><code>ALL [PRIVILEGES]</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Synonym for “all privileges”</td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_alter" target="_blank" rel="noopener noreferrer"><code>ALTER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Alter_priv</code></td> <td style="text-align:left;">Tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_alter-routine" target="_blank" rel="noopener noreferrer"><code>ALTER ROUTINE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Alter_routine_priv</code></td> <td style="text-align:left;">Stored routines</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create" target="_blank" rel="noopener noreferrer"><code>CREATE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_priv</code></td> <td style="text-align:left;">Databases, tables, or indexes</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-role" target="_blank" rel="noopener noreferrer"><code>CREATE ROLE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_role_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-routine" target="_blank" rel="noopener noreferrer"><code>CREATE ROUTINE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_routine_priv</code></td> <td style="text-align:left;">Stored routines</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-tablespace" target="_blank" rel="noopener noreferrer"><code>CREATE TABLESPACE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_tablespace_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-temporary-tables" target="_blank" rel="noopener noreferrer"><code>CREATE TEMPORARY TABLES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_tmp_table_priv</code></td> <td style="text-align:left;">Tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-user" target="_blank" rel="noopener noreferrer"><code>CREATE USER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_user_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_create-view" target="_blank" rel="noopener noreferrer"><code>CREATE VIEW</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Create_view_priv</code></td> <td style="text-align:left;">Views</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_delete" target="_blank" rel="noopener noreferrer"><code>DELETE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Delete_priv</code></td> <td style="text-align:left;">Tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_drop" target="_blank" rel="noopener noreferrer"><code>DROP</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Drop_priv</code></td> <td style="text-align:left;">Databases, tables, or views</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_drop-role" target="_blank" rel="noopener noreferrer"><code>DROP ROLE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Drop_role_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_event" target="_blank" rel="noopener noreferrer"><code>EVENT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Event_priv</code></td> <td style="text-align:left;">Databases</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_execute" target="_blank" rel="noopener noreferrer"><code>EXECUTE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Execute_priv</code></td> <td style="text-align:left;">Stored routines</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_file" target="_blank" rel="noopener noreferrer"><code>FILE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>File_priv</code></td> <td style="text-align:left;">File access on server host</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_grant-option" target="_blank" rel="noopener noreferrer"><code>GRANT OPTION</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Grant_priv</code></td> <td style="text-align:left;">Databases, tables, or stored routines</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_index" target="_blank" rel="noopener noreferrer"><code>INDEX</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Index_priv</code></td> <td style="text-align:left;">Tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_insert" target="_blank" rel="noopener noreferrer"><code>INSERT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Insert_priv</code></td> <td style="text-align:left;">Tables or columns</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_lock-tables" target="_blank" rel="noopener noreferrer"><code>LOCK TABLES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Lock_tables_priv</code></td> <td style="text-align:left;">Databases</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_process" target="_blank" rel="noopener noreferrer"><code>PROCESS</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Process_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_proxy" target="_blank" rel="noopener noreferrer"><code>PROXY</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">See <code>proxies_priv</code> table</td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_references" target="_blank" rel="noopener noreferrer"><code>REFERENCES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>References_priv</code></td> <td style="text-align:left;">Databases or tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_reload" target="_blank" rel="noopener noreferrer"><code>RELOAD</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Reload_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-client" target="_blank" rel="noopener noreferrer"><code>REPLICATION CLIENT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Repl_client_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave" target="_blank" rel="noopener noreferrer"><code>REPLICATION SLAVE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Repl_slave_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_select" target="_blank" rel="noopener noreferrer"><code>SELECT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Select_priv</code></td> <td style="text-align:left;">Tables or columns</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_show-databases" target="_blank" rel="noopener noreferrer"><code>SHOW DATABASES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Show_db_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_show-view" target="_blank" rel="noopener noreferrer"><code>SHOW VIEW</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Show_view_priv</code></td> <td style="text-align:left;">Views</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_shutdown" target="_blank" rel="noopener noreferrer"><code>SHUTDOWN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Shutdown_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_super" target="_blank" rel="noopener noreferrer"><code>SUPER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Super_priv</code></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_trigger" target="_blank" rel="noopener noreferrer"><code>TRIGGER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Trigger_priv</code></td> <td style="text-align:left;">Tables</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_update" target="_blank" rel="noopener noreferrer"><code>UPDATE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>Update_priv</code></td> <td style="text-align:left;">Tables or columns</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_usage" target="_blank" rel="noopener noreferrer"><code>USAGE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Synonym for “no privileges”</td> <td style="text-align:left;">Server administration</td></tr></tbody></table> <p>GRANT 和 REVOKE 允许的动态权限</p> <table><thead><tr><th style="text-align:left;">Privilege</th> <th style="text-align:left;">Context</th></tr></thead> <tbody><tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_application-password-admin" target="_blank" rel="noopener noreferrer"><code>APPLICATION_PASSWORD_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Dual password administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_audit-abort-exempt" target="_blank" rel="noopener noreferrer"><code>AUDIT_ABORT_EXEMPT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Allow queries blocked by audit log filter</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_audit-admin" target="_blank" rel="noopener noreferrer"><code>AUDIT_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Audit log administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_authentication-policy-admin" target="_blank" rel="noopener noreferrer"><code>AUTHENTICATION_POLICY_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Authentication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_backup-admin" target="_blank" rel="noopener noreferrer"><code>BACKUP_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Backup administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_binlog-admin" target="_blank" rel="noopener noreferrer"><code>BINLOG_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Backup and Replication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_binlog-encryption-admin" target="_blank" rel="noopener noreferrer"><code>BINLOG_ENCRYPTION_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Backup and Replication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_clone-admin" target="_blank" rel="noopener noreferrer"><code>CLONE_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Clone administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_connection-admin" target="_blank" rel="noopener noreferrer"><code>CONNECTION_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_encryption-key-admin" target="_blank" rel="noopener noreferrer"><code>ENCRYPTION_KEY_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_firewall-admin" target="_blank" rel="noopener noreferrer"><code>FIREWALL_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Firewall administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_firewall-exempt" target="_blank" rel="noopener noreferrer"><code>FIREWALL_EXEMPT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Firewall administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_firewall-user" target="_blank" rel="noopener noreferrer"><code>FIREWALL_USER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Firewall administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_flush-optimizer-costs" target="_blank" rel="noopener noreferrer"><code>FLUSH_OPTIMIZER_COSTS</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_flush-status" target="_blank" rel="noopener noreferrer"><code>FLUSH_STATUS</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_flush-tables" target="_blank" rel="noopener noreferrer"><code>FLUSH_TABLES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_flush-user-resources" target="_blank" rel="noopener noreferrer"><code>FLUSH_USER_RESOURCES</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_group-replication-admin" target="_blank" rel="noopener noreferrer"><code>GROUP_REPLICATION_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Replication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_group-replication-stream" target="_blank" rel="noopener noreferrer"><code>GROUP_REPLICATION_STREAM</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Replication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_innodb-redo-log-archive" target="_blank" rel="noopener noreferrer"><code>INNODB_REDO_LOG_ARCHIVE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Redo log archiving administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_ndb-stored-user" target="_blank" rel="noopener noreferrer"><code>NDB_STORED_USER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">NDB Cluster</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_passwordless-user-admin" target="_blank" rel="noopener noreferrer"><code>PASSWORDLESS_USER_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Authentication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_persist-ro-variables-admin" target="_blank" rel="noopener noreferrer"><code>PERSIST_RO_VARIABLES_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-applier" target="_blank" rel="noopener noreferrer"><code>REPLICATION_APPLIER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;"><code>PRIVILEGE_CHECKS_USER</code> for a replication channel</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave-admin" target="_blank" rel="noopener noreferrer"><code>REPLICATION_SLAVE_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Replication administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_resource-group-admin" target="_blank" rel="noopener noreferrer"><code>RESOURCE_GROUP_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Resource group administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_resource-group-user" target="_blank" rel="noopener noreferrer"><code>RESOURCE_GROUP_USER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Resource group administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_role-admin" target="_blank" rel="noopener noreferrer"><code>ROLE_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_session-variables-admin" target="_blank" rel="noopener noreferrer"><code>SESSION_VARIABLES_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_set-user-id" target="_blank" rel="noopener noreferrer"><code>SET_USER_ID</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_show-routine" target="_blank" rel="noopener noreferrer"><code>SHOW_ROUTINE</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-user" target="_blank" rel="noopener noreferrer"><code>SYSTEM_USER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_system-variables-admin" target="_blank" rel="noopener noreferrer"><code>SYSTEM_VARIABLES_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_table-encryption-admin" target="_blank" rel="noopener noreferrer"><code>TABLE_ENCRYPTION_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_version-token-admin" target="_blank" rel="noopener noreferrer"><code>VERSION_TOKEN_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr> <tr><td style="text-align:left;"><a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_xa-recover-admin" target="_blank" rel="noopener noreferrer"><code>XA_RECOVER_ADMIN</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td style="text-align:left;">Server administration</td></tr></tbody></table> <h2 id="图形化界面工具"><a href="#图形化界面工具" class="header-anchor">#</a> 图形化界面工具</h2> <ul><li>Workbench(免费): http://dev.mysql.com/downloads/workbench/</li> <li>navicat(收费，试用版30天): https://www.navicat.com/en/download/navicat-for-mysql</li> <li>Sequel Pro(开源免费，仅支持Mac OS): http://www.sequelpro.com/</li> <li>HeidiSQL(免费): http://www.heidisql.com/</li> <li>phpMyAdmin(免费): https://www.phpmyadmin.net/</li> <li>SQLyog: https://sqlyog.en.softonic.com/</li></ul> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <h2 id="小技巧"><a href="#小技巧" class="header-anchor">#</a> 小技巧</h2> <ol><li><p>在SQL语句之后加上<code>\G</code>会将结果的表格形式转换成行文本形式</p> <p>在MySQL的sql语句后加上<code>\G</code>，表示将查询结果进行按列打印，可以使每个字段打印到单独的行。即<strong>将查到的结构旋转90度变成纵向；</strong></p></li> <li><p>查看Mysql数据库占用空间：</p></li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_schema <span class="token string">&quot;Database Name&quot;</span>
     <span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>data_length <span class="token operator">+</span> index_length<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token string">&quot;Database Size in MB&quot;</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> table_schema<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <h3 id="mycat"><a href="#mycat" class="header-anchor">#</a> mycat</h3> <p>能够将mysql数据组成一个分布式的集群，可以把物理上多个独立的mysql数据库，搞成一个逻辑上的整体，使开发者感受不到的物理上的独立。这些物理上独立的mysql数据库按照配置不同各自完成各自的工作。</p> <h2 id="后续内容"><a href="#后续内容" class="header-anchor">#</a> 后续内容</h2> <p>后续内容因为跟当前学习、工作计划有冲突，所以后续课程的学习计划会无限期推后。
目前的工作重点放在重做一个学习笔记网站，当然这是边做边学的，开发过程中遇到的难点和知识点我也会记录下来供大家学习。
<strong>在此感谢B站同样爱学习的同学 @守心-人 提供的后续课程笔记，大家有条件一定要去给个star，你的每一个star和点赞都是我们前进的动力</strong> <strong><a href="https://github.com/Buildings-Lei/mysql_note/blob/main/README.md" target="_blank" rel="noopener noreferrer">https://github.com/Buildings-Lei/mysql_note/blob/main/README.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/smileatl/smileatlRepository_source/edit/master/docs/05.工作/40.数据库-MySQL/02.MySQL.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/23, 11:25:01</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/cba5d8/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">IPV6</div></a> <a href="/pages/08800f/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">必知必会笔记</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/cba5d8/" class="prev">IPV6</a></span> <span class="next"><a href="/pages/08800f/">必知必会笔记</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/93a902/"><div>
            cpp新特性
            <!----></div></a> <span class="date">12-04</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/163c8a/"><div>
            复刷还是没记住的题
            <!----></div></a> <span class="date">12-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2aa569/"><div>
            计算机网络
            <!----></div></a> <span class="date">12-04</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1355484300@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/smileatl" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>smileatl | <a href="https://github.com/smileatl/smileatlRepository_source/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4813674f.js" defer></script><script src="/assets/js/3.cf27d530.js" defer></script><script src="/assets/js/110.225cb77d.js" defer></script>
  </body>
</html>
